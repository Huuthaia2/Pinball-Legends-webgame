window.__require=function e(t,o,i){function n(r,s){if(!o[r]){if(!t[r]){var l=r.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var d=o[r]={exports:{}};t[r][0].call(d.exports,function(e){return n(t[r][1][e]||e)},d,d.exports,e,t,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({AAA:[function(e,t,o){"use strict";cc._RF.push(t,"202933zXQ9L0K3wZFmNOyEy","AAA");var i=e,n=o;Object.defineProperty(n,"__esModule",{value:!0}),i("gameassistant2"),n=i("papaparse"),i("API"),i("Extend"),i("GameModel"),i("Model"),window.Papa=n,cc._RF.pop()},{}],API:[function(e,t){"use strict";cc._RF.push(t,"c9cb3at1DhE3rn99ZUiUNIt","API");var o=(i.prototype.request=function(e){var t=G.requestUrl,i=0==(t=null!=e.url?e.url:t).endsWith("/")?t+"/"+e.path:t+e.path;if(GA.isPlatform([GA.Platform.WeChat,GA.Platform.QQ,GA.Platform.ByteDance]))GA.request({url:i,method:e.method||"POST",header:{appid:G.appId,"content-type":"application/json"},data:e.params,success:function(t){var i;t&&t.data?e.success&&("object"==(void 0===(i=t.data)?"undefined":w(i))?(i.responseIsSuccess=function(){return 0==i.code},o.handleCall(e.success,i)):e.fail&&o.handleCall(e.fail,t)):e.fail&&o.handleCall(e.fail,t)},fail:function(i){console.info("request.fail",t+e.path),console.info("request.fail",JSON.stringify(i)),e.fail&&o.handleCall(e.fail,i)}});else{var n=new XMLHttpRequest;n.onload=function(){var t=n.responseText,i={stateCode:n.status,header:{},data:{}};if(200<=n.status&&n.status<300||304==n.status)try{var r=JSON.parse(t);i.data=r,e.success&&(r.responseIsSuccess=function(){return 0==r.code},o.handleCall(e.success,r))}catch(t){console.warn(a,t),e.fail&&o.handleCall(e.fail,i)}else e.fail&&o.handleCall(e.fail,null)},n.onerror=function(){console.log("onerror"),e.fail&&o.handleCall(e.fail,null)},n.onabort=function(){console.log("onabort"),e.fail&&o.handleCall(e.fail,null)},n.ontimeout=function(){console.log("ontimeout"),e.fail&&o.handleCall(e.fail,null)};var a=o.convertParams(t,e);n.open(e.method||"POST",a,!0),n.timeout=3e4,n.setRequestHeader("appid",G.appId),n.setRequestHeader("Content-Type","application/json;charset=UTF-8");try{e.params?n.send(JSON.stringify(e.params)):n.send()}catch(i){console.error(a),console.error(i)}}},i.prototype.handleCall=function(e,t){setTimeout(function(){e(t)},1)},i.prototype.convertParams=function(e,t){var o="";if(o=0==e.endsWith("/")?e+"/"+t.path:e+t.path,"GET"==t.method&&t.params){var i,n="";for(i in t.params){n+=""==n?"?":"&";var a=t.params[i];n+=i+"="+(a=void 0===a?"":a)}o+=n}return o},i.prototype.uploadSubscribeMsg=function(){},i.prototype.sendSubscribeMsg=function(){},i.prototype.loadGameConfig=function(e){cc.loader.loadRes("json/LevelConfig.txt",cc.TextAsset,function(t,o){var i=JSON.parse(o.text);e.success&&e.success(i)})},i.prototype.loadLevelConfig=function(e,t,i){o.loadGameConfig({params:e,success:function(o){GameConfig.initLevelData(e,o.data),t&&t()},fail:function(){i&&i()}})},new i);function i(){}window.API=o,cc._RF.pop()},{}],AdManager:[function(e,t){"use strict";var o;function i(){this.bannerAdID="",this.videoAdID=null,this.bannerHeight=0,this.bannerAD=null,this.bannerShowCount=0,this.currVideoTag="",this.bannerVisible=!1,this.videoAd=null,this.videoPageName="",this.videoShowTime=0,this.videoSuccess=null,this.videoFail=null,this.isVideoTryShowing=!1,this.videoIsReady=!1,this.lastShowFullVideoTime=0,this.interstitialAd=null,this.interstitialSuccess=null,this.interstitialFail=null,this.nativeAd=null,this.nativeAdList=null,this.nativeIsReady=!1,this.nativeAdShowCount=0,this.nativeAdAutoReportClickTimes=0,this.appBoxAd=null,this.prevAppBoxLoadTime=0,this.blockAdID=null,this.blockStyles=new Map,this.blockAds=new Map,this.customAdIds=new Map,this.customAds=new Map,this.customAdValidTimes=new Map,this.gamePortalAd=null,this.gamePortalIsReady=!1,this.gameBannerAd=null,this.gameBannerIsReady=!1}cc._RF.push(t,"1e4a1jTSbdGDb+w971UELlw","AdManager"),i.prototype.check=function(){console.log("AdManager is ok.")},i.prototype.initBannerAd=function(e){this.bannerAdID=e},i.prototype.showBannerWithTimes=function(e){ProjectConfig.NoAd||GA.isPlatform([GA.Platform.iOS,GA.Platform.Android,GA.Platform.Kuaidianwan])||(this.bannerShowCount<ProjectConfig.AdConfig.BannerUpdateTimes?(0!=this.bannerShowCount&&this.bannerAD?(this.refreshBannerPos(e),this.bannerVisible||(this.bannerVisible=!0,this.bannerAD.show(),this.showCloseAdButton())):this.showBanner(e),this.bannerShowCount++):(this.bannerShowCount=0,this.hideBanner(),this.showBanner(e)))},i.prototype.hideBannerWithTimes=function(){GA.isPlatform([GA.Platform.iOS,GA.Platform.Android,GA.Platform.Kuaidianwan])||(this.bannerShowCount<ProjectConfig.AdConfig.BannerUpdateTimes?this.bannerAD&&(this.bannerAD.hide(),this.bannerVisible=!1):(this.bannerShowCount=0,this.hideBanner()))},i.prototype.showBanner=function(e){var t=this;if(!ProjectConfig.NoAd)if(console.log("showBanner curr:"+this.bannerShowCount),this.bannerAD)this.refreshBannerShow(e);else{if(!GA.Info.isPreview&&!GA.isPlatform([GA.Platform.Android,GA.Platform.iOS])){var o=GA.PA.getSystemInfoSync(),i=e&&e.scale?e.scale:1,n=o.screenWidth<o.screenHeight?o.screenWidth:300;GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])?i=1:G.isWeChat()?G.isIPad()&&300<n&&(i=.8):G.isQQ()&&300==n&&(n=o.screenWidth/2);var a=(o.screenWidth-n*i)/2;G.isByteDance()&&o.screenWidth>o.screenHeight&&(a=0);try{this.bannerAD=GA.PA.createBannerAd({adUnitId:this.bannerAdID,style:{left:a,top:o.screenHeight-100,width:n*i,height:100}}),this.bannerAD.onLoad(function(){G.isByteDance()&&t.bannerVisible&&t.bannerAD.show()}),this.bannerAD.onError(function(e){console.log("Banner Error:",e.errCode+" "+e.errMsg),t.bannerAD&&(t.bannerAD.destroy(),t.bannerAD=null),G.isWeChat()&&t.createSelfBanner(i)}),this.bannerAD.onResize(function(o){try{console.log("res.height="+o.height),t.bannerAD.style.height=o.height,t.bannerHeight=o.height,t.refreshBannerPos(e)}catch(o){}})}catch(o){}}try{G.isByteDance()||this.bannerAD.show(),this.bannerVisible=!0,this.showCloseAdButton()}catch(o){}}},i.prototype.showCloseAdButton=function(){},i.prototype.createSelfBanner=function(){},i.prototype.hideBanner=function(){this.bannerAD&&(G.isPreview||(this.bannerAD.destroy(),this.bannerAD=null,this.bannerVisible=!1))},i.prototype.refreshBannerShow=function(e){if(!this.bannerAD)return!1;try{return this.refreshBannerPos(e),this.bannerVisible=!0,this.bannerAD.show(),this.showCloseAdButton(),!0}catch(e){return console.log("refreshBannerShow err."+JSON.stringify(e)),!1}},i.prototype.refreshBannerPos=function(e){if(this.bannerAD){var t=GA.PA.getSystemInfoSync(),o=e&&e.scale?e.scale:1,i=t.screenWidth<t.screenHeight?t.screenWidth:300;GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])?o=1:G.isWeChat()&&300<i?G.isIPad()&&(o=.8):G.isQQ()&&300==i&&(i=t.screenWidth/2);try{var n=(t.screenWidth-i*o)/2;G.isByteDance()&&t.screenWidth>t.screenHeight&&(n=0);var a=this.bannerAD.style;a.left=n,a.width=i*o,e&&e.offset?(a.top=t.screenHeight-e.offset/t.designPixelRatio,console.log("bannerStyle.top="+a.top)):a.height&&(a.top=t.screenHeight-a.height),this.bannerAD.style=a}catch(e){}}},i.prototype.initRewardVideoAd=function(e){G.isPreview||(this.videoAdID=e,GA.isPlatform([GA.Platform.Android,GA.Platform.iOS])?console.log("android unsupport createRewardVideoAd"):this.createRewardVideoAd())},i.prototype.createRewardVideoAd=function(){var e=this;try{this.videoAd=GA.PA.createRewardedVideoAd({adUnitId:this.videoAdID}),this.videoAd.onLoad(function(){console.log("video is loaded."),e.videoIsReady=!0}),this.videoAd.onError(function(t){e.videoIsReady=!1,console.log("show Video error:"+t.errCode+" "+t.errMsg)}),this.videoAd.onClose(function(t){console.log("video is closed. "+t.isEnded),e.videoIsReady=!1,e.onCloseVideoAd({isEnded:t.isEnded})}),GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])&&this.videoAd.load()}catch(t){console.warn(t)}},i.prototype.isVideoReady=function(){return this.videoIsReady},i.prototype.showVideoAd=function(e,t,o,i,n){if(console.error("showVideoAd:========",window.adManager),window.adManager)window.adManager.showReward(function(){o()},function(){n()});else{var a=this;(ProjectConfig.NoAd||G.isPreview)&&o?o():(this.videoSuccess=function(){try{o()}catch(e){}},this.videoFail=i,GA.isPlatform([GA.Platform.WeChat,GA.Platform.QQ,GA.Platform.ByteDance,GA.Platform.Kwaigame,GA.Platform.OPPO,GA.Platform.Vivo])?this.isVideoTryShowing||(this.currVideoTag=t,this.videoPageName=null!=e?e:"",this.videoShowTime=Date.now(),this.videoAd?(this.isVideoTryShowing=!0,this.videoAd.show().then(function(){a.onShowVideoAd(!0)}).catch(function(){a.videoAd.load().then(function(){a.videoAd.show(),a.onShowVideoAd(!0),G.pushEvent("Retry play success")}).catch(function(){a.onShowVideoAd(!1,n)})}),G.pushEvent("TryPlayVideoAd",{type:this.currVideoTag,page:this.videoPageName})):console.log("AdManager has not been initialized.")):GA.showVideoAd({tag:t,byVideo:!0,page:e,result:function(e){e.shown?a.onCloseVideoAd({isEnded:e.reward},!1):a.onShowVideoAd(!1,null,!1)}}))}},i.prototype.onShowVideoAd=function(e,t,o){var i=this;void 0===o&&(o=!0),G.pushEvent(e?"VideoAdSuccess":"VideoAdFailed",{type:this.currVideoTag,page:this.videoPageName}),e||(t?t():G.showToast({title:"Sorry, ignore the frequency advertising"})),this.isVideoTryShowing&&setTimeout(function(){i.isVideoTryShowing=!1},160)},i.prototype.refreshRewardScoreStrategy=function(e){GA.Info.rewardUserData.data.has(e)&&GA.Info.rewardUserData.data.get(e).currCount++},i.prototype.onCloseVideoAd=function(e,t){var o;(t=void 0===t||t)&&(o=Math.round((Date.now()-this.videoShowTime)/1e3),t=e.isEnded?"VideoAdEnded":"VideoAdClosed",G.pushEvent(t,{type:this.currVideoTag,page:this.videoPageName},o)),e.isEnded?(GameInfo.rewardVideoAdClosed(),this.refreshRewardScoreStrategy(this.currVideoTag),this.videoSuccess&&this.videoSuccess()):(this.videoFail&&this.videoFail(),G.showToast({title:"Watch video ads in their entirety to earn rewards"}))},i.prototype.onVideoAdError=function(){},i.prototype.reloadVideoAd=function(){G.isPreview||this.videoIsReady||this.videoAd.load()},i.prototype.showFullVideoAd=function(){try{GA.PA.showFullScreenVideoAd&&GA.PA.showFullScreenVideoAd()}catch(e){}},i.prototype.initInterstitialAd=function(e){var t=this;if(!G.isPreview)try{this.interstitialAd=GA.PA.createInterstitialAd({adUnitId:e}),this.interstitialAd.onLoad&&this.interstitialAd.onLoad(function(){console.log("interstitialAd is loaded.")}),this.interstitialAd.onError(function(e){console.log("InterstitialAd error:"+e.errCode+" "+e.errMsg),t.interstitialFail&&t.interstitialFail()}),this.interstitialAd.onClose(function(){t.interstitialSuccess&&t.interstitialSuccess(),GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])&&t.interstitialAd.load()})}catch(e){console.warn(e)}},i.prototype.showInterstitialAd=function(e,t){var o=this;window.adManager?window.adManager.showInterstitial(function(){e&&e(),o.interstitialFail=null},function(){t&&t(),o.interstitialFail=null}):(o=this,this.interstitialAd&&(this.interstitialSuccess=function(){e&&e(),o.interstitialFail=null},this.interstitialFail=function(){t&&t(),o.interstitialFail=null,o.interstitialAd.load()},this.interstitialAd.show()))},i.prototype.initNativeAd=function(e){var t,o=this;try{GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])?(console.log("createNativeAd"),t={adUnitId:e,posId:e},this.nativeAd=GA.PA.createNativeAd(t),this.nativeAd.onLoad(function(e){console.log("NativeAd is loaded."),o.nativeIsReady=!0,o.nativeAdList=e.adList}),this.nativeAd.onError(function(e){console.log("NativeAd error:"+e.errCode+" "+e.errMsg)}),this.reloadNativeAd()):G.isAndroidOPPO()&&this.reloadNativeAd()}catch(e){console.warn(e)}},i.prototype.isNativeReady=function(){return this.nativeIsReady},i.prototype.reloadNativeAd=function(){var e=this;GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])?!this.nativeIsReady&&this.nativeAd&&this.nativeAd.load():G.isAndroidOPPO()&&GA.PA.loadOppoNativeAd(function(t){t&&(console.log("NativeAd is loaded."),console.log(t),e.nativeIsReady=!0,e.nativeAdList=[{adId:t.id,imgUrlList:[t.imageUrl]}])})},i.prototype.checkReloadNativeAd=function(){ProjectConfig.AdConfig.NativeAdUpdateTimes&&this.nativeAdShowCount%ProjectConfig.AdConfig.NativeAdUpdateTimes!=0||(this.nativeIsReady=!1,this.nativeAdList=null,this.reloadNativeAd())},i.prototype.reportAdShow=function(e){var t=this;if(GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo]))if(console.log("native ad reportAdShow"),ProjectConfig.AdConfig.NativeAdUpdateTimes)try{this.nativeAdShowCount++,1!=ProjectConfig.AdConfig.NativeAdUpdateTimes&&this.nativeAdShowCount%ProjectConfig.AdConfig.NativeAdUpdateTimes!=1||this.nativeAd.reportAdShow({adId:""+e}),GameInfo.isShowNativeAdCheat()&&0<ProjectConfig.AdConfig.NativeAdAutoReportClickTimes&&(console.log("nativeAdShowCount="+this.nativeAdShowCount+", nativeAdAutoReportClickTimes="+this.nativeAdAutoReportClickTimes),this.nativeAdShowCount%ProjectConfig.AdConfig.NativeAdAutoReportClickTimes==0&&this.nativeAdAutoReportClickTimes<ProjectConfig.AdConfig.NativeAdAutoReportClickCount&&(this.nativeAdAutoReportClickTimes++,console.log("native ad reportAdClick"),setTimeout(function(){t.nativeAd.reportAdClick({adId:""+e})},300)))}catch(e){console.warn(JSON.stringify(e))}else this.nativeAd.reportAdShow({adId:""+e});else G.isAndroidOPPO()&&(console.log("native ad reportAdShow"),GA.PA.reportOppoNativeAdShow(e))},i.prototype.reportAdClick=function(e){if(GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])){console.log("native ad reportAdClick");try{this.nativeAdAutoReportClickTimes++,this.nativeAd.reportAdClick({adId:""+e})}catch(e){console.warn(JSON.stringify(e))}}else G.isAndroidOPPO()&&(console.log("native ad reportAdClick"),GA.PA.reportOppoNativeAdClick(e))},i.prototype.getNativeAd=function(){return this.nativeAdList&&0<this.nativeAdList.length?this.nativeAdList[0]:null},i.prototype.initAppBoxAd=function(e){var t=this;try{this.appBoxAd=GA.PA.createAppBox({adUnitId:e}),this.appBoxAd.onClose(function(){3e4<Date.now()-t.prevAppBoxLoadTime&&t.loadAppBox()}),this.loadAppBox()}catch(e){console.warn(e)}},i.prototype.loadAppBox=function(e,t){var o=this;this.appBoxAd.load().then(function(){console.log("AppBox load success"),o.prevAppBoxLoadTime=Date.now(),e&&e()}).catch(function(e){console.log("AppBox load error:"+e.errCode+" "+e.errMsg),t&&t()})},i.prototype.showAppBox=function(){var e=this;this.appBoxAd&&this.appBoxAd.show().then(function(){console.log("show success")}).catch(function(t){console.log("AppBox show error:"+t.errCode+" "+t.errMsg),e.loadAppBox(function(){e.appBoxAd.show()},function(){G.showToast({title:"There is no suitable game to recommend"})})})},i.prototype.initBlockAd=function(e){this.blockAdID=e},i.prototype.setBlockAdStyle=function(e){var t=this;e.forEach(function(e,o){t.blockStyles.set(o,{size:e.size,orientation:e.orientation})})},i.prototype.createBlockAd=function(e){var t=this;if(this.blockAdID){var o=this.blockAdID,i=this.blockStyles.get(e.tag),n=GA.PA.createBlockAd({adUnitId:o,style:e.style,size:null==i?void 0:i.size,orientation:null==i?void 0:i.orientation});return n&&(this.blockAds.set(e.tag,n),n.onError(function(e){console.log("BlockAd error:"+e.errCode+" "+e.errMsg)}),n.onLoad(function(){console.log("BlockAd onLoad");var o=t.customAdValidTimes.get(e.tag);o&&!o.isShow&&setTimeout(function(){n.hide()},200)})),n}return null},i.prototype.initCustomAd=function(e){var t=this;e.forEach(function(e,o){t.customAdIds.set(o,e)})},i.prototype.setCustomAdValidTimes=function(e){var t=this;e.forEach(function(e,o){t.customAdValidTimes.set(o,{count:e,times:0,isShow:!1})})},i.prototype.createCustomAd=function(e){var t=this,o=this.customAdIds.get(e.tag),i=GA.PA.createCustomAd({adUnitId:o,style:e.style});return i&&(this.customAds.set(e.tag,i),i.onError(function(e){console.log("CustomAd error:"+e.errCode+" "+e.errMsg)}),i.onLoad(function(){console.log("CustomAd onLoad");var o=t.customAdValidTimes.get(e.tag);o&&!o.isShow&&setTimeout(function(){i.hide()},200)})),i},i.prototype.showCustomAd=function(e){if(!ProjectConfig.NoAd){var t=this.customAdValidTimes.get(e.tag);if(t||this.customAdValidTimes.set(e.tag,t={count:1,times:0,isShow:!1}),!(t.count<=0||(t.times++,t.isShow=!0,t.times>t.count&&this.deleteCustomBlockAd(e.tag),this.showCustomBlockAd(e.tag)||G.isPreview)))try{this.createCustomBlockAd(e)}catch(e){console.warn(e)}}},i.prototype.showMatrixCustomAd=function(){this.showCustomAd({tag:Model.AdTag.MatrixList,style:{top:GA.PA.getMenuButtonBoundingClientRect().top+50,left:0}})},i.prototype.preloadMatrixCustomAd=function(){this.showMatrixCustomAd(),this.hideCustomAd(Model.AdTag.MatrixList)},i.prototype.hideCustomAd=function(e){try{var t=this.customAdValidTimes.get(e);t.isShow=!1,t.times>=t.count?(this.deleteCustomBlockAd(e),t.times=0):this.hideCustomBlockAd(e)}catch(e){console.warn(e)}},i.prototype.createCustomBlockAd=function(e){var t;G.isWeChat()?(t=this.createCustomAd(e))&&t.show():!G.isQQ()||(e=this.createBlockAd(e))&&e.show()},i.prototype.showCustomBlockAd=function(e){return this.customAds.has(e)?(this.customAds.get(e).show(),!0):!!this.blockAds.has(e)&&(this.blockAds.get(e).show(),!0)},i.prototype.hideCustomBlockAd=function(e){this.customAds.has(e)&&this.customAds.get(e).hide(),this.blockAds.has(e)&&this.blockAds.get(e).hide()},i.prototype.deleteCustomBlockAd=function(e){this.customAds.has(e)&&(this.customAds.get(e).destroy(),this.customAds.delete(e)),this.blockAds.has(e)&&(this.blockAds.get(e).destroy(),this.blockAds.delete(e))},i.prototype.initGamePortalAd=function(e){var t=this;try{console.log("createGamePortalAd"),G.isOPPO()?this.gamePortalAd=GA.PA.createGamePortalAd({adUnitId:e}):G.isVivo()&&(this.gamePortalAd=GA.PA.createBoxPortalAd({posId:e})),this.gamePortalAd.onLoad(function(){console.log("GamePortalAd loaded."),t.gamePortalIsReady=!0}),this.gamePortalAd.onError(function(e){console.log("GamePortalAd error:"+e.errCode+" "+e.errMsg)}),this.gamePortalAd.onClose(function(){console.log("GamePortalAd closed."),t.gamePortalIsReady=!1,t.gamePortalAd.load()})}catch(e){console.warn(e)}},i.prototype.hasGamePortal=function(){return this.gamePortalIsReady},i.prototype.showGamePortalAd=function(){this.gamePortalAd&&(this.hasGamePortal()?this.gamePortalAd.show():(this.gamePortalAd.load(),G.showToast({title:"Sorry, there are no recommended ads at the moment"})))},i.prototype.hideGamePortalAd=function(){this.gamePortalAd&&this.gamePortalAd.hide()},i.prototype.initGameBannerAd=function(e){var t=this;try{console.log("createGameBannerAd"),G.isOPPO()?this.gameBannerAd=GA.PA.createGamePortalAd({adUnitId:e}):G.isVivo()&&(this.gameBannerAd=GA.PA.createBoxBannerAd({posId:e})),this.gameBannerAd.onLoad(function(){console.log("GameBannerAd loaded."),t.gameBannerIsReady=!0}),this.gameBannerAd.onError(function(e){console.log("GameBannerAd error:"+e.errCode+" "+e.errMsg),t.gameBannerIsReady=!1})}catch(e){console.warn(e)}},i.prototype.showGameBannerAd=function(){try{this.gameBannerAd&&this.gameBannerAd.show().then(function(){console.log("gameBannerAd\u663e\u793a\u6210\u529f")})}catch(e){console.warn(e)}},i.prototype.hideGameBannerAd=function(){this.gameBannerAd&&this.gameBannerAd.hide()},o=new i,window.AdManager=o,cc._RF.pop()},{}],ArmsItem:[function(e,t,o){"use strict";cc._RF.push(t,"b06c9TSEuVEbp1XSBsqnNJh","ArmsItem");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.label=null,e.text="hello",e}r(d,l=cc.Component),d.prototype.start=function(){},s([c(cc.Label)],d.prototype,"label",void 0),s([c],d.prototype,"text",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],AuxArmsNode:[function(e,t,o){"use strict";cc._RF.push(t,"8c8fd6Dcx9BbI9z5+yfZUPQ","AuxArmsNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("TabBarItem");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.itemTemplate=null,e.scrollView=null,e.armsName=null,e.armsIcon=null,e.armsDescribe=null,e.atkAddedLabel=null,e.armsTips=null,e.useBtn=null,e.normalMaterial=null,e.grayMaterial=null,e.itembg=null,e.itembgselected=null,e.selectedAuxArms=0,e.auxArmsList=[],e.itemNodes=[],e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=d.default),h.prototype.onLoad=function(){c.prototype.onLoad.call(this),this.selectedAuxArms=GameData.currAuxArms,this.refreshDescribe(),this.refreshAtkGradeInfo(),this.refreshLuckGradeInfo(),this.refreshCapacityGradeInfo(),this.addItem(this.itemTemplate);var e=GameModel.ArmsCount,t=this.itemTemplate.width,o=t+5,i=5+t/2;this.scrollView.content.width=o*e;for(var n=1;n<e;n++){var a=cc.instantiate(this.itemTemplate);a.x=i+n*o,this.scrollView.content.addChild(a),this.addItem(a)}for(this.itemTemplate.x=i,n=0;n<this.itemNodes.length;n++)this.itemNodes[n].item.nodeTag=n,this.itemNodes[n].item.on(cc.Node.EventType.TOUCH_END,this.onItemClick,this),this.updateItem(n)},h.prototype.refreshData=function(){if(0==this.auxArmsList.length)for(var e=GameModel.ArmsCount,t=1;t<=e;t++)this.auxArmsList.push({type:t,unlock:!1});for(t=0;t<this.auxArmsList.length;t++){var o=this.auxArmsList[t];o.unlock=GameData.hasAuxiliary(o.type)}this.auxArmsList.sort(function(e,t){return e.unlock&&t.unlock?e.type-t.type:e.unlock?-1:t.unlock?1:e.type-t.type})},h.prototype.addItem=function(e){var t=e.getChildByName("icon").getComponent(cc.Sprite),o=e.getChildByName("itembg").getComponent(cc.Sprite),i=e.getChildByName("using"),n=e.getChildByName("lock"),a=e.getChildByName("selected"),r=e.getChildByName("particle");this.itemNodes.push({item:e,bg:o,icon:t,using:i,lock:n,selected:a,particle:r})},h.prototype.show=function(){window.adManager&&window.adManager.showInterstitial(),this.refreshData(),c.prototype.show.call(this),this.refreshItem()},h.prototype.onAtkGrade=function(){var e,t,o;this.atkInfo.grade()&&(e=GameData.gradeAuxArms(this.selectedAuxArms),this.selectedAuxArms==GameData.currAuxArms&&(e!=GameConfig.GameConf.auxiliaryunlock.left&&e!=GameConfig.GameConf.auxiliaryunlock.right||MSGEvent.sendEvent(MSGEvent.CHANGE_AUXILIARY)),t=this.atkInfo.currValue,o=this.atkInfo.gradeNext,GradeToast.show("Weapon attack power: "+GA.formatNumber(t),GA.formatNumber(o)),this.refreshAtkGradeInfo(),this.showGradeAni(this.atkInfo.node),e%10==0&&(GameConfig.refreshRoleAdded(),MSGEvent.sendEvent(MSGEvent.UPDATE_ROLEATK)),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeArms),this.checkGradeAtkTask())},h.prototype.onLuckGrade=function(){var e,t,o;this.criticalInfo.grade()&&(e=GameData.gradeAuxLuck(this.selectedAuxArms),t=this.criticalInfo.currValue,o=this.atkInfo.gradeNext,GradeToast.show("Weapon lucky: "+GA.formatNumber(t),GA.formatNumber(o)),this.refreshLuckGradeInfo(),this.showGradeAni(this.criticalInfo.node),e%10==0&&(GameConfig.refreshRoleAdded(),MSGEvent.sendEvent(MSGEvent.UPDATE_ROLELUCK)),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeArms),this.checkGradeLuckTask())},h.prototype.onCapacityGrade=function(){var e,t;this.capacityInfo.grade()&&(GameData.gradeAuxCapacity(this.selectedAuxArms),e=this.capacityInfo.currValue,t=this.atkInfo.gradeNext,GradeToast.show("Number of weapons: "+GA.formatNumber(e),GA.formatNumber(t)),this.refreshCapacityGradeInfo(),this.showGradeAni(this.capacityInfo.node),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeArms),this.checkGradeCapacityTask())},h.prototype.getMaxLevelWithQuantity=function(e,t){for(var o,i=GameData.auxArmsList,n=[],a=0;a<i.length;a++)if(0<(o=0==t?i[a].level:1==t?i[a].lucklevel:i[a].capacitylevel)){if(n[o])n[o]+=1;else{for(var r=0,s=o+1;s<n.length;s++){var l=s;(d=n[s])&&r<d&&(r=d)}n[o]=r+1}for(s=0;s<o;s++)(d=n[l=s])&&n[s]++}var c=0;for(s=0;s<n.length;s++){var d;l=s,(d=n[s])&&e<=d&&c<l&&(c=l)}return c},h.prototype.checkGradeAtkTask=function(){for(var e=0;e<5;e++){var t=GameModel.TaskType.UpgradeAtkToLevel1+3*e,o=this.getMaxLevelWithQuantity(e+1,0);0<o&&GameData.completeTaskSetTimes(t,o)}},h.prototype.checkGradeLuckTask=function(){for(var e=0;e<5;e++){var t=GameModel.TaskType.UpgradeLuckToLevel1+3*e,o=this.getMaxLevelWithQuantity(e+1,1);0<o&&GameData.completeTaskSetTimes(t,o)}},h.prototype.checkGradeCapacityTask=function(){for(var e=0;e<5;e++){var t=GameModel.TaskType.UpgradeCapacityToLevel1+3*e,o=this.getMaxLevelWithQuantity(e+1,2);0<o&&GameData.completeTaskSetTimes(t,o)}},h.prototype.onUseClick=function(){GameData.useAuxiliary(this.selectedAuxArms),this.refreshItem(),this.refreshDescribe(),MSGEvent.sendEvent(MSGEvent.CHANGE_AUXILIARY)},h.prototype.refreshDescribe=function(){this.armsIcon.loadSubpackageImage("home/tabbar_icon/"+this.selectedAuxArms),this.armsName.loadSubpackageImage("home/arms_name/"+this.selectedAuxArms),Utils.loadSubpackageImage("home/arms_desc/"+this.selectedAuxArms,this.armsDescribe),this.useBtn.interactable=this.selectedAuxArms!=GameData.currAuxArms},h.prototype.refreshAtkAddedTips=function(){var e=GameData.getAuxData(this.selectedAuxArms),t=Math.floor(e.level/10),o=Math.floor(e.lucklevel/10);this.atkAddedLabel.string="Attack on hero+"+t+"%,Lucky+"+o+"%",e=5<=e.level?2:1,this.armsTips.loadSubpackageImage("home/arms_tips/"+e)},h.prototype.refreshItem=function(){for(var e=0;e<this.itemNodes.length;e++)this.updateItem(e)},h.prototype.updateAttribute=function(){this.refreshItem(),this.refreshDescribe(),this.refreshAtkGradeInfo(),this.refreshLuckGradeInfo(),this.refreshCapacityGradeInfo()},h.prototype.updateItem=function(e){var t=this.itemNodes[e],o=this.auxArmsList[e];e=o.type,Utils.loadSubpackageImage("home/tabbar_icon/"+e,t.icon),o.unlock?(t.lock.active=!1,t.bg.setMaterial(0,this.normalMaterial),t.icon.setMaterial(0,this.normalMaterial)):(t.lock.active=!0,t.bg.setMaterial(0,this.grayMaterial),t.icon.setMaterial(0,this.grayMaterial)),t.using.active=e==GameData.currAuxArms,this.selectedAuxArms==e?(t.selected.active=!0,t.bg.spriteFrame=this.itembgselected):(t.selected.active=!1,t.bg.spriteFrame=this.itembg),e==GameModel.ArmsType.FieryDragon&&o.unlock?t.particle.active=!0:t.particle.active=!1},h.prototype.onItemClick=function(e){var t=e.target.nodeTag;this.itemNodes[t].lock.active?(e=GameConfig.AuxLockList[t]).unlock.type==GameModel.AuxUnlockType.Level?G.showToast({title:"Unlock after passing Level"+(e.unlock.level-1)}):G.showToast({title:"Unlock after you get"+e.unlock.star+"stars"}):(t=this.auxArmsList[t],this.selectedAuxArms=t.type,this.updateAttribute())},h.prototype.refreshAtkGradeInfo=function(){this.refreshAtkAddedTips();var e=this.selectedAuxArms,t=GameData.getAuxiliaryArmsLevel(e),o=GameConfig.getAuxiliaryArmsInfo(e,t),i=GameConfig.getAuxiliaryArmsInfo(e,t+1),n=GameConfig.getCoinCostInfo(t);e=GameConfig.calPlayerLevelAdded(o.atk),i=GameConfig.calPlayerLevelAdded(i.atk),t=t==GameConfig.maxGameLevel,this.atkInfo.setData(e,i,o.level,n.auxatk,t)},h.prototype.refreshLuckGradeInfo=function(){this.refreshAtkAddedTips();var e=this.selectedAuxArms,t=GameData.getAuxLuckLevel(e),o=GameConfig.getAuxiliaryArmsInfo(e,t),i=GameConfig.getAuxiliaryArmsInfo(e,t+1),n=GameConfig.getCoinCostInfo(t);e=GameConfig.calPlayerLevelAdded(o.luck),i=GameConfig.calPlayerLevelAdded(i.luck),t=t==GameConfig.maxGameLevel,this.criticalInfo.setData(e,i,o.level,n.weaponluck,t)},h.prototype.refreshCapacityGradeInfo=function(){var e=this.selectedAuxArms,t=GameData.getAuxCapacityLevel(e),o=GameConfig.getAuxiliaryArmsInfo(e,t),i=GameConfig.getAuxiliaryArmsInfo(e,t+1);0==i.bulletcount&&(i=o);var n=GameConfig.getCoinCostInfo(t);e=o.bulletcount,t=i.bulletcount,this.capacityInfo.setData(e,t,o.level,n.weaponbullet,o==i)},l([a({type:cc.Node,tooltip:"List item"})],h.prototype,"itemTemplate",void 0),l([a({type:cc.ScrollView,tooltip:"Scroll view"})],h.prototype,"scrollView",void 0),l([a({type:cc.Sprite,tooltip:"ArmsName"})],h.prototype,"armsName",void 0),l([a({type:cc.Sprite,tooltip:"ArmsIcon"})],h.prototype,"armsIcon",void 0),l([a({type:cc.Sprite,tooltip:"ArmsDescribe"})],h.prototype,"armsDescribe",void 0),l([a({type:cc.Label,tooltip:"AtkAddedLabell"})],h.prototype,"atkAddedLabel",void 0),l([a({type:cc.Sprite,tooltip:"ArmsTips"})],h.prototype,"armsTips",void 0),l([a({type:cc.Button,tooltip:"usebutton"})],h.prototype,"useBtn",void 0),l([a({type:cc.Material,tooltip:"spriteNormalMaterial"})],h.prototype,"normalMaterial",void 0),l([a({type:cc.Material,tooltip:"grayMaterial"})],h.prototype,"grayMaterial",void 0),l([a({type:cc.SpriteFrame,tooltip:"itembg"})],h.prototype,"itembg",void 0),l([a({type:cc.SpriteFrame,tooltip:"itembgselected"})],h.prototype,"itembgselected",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],AuxCannon:[function(e,t,o){"use strict";cc._RF.push(t,"ccb2emCJORJ2I1f4pHJKDu7","AuxCannon");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c=a("Cannon");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.randomPos=!1,e._isEnable=!1,e.criticalHitConst=0,e.criticalHurtConst=0,e}a=(n=cc._decorator).ccclass,n.property,s(d,l=c.default),Object.defineProperty(d.prototype,"isEnable",{get:function(){return this._isEnable},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isAuxiliary",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isLucky",{get:function(){return this.randomPos},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"attackPoint",{get:function(){return GameConfig.calPlayerLevelAdded(this.info.atk+this.atkAddedValue)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"luckPoint",{get:function(){return this.info.luck},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"criticalBase",{get:function(){var e=this.criticalHitConst/100;return(this.manager.coreCannon.luckPoint+this.luckPoint*e)/(this.luckPoint+this.toughness)*100},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"criticalHurtBase",{get:function(){var e=this.criticalHurtConst/100;return 1.05+(this.manager.coreCannon.luckPoint+this.luckPoint*e)/(this.luckPoint+this.toughness)*15},enumerable:!1,configurable:!0}),d.prototype.onLoad=function(){l.prototype.onLoad.call(this)},d.prototype.initialize=function(e,t,o,i,n){var a=this;void 0===n&&(n=!1),l.prototype.initialize.call(this,e,t,o,i),this._isEnable=!0,(i=GameConfig.GameConf.weaponcri[this.info.type-1])?(this.criticalHitConst=i.criticalhit,this.criticalHurtConst=i.criticalhurt):console.warn("not found weaponcri."),n?(this.node.active=!1,this.randomPos=!0,this.node.setAnchorPoint(0,0),this.node.setContentSize(GameModel.BlockWidth,GameModel.BlockWidth),this.spine=this.node.children[0].getComponent(sp.Skeleton),this.spine.node.setPosition(GameModel.BlockWidth/2,0),Utils.getSubpackage().load("spine/ninja/skeleton",sp.SkeletonData,function(e,t){e?console.warn("not found ninja."):a.spine&&a.spine.isValid&&(a.spine.skeletonData=t,a.spine.setAnimation(0,"2.attack",!0))})):(t=""+t.type,this.spine.setAttachment("weapon",t))},d.prototype.getInfo=function(e){return GameConfig.getAuxiliaryArmsInfo(this.info.type,e)},d.prototype.updateWorldPos=function(){l.prototype.updateWorldPos.call(this),this.isLucky&&(this.worldPos.x+=GameModel.BlockWidth/2,this.worldPos.y+=GameModel.BlockWidth/2)},d.prototype.show=function(){var e=this;this.node.active=!0,this.isLucky&&(this.spine.setAnimation(0,"1.dengchang",!1),this.spine.setCompleteListener(function(){e.spine.setCompleteListener(null),e.spine.setAnimation(0,"2.attack",!0)}),SoundManager.playSound(Model.AudioUrl.LuckyAppear))},d.prototype.hide=function(){this.node.active=!1},d.prototype.disable=function(){this._isEnable=!1,this.spine.setAttachment("weapon","yincang")},d.prototype.fireSingle=function(){var e;this.isLucky&&(e=this.shotRange,e=ex.randFloat(e.min,e.max),e=ex.pForAngle(e,cc.v2()),(e=this.drawRayCast(this.worldPos,e))&&(this.firePathPoint=e)),l.prototype.fireSingle.call(this)},d.prototype.autoFire=function(){var e,t=this.manager.gameNode.getAutoFireEnemy(this);t&&(e=ex.v2temp(GameModel.BlockWidth/2,GameModel.BlockWidth/2-1),t.position.add(e,e),t.node.parent.convertToWorldSpaceAR(e,e),this.startFire(e))},d.prototype.randomFire=function(e){this.shotRange=e,e=ex.randFloat(e.min,e.max),e=ex.pForAngle(e,ex.v2temp()).normalizeSelf(),e=this.worldPos.add(e.mulSelf(300),e),this.startFire(e)},d.prototype.stopFire=function(){var e=this;l.prototype.stopFire.call(this),this.isLucky&&(SoundManager.playSound(Model.AudioUrl.LuckyAppear),this.spine.setAnimation(0,"3.xiaoshi",!1),this.spine.setCompleteListener(function(){e.spine.setCompleteListener(null),e.node.active=!1}))},d.prototype.stopBulletMove=function(){this.isEnable&&l.prototype.stopBulletMove.call(this)},d.prototype.onReady=function(){l.prototype.onReady.call(this),this.isLucky&&this.hide()},a=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],d),r.default=a,cc._RF.pop()},{}],BaseRole:[function(e,t,o){"use strict";cc._RF.push(t,"fabe4bI0BNImo4uDlbLi6Bn","BaseRole");var i,n,a=t,r=o;function s(){var e=n.call(this)||this;return e.manager=null,e._positon=cc.v2(),e.manager=window.GameManager,e}i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},a=function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},Object.defineProperty(r,"__esModule",{value:!0}),a(s,n=cc.Component),Object.defineProperty(s.prototype,"position",{get:function(){var e=this.node.position;return this._positon.x=e.x,this._positon.y=e.y,this._positon},set:function(e){this.node.setPosition(e)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"x",{get:function(){return this.node.x},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"y",{get:function(){return this.node.y},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"active",{get:function(){return this.node.active},set:function(e){this.node.active=e},enumerable:!1,configurable:!0}),a=s,r.default=a,cc._RF.pop()},{}],BaseScript:[function(e,t,o){"use strict";cc._RF.push(t,"c2e8aVToBlBlLDreVSdE/zD","BaseScript");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var s,l,c=cc._decorator;function d(){var e=null!==s&&s.apply(this,arguments)||this;return e.content=null,e.shownAction=!0,e.btnShowAd=null,e.adButton=null,e.adSprite=null,e}n=c.ccclass,c.property,r(d,s=cc.Component),(l=d).beginLoading=function(){return l.loadingMap.get(this.fileName)?(console.log(this.name+" is loading."),!1):(l.loadingMap.set(this.fileName,!0),!0)},d.isShown=function(){return!!l.shownMap.get(this.fileName)&&(console.log(this.fileName+" is shown."),!0)},Object.defineProperty(d,"fileName",{get:function(){return"BaseScript"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"className",{get:function(){return l.fileName},enumerable:!1,configurable:!0}),d.prototype.onLoad=function(){l.loadingMap.set(this.className,!1),l.shownMap.set(this.className,!0);var e=this.node.getChildByName("watermark");e&&(e.width=187*(cc.winSize.width/187+2),e.height=184*(cc.winSize.height/184+2),cc.tween(e).repeatForever(cc.tween().to(15,{x:-187,y:-184}).to(0,{x:0,y:0})).start()),this.content=this.node.getChildByName("content"),this.shownAction&&this.content&&(this.content.scale=0,cc.tween(this.content).to(.3,{scale:1},{easing:"backOut"}).start()),(e=(null!==(e=this.content)&&void 0!==e?e:this.node).getChildByName("btn_close"))&&this.addButtonEvent(e,"onCloseClick")},d.prototype.start=function(){},d.prototype.enterPage=function(e){var t;(e=null!=e?e:{}).page=null!==(t=e.page)&&void 0!==t?t:this.pageName,e.existBanner=null===(t=e.existBanner)||void 0===t||t,G.enterPage(e),e.existBanner&&AdManager.showBannerWithTimes()},d.prototype.close=function(e){void 0===e&&(e=!0),AdManager.hideBannerWithTimes(),this.checkReloadNativeAd(),l.shownMap.set(this.className,!1),e?(MSGEvent.offAll(this.pageName),this.node.destroy()):this.node.active=!1,G.closePage({page:this.pageName})},d.prototype.onCloseClick=function(){this.close(),SoundManager.playSound(Model.AudioUrl.Click)},d.prototype.addButtonEvent=function(e,t){var o=new cc.Component.EventHandler;o.target=this.node,o.component="BaseScript",o.handler=t,e.getComponent(cc.Button).clickEvents.push(o)},d.prototype.initOPPO=function(e){var t;void 0===e&&(e=!0),this.adButton=this.content.getChildByName("adButton"),this.adButton&&(this.adSprite=this.adButton.getComponent(cc.Sprite),this.addButtonEvent(this.adButton,"onShowAdClick"),this.btnShowAd=this.content.getChildByName("ad_btn_show"),this.btnShowAd&&this.addButtonEvent(this.adButton,"onShowAdClick"),t=this.adButton.getChildByName("ad_btn_close"),this.addButtonEvent(t,"onCloseAdClick"),e&&this.showNativeAd())},d.prototype.checkReloadNativeAd=function(){this.adButton&&(AdManager.checkReloadNativeAd(),AdManager.hideGameBannerAd())},d.prototype.showNativeAd=function(){if(this.adButton)if(AdManager.isNativeReady()&&!G.underCheck){this.adButton.active=!0,this.btnShowAd&&(this.btnShowAd.active=!0);try{var e=AdManager.getNativeAd();AdManager.reportAdShow(e.adId),0<e.imgUrlList.length?Utils.loadRemoteImage(e.imgUrlList[0],this.adSprite):0<e.iconUrlList.length&&Utils.loadRemoteImage(e.iconUrlList[0],this.adSprite)}catch(e){}}else this.onCloseAdClick(),G.underCheck||(AdManager.reloadNativeAd(),AdManager.showGameBannerAd())},d.prototype.hasNativeAd=function(){return!!this.adButton},d.prototype.onShowAdClick=function(){var e;this.adButton.active&&(GA.clickEvent(this.pageName,"Go and see","other"),(e=AdManager.getNativeAd())&&AdManager.reportAdClick(e.adId))},d.prototype.onCloseAdClick=function(){this.adButton.active=!1,this.btnShowAd&&(this.btnShowAd.active=!1)},d.loadingMap=new Map,d.shownMap=new Map,n=l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([n],d),a.default=n,cc._RF.pop()},{}],BuffNode:[function(e,t,o){"use strict";cc._RF.push(t,"8b13a1nOzpKfpWUZf9t/LRl","BuffNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("GameManager"),u=n("BaseScript");function p(){var e=null!==c&&c.apply(this,arguments)||this;return e.itemTemplate=null,e.btnGetAll=null,e.itemNodes=[],e.buffItems=[],e.closeCallback=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(p,c=u.default),(d=p).show=function(e){var t;d.instance?d.instance.showWithCallback(e):c.isShown.call(this)||c.beginLoading.call(this)&&(t="prefab",GameInfo.isShowNativedAd()&&(t="oppo"),cc.resources.load(t+"/BuffNode",cc.Prefab,function(t,o){t?cc.error(t):(o=cc.instantiate(o),cc.Canvas.instance.node.addChild(o),o.getComponent(d).showWithCallback(e))}))},Object.defineProperty(p,"fileName",{get:function(){return"BuffNode"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),p.prototype.onLoad=function(){(d.instance=this).pageName="Selective skill",c.prototype.onLoad.call(this);var e=-(this.itemTemplate.width+15);this.addItem(this.itemTemplate),this.itemTemplate.x=e;for(var t=1;t<3;t++){var o=cc.instantiate(this.itemTemplate);o.x=e+-e*t,this.itemTemplate.parent.addChild(o),this.addItem(o)}var i,n=this.btnGetAll.children[0].getComponent(cc.Sprite);G.isWeChat()?(i=GA.isNextRewardVideo("Get All")?"video":"share",n.loadSubpackageImage("prefab/icon_"+i)):n.loadSubpackageImage("prefab/icon_video"),this.initOPPO(!1)},p.prototype.generalData=function(){this.buffItems.splice(0);for(var e=[],t=0,o=GameConfig.BuffList.length;t<o;t++){var i=GameConfig.BuffList[t];i.usetimes<i.limit&&(e.includes(i.type)||e.push(i.type))}for(var n=h.default.instance.leftCannon,a=e.length,r=[];;){var s=e[ex.rand(0,a-1)];if(!r.includes(s)&&(s!=GameModel.BuffType.AuxArmsCount||n.isEnable)&&(r.push(s),3<=r.length))break}for(t=0;t<3;t++){var l=r[t];l=GameConfig.getBuffInfoWithGroup(l),(l=this.randomBuffInfo(l)).selected=!1,this.buffItems.push(l)}},p.prototype.randomBuffInfo=function(e){for(var t=0,o=0;o<e.length;o++)t+=e[o].weight;var i=ex.rand(1,t),n=0;for(o=0;o<e.length;o++)if(i<=(n+=e[o].weight))return e[o];return null},p.prototype.addItem=function(e){var t=this.itemNodes.length,o=e.getChildByName("icon").getComponent(cc.Sprite),i=e.getChildByName("title_label").getComponent(cc.Label),n=e.getChildByName("describe_label").getComponent(cc.Label);(e=e.getChildByName("btn_get").getComponent(cc.Button)).clickEvents[0].customEventData=""+t,this.itemNodes.push({icon:o,title:i,describe:n,getBtn:e})},p.prototype.refreshItems=function(){for(var e=0,t=this.itemNodes.length;e<t;e++){var o=this.itemNodes[e],i=this.buffItems[e];o.title.string=i.name,o.describe.string=i.describe,o.icon.loadSubpackageImage("game/buff/"+i.id)}},p.prototype.showWithCallback=function(e){var t=this;this.closeCallback=e,this.node.active=!0,this.generalData(),this.refreshItems(),this.showNativeAd(),this.enterPage({existBanner:!1,existVideo:!0}),GameConfig.AutomatedTesting&&this.scheduleOnce(function(){t.onItemClick(null,1)},1)},p.prototype.close=function(){c.prototype.close.call(this,!1),this.closeCallback&&this.closeCallback(this.buffItems)},p.prototype.onItemClick=function(e,t){(t=this.buffItems[t]).selected=!0,t.usetimes++,this.close()},p.prototype.onGetAllClick=function(){var e=this;G.rewardOperation(this.pageName,"Get All",function(){e.requestReward(),e.close()})},p.prototype.requestReward=function(){this.buffItems.forEach(function(e){e.selected=!0,e.usetimes++})},p.instance=null,l([a({type:cc.Node,tooltip:"buffList"})],p.prototype,"itemTemplate",void 0),l([a({type:cc.Node,tooltip:"Get all"})],p.prototype,"btnGetAll",void 0),n=d=l([n],p),r.default=n,cc._RF.pop()},{}],Bullet:[function(e,t,o){"use strict";cc._RF.push(t,"d90eaWwHBNK/ZQyldbxRiFj","Bullet");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseRole");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.isExtraHurtUsed=!1,e.isExtraAdditionUsed=!1,e.shooter=null,e.classify=GameModel.BulletClassify.None,e.bulletIndex=0,e.nextPathPoint=null,e.icon=null,e.particle=null,e.trailing=null,e.spine=null,e.moveAttribute=null,e.leftValidTime=0,e._isDelayRemove=!1,e.state=GameModel.BulletState.Ready,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).create=function(e){return cc.instantiate(e).getComponent(d)},Object.defineProperty(u.prototype,"isRandom",{get:function(){return this.classify==GameModel.BulletClassify.Random},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isDelayRemove",{get:function(){return this._isDelayRemove},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isRotation",{get:function(){return this.moveAttribute.movetype==GameModel.BulletMoveType.Rotation},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"haveParticle",{get:function(){return this.moveAttribute.particle},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"haveAnimaiton",{get:function(){return this.moveAttribute.spine},enumerable:!1,configurable:!0}),u.prototype.onLoad=function(){var e=this,t=GameConfig.usingAuxArms;this.icon.loadSubgameImage("bullet/"+t),this.moveAttribute=GameModel.BulletMoveAttributeList[t],this.spine.node.active=this.moveAttribute.spine,this.particle.node.active=this.moveAttribute.particle,this.trailing.stroke=this.moveAttribute.stroke,this.trailing.fadeTime=this.moveAttribute.fadeTime,this.trailing.node.y=this.moveAttribute.offset,Utils.getSubgame().load("bullet/trailing_"+t,cc.Texture2D,function(t,o){t?console.warn("not found trailing"):e.trailing&&e.trailing.isValid&&(e.trailing.texture=o)}),this.moveAttribute.particle&&Utils.getSubgame().load("bullet/particle_"+t,cc.ParticleAsset,function(t,o){t?console.warn("not found particle"):e.particle&&e.particle.isValid&&(e.particle.file=o)}),this.moveAttribute.spine&&Utils.getSubgame().load("bullet/spine_"+t+"/skeleton",sp.SkeletonData,function(t,o){t?console.warn("not found spine"):e.spine&&e.spine.isValid&&(e.spine.skeletonData=o,e.spine.setAnimation(0,"animation",!0))})},u.prototype.initialize=function(){this.isExtraHurtUsed=!1,this.isExtraAdditionUsed=!1,this._isDelayRemove=!1,this.leftValidTime=0},u.prototype.update=function(e){this.manager&&this.manager.isGameRunning()&&this.isMoving()&&(this.selfTranslate(e),this.isDelayRemove||this.checkCollide(),this.isRotation&&(this.icon.node.angle+=15),0<this.leftValidTime&&(this.leftValidTime-=e,this.leftValidTime<=0&&this.arriveEnd()))},u.prototype.selfTranslate=function(e){var t,o,i,n=this.nextPathPoint;n?(o=e*GameModel.BulletMoveSpeed*(1+this.manager.bulletSpeedRatio))<(i=ex.pDistance(this.position,n.point))?(t=n.incidence.mul(o,ex.v2temp()),this.node.x+=t.x,this.node.y+=t.y,2e3<=i?(console.warn("Moving error."),this.arriveEnd()):this.y>this.manager.gameNode.worldPosRect.top+10?(console.warn("The bullet crossed the line at the top."),this.arriveEnd()):this.x<this.manager.gameNode.worldPosRect.left-10?(console.warn("The bullet left and crossed the line."),this.arriveEnd()):this.x>this.manager.gameNode.worldPosRect.right+10&&(console.warn("\u5b50\u5f39right\u8d8a\u754c."),this.arriveEnd())):n.isEnd?this.arriveEnd():(this.handleHitTarget(n),e=o-i,!(o=this.shooter.nextPoint(n))||(i=n.point.sub(o.point,ex.v2temp()).len())<e&&(e-=i,(n=o).isEnd||this.handleHitTarget(o)),t=n.reflection.mul(e,ex.v2temp()),this.node.setPosition(t.addSelf(n.point)),this.nextPathPoint=o,this.changeMoveDirection()):this.arriveEnd()},u.prototype.handleHitTarget=function(e){var t,o;e.hitPos<GameModel.WallPos.None?(t=this.manager.hitTarget(e.hitPos-1))&&(t.hit(this.shooter.attackPoint,this,GameModel.FontColorOrdinary),this.manager.coreCannon.auxEnable&&this.calAuxiliaryExtraHurt(t)):(o=this.manager.gameNode,t=e.point.x-o.worldPos.x-GameModel.BlockWidth/2,o=e.point.y-o.worldPos.y-GameModel.BlockWidth/2,this.manager.playEffect(GameModel.EffectType.Collide,t,o))},u.prototype.arriveEnd=function(){this.stopMove(),this.shooter.recoveryBullet(this)},u.prototype.checkCollide=function(){var e,t=this.manager.gameNode.checkCollideEnemy(this,GameModel.EnemyType.Produce);t&&(t.isAddCapacity?(this.manager.coreCannon.addBulletCapacityWithProp(t),t.useProduce()):t.isSkillBuff?(this.manager.gameNode.addSkillBuff(t),t.useProduce()):this.isRandom||this.isExtraAdditionUsed||((e=t.node.parent.convertToWorldSpaceAR(t.position)).x+=GameModel.BlockWidth/2,e.y+=GameModel.BlockWidth/2,t.isAddition?(this.isExtraAdditionUsed=!0,this.manager.coreCannon.randomBullet(e),t.useAdd()):t.isMultiplication&&(this.isExtraAdditionUsed=!0,this.manager.coreCannon.randomBullet(e,t.mulRatio),t.useMul())))},u.prototype.changeMoveDirection=function(){var e;this.nextPathPoint&&this.nextPathPoint.incidence&&(e=ex.pToAngle(this.nextPathPoint.incidence),this.node.angle=ex.convertToRotation(e)-90)},u.prototype.calAuxiliaryExtraHurt=function(e){var t,o=this,i=this.manager.coreCannon.auxInfo;switch(i.type){case GameModel.ArmsType.Connect:this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,this.manager.gameNode.connectHurt(i.hurt,e));break;case GameModel.ArmsType.Noxious:this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,this.manager.gameNode.poisoning(i.hurt,this));break;case GameModel.ArmsType.Curse:this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,this.manager.gameNode.curseHurt(i.hurt,this.shooter.attackPoint,e));break;case GameModel.ArmsType.Fire:this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,this.manager.gameNode.fireHurt(i.hurt,e,this));break;case GameModel.ArmsType.Back:1!=this.bulletIndex||this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,t=null!==(t=GameConfig.GameConf.beatbackper)&&void 0!==t?t:35,ex.rand(1,100)<=t&&this.manager.gameNode.backHurt(i.hurt,e,function(){e.isDie()||o.manager.updateAllBulletPathPoint(o)}));break;case GameModel.ArmsType.Bomb:e.isDie()&&this.manager.gameNode.crossBomb(i.hurt,e);break;case GameModel.ArmsType.Frozen:this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,n=null!==(n=GameConfig.GameConf.frozenper)&&void 0!==n?n:50,ex.rand(1,100)<=n&&e.beFrozen());break;case GameModel.ArmsType.Lightning:var n=this.isExtraHurtUsed;1!=this.bulletIndex||n||(this.isExtraHurtUsed=!0,this.manager.gameNode.powerGridHurt(i.hurt,e)),n||(this.isExtraHurtUsed=!0,this.manager.gameNode.lightningHurt(this.shooter.attackPoint,e));break;case GameModel.ArmsType.FieryDragon:this.shooter.isAuxiliary||1!=this.bulletIndex||this.isExtraHurtUsed||(this.isExtraHurtUsed=!0,this.manager.gameNode.fieryDragon1Hurt(i.hurt,e,this))}},u.prototype.isReady=function(){return this.state==GameModel.BulletState.Ready},u.prototype.isMoving=function(){return this.state==GameModel.BulletState.Move},u.prototype.isStop=function(){return this.state==GameModel.BulletState.Stop},u.prototype.stopMove=function(){this.state=GameModel.BulletState.Stop},u.prototype.delayRemove=function(){this._isDelayRemove=!0,this.leftValidTime=GameModel.BulletAttackEndShowTime},u.prototype.shot=function(e,t,o,i){this.shooter=e,this.classify=null!=i?i:GameModel.BulletClassify.Shot,this.nextPathPoint=t,this.bulletIndex=o,this.state=GameModel.BulletState.Move,this.changeMoveDirection()},u.prototype.clear=function(){this.node&&this.node.isValid&&this.node.destroy()},l([a({type:cc.Sprite,tooltip:"icon"})],u.prototype,"icon",void 0),l([a({type:cc.ParticleSystem,tooltip:"\u7c92\u5b50"})],u.prototype,"particle",void 0),l([a({type:cc.MotionStreak,tooltip:"\u62d6\u5c3e"})],u.prototype,"trailing",void 0),l([a({type:sp.Skeleton,tooltip:"spine"})],u.prototype,"spine",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],Cannon:[function(e,t,o){"use strict";cc._RF.push(t,"2d818HKbtJLCpMXz1DxpNPQ","Cannon");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("BaseRole");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.spine=null,e.bulletLabel=null,e.info=null,e.shotRange={min:0,max:0},e._worldPos=cc.v2(),e.leftBulletNum=0,e.bulletCount=0,e.bulletIndex=0,e.bulletAdded=0,e.atkAddedValue=0,e.criticalHitAdded=0,e.criticalHitHurtAdded=0,e.temporaryInfo={atk:0,bulletCount:0,cirticalHit:0,cirticalHitHurt:0},e.randomBulletNum=0,e.recoveryBulletCount=0,e.attackcdtime=0,e.firePathPoint=null,e.allPathPoints=[],e.allBullets=[],e.pathPointUpdating=!1,e.state=GameModel.CannonState.Ready,e.tempEnd=cc.v2(),e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=d.default),Object.defineProperty(h.prototype,"worldPos",{get:function(){return this._worldPos},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isEnable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isAuxiliary",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"toughness",{get:function(){return 100*this.manager.currLevel},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"attackSpeed",{get:function(){return 125},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"attackPoint",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"luckPoint",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"criticalBase",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"criticalHurtBase",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"critical",{get:function(){var e=GameConfig.GameConf.crirate,t=GameConfig.calPlayerLevelAdded(this.criticalBase);return t<e.min?t=e.min:t>e.max&&(t=e.max),t+this.criticalHitAdded},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"criticalhurt",{get:function(){var e=GameConfig.GameConf.crimag,t=GameConfig.calPlayerLevelAdded(this.criticalHurtBase);return(t+=this.criticalHitHurtAdded)<e.min?t=e.min:t>e.max&&(t=e.max),t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isLucky",{get:function(){return!1},enumerable:!1,configurable:!0}),h.prototype.onLoad=function(){},h.prototype.start=function(){console.log("Cannon start."),this.updateWorldPos();var e=ex.v2temp(this.worldPos.x+GameModel.MapCol/2*GameModel.BlockWidth,this.worldPos.y+GameModel.BlockWidth/2);e=ex.pToAngle(e.sub(this.worldPos,e)),this.shotRange.min=e,this.shotRange.max=Math.PI-e},h.prototype.initialize=function(e,t,o,i,n){void 0===n&&(n=!1),this.manager=e,this.copyInfo(t),t=this.getInfo(o),this.info.luck=t.luck,t=this.getInfo(i),this.info.bulletcount=t.bulletcount,this.bulletCount=t.bulletcount,this.atkAddedValue=0,this.criticalHitAdded=0,this.criticalHitHurtAdded=0,this.temporaryInfo.atk=0,this.temporaryInfo.bulletCount=0,this.temporaryInfo.cirticalHit=0,this.temporaryInfo.cirticalHitHurt=0,this.fullBullet()},h.prototype.getInfo=function(){return null},h.prototype.copyInfo=function(e){this.info?(this.info.level=e.level,this.info.atk=e.atk,this.info.type=e.type,this.info.name=e.name,this.info.hurt=e.hurt):this.info=JSON.parse(JSON.stringify(e))},h.prototype.updateArms=function(){},h.prototype.updateWorldPos=function(){this.node.parent.convertToWorldSpaceAR(this.position,this._worldPos),console.log("cannon world pos:",this.worldPos.x,this.worldPos.y)},h.prototype.update=function(e){this.manager&&this.manager.isGameRunning()&&this.isEnable&&(this.isAttack()&&this.fire(),this.countDown(e))},h.prototype.lateUpdate=function(){this.manager&&this.manager.isGameRunning()&&this.pathPointUpdating&&(this.pathPointUpdating=!1)},h.prototype.countDown=function(e){0<this.attackcdtime&&(this.attackcdtime-=1e3*e)},h.prototype.refreshLeftBullet=function(){this.bulletLabel&&(this.bulletLabel.string=""+this.leftBulletNum)},h.prototype.subBullet=function(){0<this.leftBulletNum&&(this.leftBulletNum--,this.refreshLeftBullet())},h.prototype.fullBullet=function(){this.leftBulletNum=this.bulletCount,this.refreshLeftBullet()},h.prototype.showReadyAni=function(){},h.prototype.drawRayCast=function(e,t,o){void 0===o&&(o=!1);var i=ex.pToAngle(t),n=ex.convertToRotation(i);n%90==45&&(console.log("45\u5ea6\u5f3a\u5236\u4fee\u6539.",n),i=ex.convertToAngle(n+.5),ex.pForAngle(i,t)),this.tempEnd.set(t);var a=e.add(this.tempEnd.mulSelf(1500),this.tempEnd),r=cc.director.getPhysicsManager().rayCast(e,a,cc.RayCastType.Closest);return r&&0<r.length?(i=(n=r[0]).point,a=n.collider.tag,r=ex.v2temp(n.normal),r=(n=t).sub(r.mulSelf(2*n.dot(r)),this.tempEnd),{point:i,prevPoint:e,incidence:t,reflection:cc.v2(r),hitPos:a,isEnd:a==GameModel.WallPos.Bottom}):e.y>this.manager.gameNode.worldPosRect.bottom+10&&!o?this.drawRayCast(e,cc.v2(-t.x,-t.y),!0):null},h.prototype.checkIsValidAngle=function(e){return!(e<this.shotRange.min||e>this.shotRange.max)},h.prototype.randomCritical=function(){if(ex.rand(1,100)<=this.critical){var e=this.attackPoint;return Math.ceil(e*(this.criticalhurt/100))}return 0},h.prototype.addBulletCapacity=function(e){this.bulletCount+=e,this.fullBullet()},h.prototype.addBulletCapacityWithProp=function(e){this.bulletAdded+=3;var t=e.info.size*GameModel.BlockWidth;t=e.position.add(ex.v2temp(t/2,t/2)),t=this.manager.gameNode.convertToScenePoint(t,ex.v2temp()),Utils.showImageTips("tips/lbl_addcapacity",t.x,t.y)},h.prototype.addTemporaryBulletCapacity=function(e){this.bulletCount+=e,this.temporaryInfo.bulletCount=e,this.fullBullet()},h.prototype.addBulletAtk=function(e){0<(e=GameConfig.getCoreArmsInfo(this.info.level+e).atk-this.info.atk)&&(this.atkAddedValue+=e)},h.prototype.addTemporaryBulletAtk=function(e){0<(e=GameConfig.getCoreArmsInfo(this.info.level+e).atk-this.info.atk)&&(this.atkAddedValue+=e,this.temporaryInfo.atk=e)},h.prototype.addCriticalHitPer=function(e){this.criticalHitAdded=e},h.prototype.addTemporaryCirticalHitPer=function(e){this.criticalHitAdded=e,this.temporaryInfo.cirticalHit=e},h.prototype.addCriticalHitHurt=function(e){this.criticalHitHurtAdded=e},h.prototype.addTemporaryCriticalHitHurt=function(e){this.criticalHitHurtAdded=e,this.temporaryInfo.cirticalHitHurt=e},h.prototype.calBeforeRoundBuff=function(){this.fullBullet()},h.prototype.calAfterAttackBuff=function(){0<this.bulletAdded&&(this.bulletCount+=this.bulletAdded,this.bulletAdded=0),0<this.temporaryInfo.atk&&(this.atkAddedValue-=this.temporaryInfo.atk,this.temporaryInfo.atk=0),0<this.temporaryInfo.bulletCount&&(this.bulletCount-=this.temporaryInfo.bulletCount,this.temporaryInfo.bulletCount=0),0<this.temporaryInfo.cirticalHit&&(this.criticalHitAdded-=this.temporaryInfo.cirticalHit,this.temporaryInfo.cirticalHit=0),0<this.temporaryInfo.cirticalHitHurt&&(this.criticalHitHurtAdded-=this.temporaryInfo.cirticalHitHurt,this.temporaryInfo.cirticalHitHurt=0)},h.prototype.nextPoint=function(e){for(var t=0;t<this.allPathPoints.length;t++){var o=this.allPathPoints[t];if(o.prevPoint.equals(e.point)&&o.incidence.equals(e.reflection))return o}var i=this.drawRayCast(e.point,e.reflection);return i&&this.allPathPoints.push(i),i},h.prototype.updatePoint=function(e){for(var t=0;t<this.allPathPoints.length;t++){var o=this.allPathPoints[t];if(o.prevPoint.equals(e.prevPoint)&&o.incidence.equals(e.incidence))return o}var i=this.drawRayCast(e.prevPoint,e.incidence);return i&&this.allPathPoints.push(i),i},h.prototype.updateAllBulletPathPoint=function(e){if(!this.isReady()&&!this.pathPointUpdating){this.pathPointUpdating=!0,this.allPathPoints.splice(0);var t=this.firePathPoint;this.firePathPoint=this.drawRayCast(t.prevPoint,t.incidence);for(var o=this.allBullets.length;o--;){var i=this.allBullets[o];i!=e&&i.isMoving()&&i.nextPathPoint&&(i.nextPathPoint=this.updatePoint(i.nextPathPoint))}}},h.prototype.isReady=function(){return this.state==GameModel.CannonState.Ready},h.prototype.isAttack=function(){return this.state==GameModel.CannonState.Attack},h.prototype.isFireEnd=function(){return this.state==GameModel.CannonState.FireEnd},h.prototype.onReady=function(){this.state=GameModel.CannonState.Ready},h.prototype.fire=function(){0<this.leftBulletNum?this.attackcdtime<=0&&(this.subBullet(),this.attackcdtime=this.attackSpeed,this.fireSingle()):this.stopFire()},h.prototype.fireSingle=function(){var e=this.manager.createBullet(this.worldPos);e.shot(this,this.firePathPoint,++this.bulletIndex),this.allBullets.push(e)},h.prototype.startFire=function(e){e=e.sub(this.worldPos,cc.v2()).normalizeSelf(),this.firePathPoint=this.drawRayCast(this.worldPos,e),this.allBullets.splice(0),this.allPathPoints.splice(0),this.fullBullet(),this.bulletIndex=0,this.recoveryBulletCount=0,this.state=GameModel.CannonState.Attack},h.prototype.stopFire=function(){this.state=GameModel.CannonState.FireEnd,this.manager.fireEnd(this),this.showReadyAni()},h.prototype.stopBulletMove=function(){var e=this;this.onReady(),0<this.leftBulletNum&&this.showReadyAni(),this.allBullets.forEach(function(t){t.stopMove(),e.manager.recoveryBullet(t)})},h.prototype.delayRemoveBullet=function(){this.onReady(),this.showReadyAni(),0<this.allBullets.length&&this.allBullets.forEach(function(e){e.delayRemove()})},h.prototype.removeBullet=function(e){for(var t=this.allBullets.length;t--;)if(this.allBullets[t]==e){this.allBullets.splice(t,1);break}},h.prototype.recoveryBullet=function(e){this.recoveryBulletCount++,this.recoveryBulletCount>=this.randomBulletNum+this.bulletCount&&(this.onReady(),e.isDelayRemove||this.manager.checkGameWin()),this.removeBullet(e),this.manager.recoveryBullet(e)},h.prototype.clear=function(){this.allBullets.forEach(function(e){e.clear()})},l([a({type:sp.Skeleton,tooltip:"\u6b66\u5668spine"})],h.prototype,"spine",void 0),l([a({type:cc.Label,tooltip:"\u5b50\u5f39\u6570\u91cflabel"})],h.prototype,"bulletLabel",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],CoreArmsNode:[function(e,t,o){"use strict";cc._RF.push(t,"62464Kq+QFG+onMqkVwjBlx","CoreArmsNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("TabBarItem");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.atkLabel=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=d.default),h.prototype.onLoad=function(){window.adManager&&window.adManager.showInterstitial(),c.prototype.onLoad.call(this),this.initListener(),this.refreshFightPowerLabel(),this.refreshAtkGradeInfo(),this.refreshLuckGradeInfo(),this.refreshCapacityGradeInfo()},h.prototype.initListener=function(){MSGEvent.on(this.pageName,MSGEvent.UPDATE_FIGHTPOWER,this.refreshFightPowerLabel,this),MSGEvent.on(this.pageName,MSGEvent.UPDATE_ROLEATK,this.refreshAtkGradeInfo,this),MSGEvent.on(this.pageName,MSGEvent.UPDATE_ROLELUCK,this.refreshLuckGradeInfo,this)},h.prototype.refreshFightPowerLabel=function(){var e=GameConfig.getCurrentPower();this.atkLabel.string=GA.formatNumber(e)},h.prototype.onAtkGrade=function(){var e,t;this.atkInfo.grade()&&(GameData.gradeCoreArms(),e=this.atkInfo.currValue,t=this.atkInfo.gradeNext,GradeToast.show("Attack power: "+GA.formatNumber(e),GA.formatNumber(t)),this.refreshAtkGradeInfo(),this.showGradeAni(this.atkInfo.node),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeRole),GameData.completeTaskSetTimes(GameModel.TaskType.UpgradeRoleAtkToLevel,GameData.coreGrade.level))},h.prototype.onLuckGrade=function(){var e,t;this.criticalInfo.grade()&&(GameData.gradeCoreLuck(),e=this.criticalInfo.currValue,t=this.atkInfo.gradeNext,GradeToast.show("Heroic luck: "+GA.formatNumber(e),GA.formatNumber(t)),this.refreshLuckGradeInfo(),this.showGradeAni(this.criticalInfo.node),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeRole),GameData.completeTaskSetTimes(GameModel.TaskType.UpgradeRoleLuckToLevel,GameData.coreGrade.lucklevel))},h.prototype.onCapacityGrade=function(){var e,t;this.capacityInfo.grade()&&(GameData.gradeCoreCapacity(),e=this.capacityInfo.currValue,t=this.atkInfo.gradeNext,GradeToast.show("Hero weapon count: "+GA.formatNumber(e),GA.formatNumber(t)),this.refreshCapacityGradeInfo(),this.showGradeAni(this.capacityInfo.node),MSGEvent.sendEvent(MSGEvent.UPDATE_FIGHTPOWER),GameData.completeTask(GameModel.TaskType.GradeRole),GameData.completeTaskSetTimes(GameModel.TaskType.UpgradeRoleCapacityToLevel,GameData.coreGrade.capacitylevel))},h.prototype.refreshAtkGradeInfo=function(){var e=GameData.getCoreArmsLevel(),t=GameConfig.getCoreArmsInfo(e),o=GameConfig.getCoreArmsInfo(e+1),i=GameConfig.getCoinCostInfo(e),n=1+GameConfig.roleAttackAdded/100,a=GameConfig.calPlayerLevelAdded(t.atk*n);n=GameConfig.calPlayerLevelAdded(o.atk*n),e=e==GameConfig.maxGameLevel,this.atkInfo.setData(a,n,t.level,i.atk,e)},h.prototype.refreshLuckGradeInfo=function(){var e=GameData.getCoreLuckLevel(),t=GameConfig.getCoreArmsInfo(e),o=GameConfig.getCoreArmsInfo(e+1),i=GameConfig.getCoinCostInfo(e),n=1+GameConfig.roleLuckAdded/100,a=GameConfig.calPlayerLevelAdded(t.luck*n);n=GameConfig.calPlayerLevelAdded(o.luck*n),e=e==GameConfig.maxGameLevel,this.criticalInfo.setData(a,n,t.level,i.playerluck,e)},h.prototype.refreshCapacityGradeInfo=function(){var e=GameData.getCoreCapacityLevel(),t=GameConfig.getCoreArmsInfo(e),o=GameConfig.getCoreArmsInfo(e+1);0==o.bulletcount&&(o=t);var i=GameConfig.getCoinCostInfo(e),n=t.bulletcount;e=o.bulletcount,this.capacityInfo.setData(n,e,t.level,i.playerbullet,t==o)},l([a({type:cc.Label,tooltip:"War forcelabel"})],h.prototype,"atkLabel",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],CoreCannon:[function(e,t,o){"use strict";cc._RF.push(t,"095cbYv3ORCE7Bwlw9A7MgZ","CoreCannon");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c=a("Cannon");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.auxInfo=null,e.countHurtPercent=0,e.lastUseWeaponEffectHitTimes=0,e}a=(n=cc._decorator).ccclass,n.property,s(d,l=c.default),Object.defineProperty(d.prototype,"auxEnable",{get:function(){return null!=this.auxInfo},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isOpenLucky",{get:function(){return this.auxInfo&&this.auxInfo.type==GameModel.ArmsType.Lucky},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"attackPoint",{get:function(){var e=GameConfig.roleAttackAdded/100;return e=(this.info.atk+this.atkAddedValue)*(1+e),GameConfig.calPlayerLevelAdded(e)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"luckPoint",{get:function(){return this.info.luck*(1+GameConfig.roleLuckAdded/100)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"criticalBase",{get:function(){return this.luckPoint/(this.luckPoint+this.toughness)*100},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"criticalHurtBase",{get:function(){return 1.21+this.luckPoint/(this.luckPoint+this.toughness)*15},enumerable:!1,configurable:!0}),d.prototype.initialize=function(e,t,o,i,n){void 0===n&&(n=!1),l.prototype.initialize.call(this,e,t,o,i),this.auxInfo=null,i=""+GameConfig.usingAuxArms,this.spine.setAttachment("weapon",i),this.spine.setAnimation(0,"daiji",!0),i=Math.floor(this.manager.currLevel/100)+2,this.countHurtPercent=this.leftBulletNum*(i=8<i?8:i)},d.prototype.getInfo=function(e){return GameConfig.getCoreArmsInfo(e)},d.prototype.useAuxCannon=function(e){this.auxInfo=e},d.prototype.calAuxiliaryRoundHurt=function(){if(this.auxInfo&&this.auxInfo.type===GameModel.ArmsType.Count){var e=this.manager.hitCount/this.countHurtPercent;return 1<e&&(e=1),e=Math.ceil(e*this.auxInfo.hurt),this.manager.gameNode.countHurt(e)}return 0},d.prototype.calFieryDragonHurt=function(){var e,t;this.auxInfo&&this.auxInfo.type==GameModel.ArmsType.FieryDragon&&(e=this.manager.hitCount,t=null!==(t=GameConfig.GameConf.ShowDoubleFieryDragonHitTimes)&&void 0!==t?t:100,e!=this.lastUseWeaponEffectHitTimes&&e%t==0&&(this.lastUseWeaponEffectHitTimes=e,this.manager.gameNode.fieryDragon2Hurt(this.auxInfo.hurt)))},d.prototype.startFire=function(e){l.prototype.startFire.call(this,e),this.randomBulletNum=0,this.lastUseWeaponEffectHitTimes=0,this.spine.setAnimation(0,"huiwu",!0),(e=this.auxInfo?this.auxInfo.type:1)==GameModel.ArmsType.Fire&&(e=GameModel.ArmsType.Bomb),SoundManager.playSound("music/fire_"+e)},d.prototype.randomBullet=function(e,t){for(void 0===t&&(t=1);0<=--t;)this.createRandomBullet(e)},d.prototype.createRandomBullet=function(e){var t=this.shotRange;t=ex.randFloat(t.min,t.max),t=ex.pForAngle(t,cc.v2()),t=this.drawRayCast(e,t),(e=this.manager.createBullet(e)).shot(this,t,++this.bulletIndex,GameModel.BulletClassify.Random),this.allBullets.push(e),this.randomBulletNum++},d.prototype.showReadyAni=function(){this.spine.setAnimation(0,"daiji",!0)},a=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],d),r.default=a,cc._RF.pop()},{}],CurrencyInfo:[function(e,t,o){"use strict";cc._RF.push(t,"f0bb4p6+FVMDo63WI6eiSzl","CurrencyInfo");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("FreeGold"),h=n("FreeStamina");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.levelLabel=null,e.progressBar=null,e.atkLabel=null,e.goldLabel=null,e.staminaIcon=null,e.staminaLabel=null,e.staminaTimeLabel=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=cc.Component),u.prototype.onLoad=function(){this.pageName="Monetary information",this.levelLabel.string=""+GameConfig.playerLevel,this.refreshFightPowerLabel(),this.refreshGoldLabel(),this.refreshStaminaLabel(),this.refreshLevelProgress(),this.staminaTimeLabel.node.active=!1},u.prototype.start=function(){this.initListener(),this.schedule(this.onTimeUpdate.bind(this),1)},u.prototype.initListener=function(){var e=this;MSGEvent.on(this.pageName,MSGEvent.UPDATE_USERINFO,function(){e.refreshGoldLabel()},this),MSGEvent.on(this.pageName,MSGEvent.UPDATE_STAMINA,this.refreshStaminaLabel,this),MSGEvent.on(this.pageName,MSGEvent.UPDATE_FIGHTPOWER,this.refreshFightPowerLabel,this)},u.prototype.onDestroy=function(){MSGEvent.offAll(this.pageName)},u.prototype.update=function(){},u.prototype.onTimeUpdate=function(){GameData.stamina<GameConfig.GameConf.endurancelimit&&this.refreshStaminaTimeLabel()},u.prototype.refreshFightPowerLabel=function(){var e=GameConfig.getCurrentPower();this.atkLabel.string=GA.formatNumber(e)},u.prototype.refreshGoldLabel=function(e){e=null!=e?e:GameData.gold,this.goldLabel.string=GA.formatNumber(e)},u.prototype.refreshStaminaLabel=function(){this.staminaLabel.string=""+GameData.stamina},u.prototype.refreshStaminaTimeLabel=function(){var e,t;GameData.stamina>=GameConfig.GameConf.endurancelimit?this.staminaTimeLabel.node.active=!1:(this.staminaTimeLabel.node.active=!0,0<=(t=1e3*(e=GameConfig.GameConf.endurancecd).time-(Date.now()-GameData.staminaResumeTime))&&(this.staminaTimeLabel.string=GA.formatTime(Math.round(t/1e3))),t<=0&&(GameData.addStamina(e.count),GameData.updateResumeStaminaTime(),this.refreshStaminaLabel(),GameData.stamina>=GameConfig.GameConf.endurancelimit&&(this.staminaTimeLabel.node.active=!1)))},u.prototype.refreshLevelProgress=function(){for(var e=GameData.exp,t=0,o=0,i=GameConfig.MainArms.length;o<i;o++){var n=GameConfig.MainArms[o];if(e<=(t+=n.exp)){n=(n.exp-(t-e))/n.exp,this.progressBar.progress=n;break}}t<e&&(this.progressBar.progress=1)},u.prototype.onShowGoldClick=function(){d.default.show(),SoundManager.playSound(Model.AudioUrl.Click)},u.prototype.onShowStaminaClick=function(){GameData.stamina<GameConfig.GameConf.endurancelimit?h.default.show():G.showToast({title:"Full of energy"}),SoundManager.playSound(Model.AudioUrl.Click)},u.prototype.clear=function(){this.node.destroy()},l([a({type:cc.Label,tooltip:"Levellabel"})],u.prototype,"levelLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"Upgrade progress"})],u.prototype,"progressBar",void 0),l([a({type:cc.Label,tooltip:"Atklabel"})],u.prototype,"atkLabel",void 0),l([a({type:cc.Label,tooltip:"goldLabel"})],u.prototype,"goldLabel",void 0),l([a({type:cc.Node,tooltip:"StaminaIcon"})],u.prototype,"staminaIcon",void 0),l([a({type:cc.Label,tooltip:"StaminaLabel"})],u.prototype,"staminaLabel",void 0),l([a({type:cc.Label,tooltip:"StaminaTimeLabel"})],u.prototype,"staminaTimeLabel",void 0),n=l([n],u),r.default=n,cc._RF.pop()},{}],DoubleHit:[function(e,t,o){"use strict";cc._RF.push(t,"1c08cpiA2pFcLfHqLqZpRGM","DoubleHit");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.doubleHitFonts=[],e.hitLabel=null,e.direction=0,e}r(d,l=cc.Component),d.prototype.onLoad=function(){this.hitLabel=this.node.getComponent(cc.Label),this.node.active=!1},d.prototype.update=function(e){0!=this.direction&&(e=this.node.scale+e*this.direction*3.5,0<this.direction&&1.5<=e?(this.node.scale=1.5,this.direction=-1):this.direction<0&&e<=1?(this.node.scale=1,this.direction=0):this.node.scale=e)},d.prototype.refreshHitLabel=function(e){var t,o;0!=e?(this.node.active||(this.node.active=!0),o=0,t=20,1e3<e?(o=2,t=32):500<e&&(o=1,t=24),o=this.doubleHitFonts[o],this.hitLabel.font!=o&&(this.hitLabel.font=o,this.hitLabel.fontSize=t),this.hitLabel.string=e+"Combo!",this.direction=5):this.node.active=!1},s([c({type:cc.BitmapFont,tooltip:"Link to font resources"})],d.prototype,"doubleHitFonts",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],EnemyTips:[function(e,t,o){"use strict";cc._RF.push(t,"d7f9cP/MkhEHIXJgfRX5pAm","EnemyTips");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.describe=null,e}r(d,l=cc.Component),d.prototype.start=function(){},d.prototype.show=function(e){this.node.active=!0,Utils.loadSubpackageImage("game/enemy_describe/"+e.enemyId,this.describe);var t=this.describe.node.width;e=this.node.width/2+t/2,this.describe.node.x=e,cc.tween(this.describe.node).to(.8,{x:this.node.width/2-t/2},{easing:"backIn"}).delay(2).to(.5,{x:e},{easing:"backOut"}).call(this.hide,this).start()},d.prototype.hide=function(){this.node.active=!1},s([c({type:cc.Sprite,tooltip:"Introduction of the enemy"})],d.prototype,"describe",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],Enemy:[function(e,t,o){"use strict";cc._RF.push(t,"27656Q/AqVKzaK6HeDE9RZC","Enemy");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseRole"),u=n("HitEffectAni");function p(){var e=null!==c&&c.apply(this,arguments)||this;return e.index=0,e.info=null,e._occupyBlocks=[],e.mulRatio=0,e.mHealthPoint=0,e._fullHealthPoint=0,e.propPoisonedHurt=0,e.burnedHurt=0,e.crossRecoveryHP=0,e.linkSource=null,e.reviveTimes=0,e.shieldValidTimes=0,e.poisonedHurt=0,e.curseHurt=0,e.electrocutedHurt=0,e.frozenValidRound=0,e.frozenStatic=!1,e.isFrozenOneRound=!1,e.twineValidRound=0,e.delayHitInfo={},e.effectList=[],e.hitAniTime=0,e.bInvincible=!1,e.targetPos=cc.v2(),e.produceUsed=!1,e.moving=!1,e.boundingBox=cc.rect(),e.sprite=null,e.spine=null,e.rigidBody=null,e.boxCollider=null,e.multipleLabel=null,e.hpLabel=null,e.hpProgressBar=null,e.shieldProgressBar=null,e.hitEffectAni=null,e.material_sprite_normal=null,e.material_sprite_attacked=null,e.material_spine_normal=null,e.material_spine_attacked=null,e.state=GameModel.EnemyState.Ready,e._centerPos=cc.v2(),e}n=(a=cc._decorator).ccclass,a=a.property,s(p,c=h.default),(d=p).create=function(e){return cc.instantiate(e).getComponent(d)},Object.defineProperty(p.prototype,"centerPos",{get:function(){var e=this.info.size*GameModel.BlockWidth;return this._centerPos.x=this.x+e/2,this._centerPos.y=this.y+e/2,this._centerPos},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isAnimal",{get:function(){return this.info.classify==GameModel.EnemyClassify.Animal},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"enemyType",{get:function(){return this.info.enemytype},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isRecoveryHP",{get:function(){return this.enemyType==GameModel.EnemyType.RecoveryBlood},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isCrossRecovery",{get:function(){return this.enemyType==GameModel.EnemyType.CrossRecovery},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isLayEggs",{get:function(){return this.enemyType==GameModel.EnemyType.LayEggs},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isDivide",{get:function(){return this.enemyType==GameModel.EnemyType.Divide},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isProduce",{get:function(){return this.enemyType==GameModel.EnemyType.Produce},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isAddition",{get:function(){return this.info.id==GameModel.EnemyID.F012},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isMultiplication",{get:function(){return this.info.id==GameModel.EnemyID.F011},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isAddCapacity",{get:function(){return this.info.id==GameModel.EnemyID.F013},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isSkillBuff",{get:function(){return this.info.id==GameModel.EnemyID.F014},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBomb",{get:function(){return this.enemyType==GameModel.EnemyType.Bomb},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBombVertical",{get:function(){return this.info.id==GameModel.EnemyID.F021||this.info.id==GameModel.EnemyID.F022||this.info.id==GameModel.EnemyID.F023},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBombHorizontal",{get:function(){return this.info.id==GameModel.EnemyID.F024||this.info.id==GameModel.EnemyID.F025||this.info.id==GameModel.EnemyID.F026},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBombMultidirectional",{get:function(){return this.info.id==GameModel.EnemyID.F027||this.info.id==GameModel.EnemyID.F028||this.info.id==GameModel.EnemyID.F029},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isNoxious",{get:function(){return this.enemyType==GameModel.EnemyType.Noxious},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBurned",{get:function(){return this.enemyType==GameModel.EnemyType.Burned},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isDetonator",{get:function(){return this.enemyType==GameModel.EnemyType.Detonator},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isVine",{get:function(){return this.enemyType==GameModel.EnemyType.Vine},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isIce",{get:function(){return this.enemyType==GameModel.EnemyType.Ice},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isLink",{get:function(){return this.enemyType==GameModel.EnemyType.Link},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isRevive",{get:function(){return this.enemyType==GameModel.EnemyType.Revive},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isShield",{get:function(){return this.enemyType==GameModel.EnemyType.Shield},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isHalfHurt",{get:function(){return this.enemyType==GameModel.EnemyType.HalfHurt},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isSprint",{get:function(){return this.enemyType==GameModel.EnemyType.Sprint},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInvincible",{get:function(){return this.enemyType==GameModel.EnemyType.Invincible},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"sizeType",{get:function(){return this.info.size},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"fullHealthPoint",{get:function(){return this._fullHealthPoint},set:function(e){this._fullHealthPoint=Math.floor(e)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"leftHealthPoint",{get:function(){return this.mHealthPoint},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"leftHealthPointPercent",{get:function(){return this.hpProgressBar.progress},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBeFrozen",{get:function(){return 1<this.frozenValidRound||1<this.twineValidRound||this.isFrozenOneRound},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBeFronzeStatic",{get:function(){return this.frozenStatic||this.isFrozenOneRound},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isBeLink",{get:function(){return this.linkSource&&!this.linkSource.isDie()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"canRevive",{get:function(){return 0<this.reviveTimes},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"occupyBlocks",{get:function(){for(var e=0;e<this._occupyBlocks.length;e++){var t=e%this.info.size,o=Math.floor(e/this.info.size),i=this._occupyBlocks[e];i.x=this.x+t*GameModel.BlockWidth,i.y=this.y+o*GameModel.BlockWidth}return this._occupyBlocks},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"willOccupyBlocks",{get:function(){for(var e=0;e<this._occupyBlocks.length;e++){var t=e%this.info.size,o=Math.floor(e/this.info.size),i=this._occupyBlocks[e];i.x=this.targetPos.x+t*GameModel.BlockWidth,i.y=this.targetPos.y+o*GameModel.BlockWidth}return this._occupyBlocks},enumerable:!1,configurable:!0}),p.prototype.onLoad=function(){this.material_spine_normal=this.spine.getMaterial(0),this.material_sprite_normal=this.sprite.getMaterial(0),this.material_spine_attacked=this.manager.gameUI.attackSpineMat,this.material_sprite_attacked=this.manager.gameUI.attackSpriteMat,this.initSprite()},p.prototype.initSprite=function(){var e=this;this.hpLabel.node.zIndex=this.multipleLabel.node.zIndex=this.hitEffectAni.node.zIndex=99,this.hpProgressBar.node.zIndex=this.shieldProgressBar.node.zIndex=this.hpLabel.node.zIndex,this.spine.setCompleteListener(function(t){e.spine.skeletonData&&!e.isBeFronzeStatic&&("2.yidong"!=(t=t.animation.name)&&"3.beida"!=t||e.playReady())})},p.prototype.initialize=function(){var e=this,t=this.sizeType*GameModel.BlockWidth;this.sprite.spriteFrame=null,this.spine.skeletonData=null,this.sprite.node.active=this.spine.node.active=!1;var o,i=this.enemyType,n=3;GameModel.SmallEnemyList.includes(i)&&(n=1),this.isAnimal||GameModel.ObstructAnimateList.includes(i)?((o=this.spine).node.active=!0,o.node.scale=this.info.size/n,o.node.x=t/2,this.isRevive?o.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.PRIVATE_CACHE):o.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),Utils.getSubgame().load("enemy/"+i+"/skeleton",sp.SkeletonData,function(t,i){t?console.warn(t.message):o&&o.isValid&&(o.skeletonData=i,e.playReady())})):(this.sprite.node.active=!0,a=null,this.isProduce?n=1:a=this.isBombVertical?"enemy/"+GameModel.EnemyID.F021:this.isBombHorizontal?"enemy/"+GameModel.EnemyID.F024:this.isBombMultidirectional?"enemy/"+GameModel.EnemyID.F027:"enemy/"+i,this.sprite.node.scale=this.info.size/n,a&&this.sprite.loadSubgameImage(a)),this.isProduce?(this.hpLabel.node.active=!1,this.hpProgressBar.node.active=!1,this.isAddition||this.isMultiplication?this.multipleLabel.node.active=!0:this.multipleLabel.node.active=!1):(this.hpLabel.node.active=!0,this.hpProgressBar.node.active=!0,this.multipleLabel.node.active=!1,this.hpLabel.node.x=t-5,this.hpLabel.fontSize=18+2.5*this.info.size),n=t-10;var a=8+2*this.info.size;this.hpProgressBar.node.setContentSize(n,a),this.hpProgressBar.totalLength=n-4,this.hpProgressBar.barSprite.node.height=a-4,this.shieldProgressBar.node.setContentSize(n,a),this.shieldProgressBar.totalLength=this.hpProgressBar.totalLength,this.shieldProgressBar.barSprite.node.height=this.hpProgressBar.barSprite.node.height,this.shieldProgressBar.node.active=!1,this.hpProgressBar.node.active&&0<=this.y&&(this.hpProgressBar.node.active=!1),this.hitEffectAni.initialize(this),this.boundingBox.size=cc.size(t,t),this.checkRigidBodyActive(),(a=this.boxCollider).tag=this.index+1,a.offset=cc.v2(t/2,t/2),a.size=cc.size(t,t),a.apply(),this.resetData(),this.resetEffect(),this.targetPos.set(this.position),this._occupyBlocks.splice(0),this.mHealthPoint=this.fullHealthPoint,this.refreshHealthPoint(),this.isRevive&&(this.reviveTimes=1);for(var r=0;r<this.info.size*this.info.size;r++)this._occupyBlocks.push(cc.v2())},p.prototype.resetData=function(){this.state=GameModel.EnemyState.Ready,this.hitAniTime=0,this.bInvincible=!1,this.produceUsed=!1,this.spine.setMaterial(0,this.material_spine_normal),this.sprite.setMaterial(0,this.material_sprite_normal),this.propPoisonedHurt=0,this.burnedHurt=0,this.crossRecoveryHP=0,this.linkSource=null,this.reviveTimes=0,this.shieldValidTimes=0,this.poisonedHurt=0,this.curseHurt=0,this.electrocutedHurt=0,this.frozenStatic=!1,this.frozenValidRound=0,this.twineValidRound=0,this.isFrozenOneRound=!1,this.delayHitInfo.hurt=0,this.delayHitInfo.time=0,this.delayHitInfo.burnedHurt=0,this.reviveTimes=0},p.prototype.resetEffect=function(){var e=this;this.effectList.forEach(function(t){e.manager.hideEffect(t)}),this.effectList.splice(0)},p.prototype.refreshHealthPoint=function(){this.isProduce?this.isAddition?this.multipleLabel.string="+"+this.mHealthPoint:this.isMultiplication&&(this.multipleLabel.string="x"+this.mHealthPoint):(this.hpLabel.string=GA.formatNumber(this.mHealthPoint),this.hpProgressBar.progress=this.mHealthPoint/this.fullHealthPoint,0<this.shieldValidTimes&&(this.shieldProgressBar.progress=this.shieldValidTimes/this.info.shield))},p.prototype.checkRigidBodyActive=function(){this.isProduce?this.rigidBody.active=!1:this.rigidBody.active=!0},p.prototype.playReady=function(e){void 0===e&&(e=!0),this.spine&&this.spine.skeletonData&&this.spine.setAnimation(0,"1.daiji",e)},p.prototype.show=function(){this.active=!0,this.checkRigidBodyActive()},p.prototype.showHp=function(){this.hpLabel.node.active&&this.targetPos.y<0&&(this.hpProgressBar.node.active=!0)},p.prototype.move=function(e){if(this.isAnimal){this.isBeFronzeStatic||this.spine.setAnimation(0,"2.yidong",!1);for(var t=GameModel.BlockWidth,o=e/t,i=GameModel.MoveDuration/o,n=0;n<o;n++){var a=this.y-n*t,r=GameModel.MoveDelayTime+n*i;this.manager.playEffect(GameModel.EffectType.Dust,this.x,a,r,this.info.size).zIndex=0}}},p.prototype.updateZIndex=function(){this.node.zIndex=-this.y/GameModel.BlockWidth},p.prototype.lateUpdate=function(e){0<this.hitAniTime&&(this.hitAniTime-=e,this.hitAniTime<=0&&(this.spine.setMaterial(0,this.material_spine_normal),this.sprite.setMaterial(0,this.material_sprite_normal))),0<this.delayHitInfo.time&&(this.delayHitInfo.time-=e,this.delayHitInfo.time<=0&&(this.hit(this.delayHitInfo.hurt),this.burned(this.delayHitInfo.burnedHurt))),this.isDie()?this.removeSelf():this.linkSource&&this.linkSource.isDie()&&(this.linkSource=null,this.hideEffect(GameModel.EffectType.Link),this.hideEffect(GameModel.EffectType.LinkShield))},p.prototype.poisoning=function(e){0==this.propPoisonedHurt&&0==this.poisonedHurt&&(this.poisonedHurt=e,this.showEffect(GameModel.EffectType.Poisoning))},p.prototype.curse=function(e){0==this.curseHurt&&(this.showEffect(GameModel.EffectType.Cursed,"animation2"),SoundManager.playSound(Model.AudioUrl.HitCursed)),this.curseHurt=e},p.prototype.beConnect=function(e){var t=this.playEffect(GameModel.EffectType.Connect,"shandian"),o=this.centerPos.sub(e.centerPos,ex.v2temp()).len();e=ex.pToAngle(e.centerPos.sub(this.centerPos,ex.v2temp())),t.angle=ex.convertToRotation(e),t.setScale(o/(1.9*GameModel.BlockWidth),1),this.playEffect(GameModel.EffectType.Connect,"jizhong"),SoundManager.playSound(Model.AudioUrl.HitConnect)},p.prototype.beFrozen=function(){var e;this.isProduce||0!=this.frozenValidRound||(this.frozenValidRound=GameModel.FrozenRound,this.frozenStatic=!0,SoundManager.playSoundSingle(Model.AudioUrl.BuffFrozen),e="bing"+ex.rand(1,3),this.showEffect(GameModel.EffectType.Frozen,e,!0))},p.prototype.beFrozenOneRound=function(){var e;this.isProduce||(this.isFrozenOneRound=!0,0!=this.frozenValidRound)||(SoundManager.playSoundSingle(Model.AudioUrl.BuffFrozen),e="bing"+ex.rand(1,3),this.showEffect(GameModel.EffectType.Frozen,e,!0),this.playReady(!1))},p.prototype.beTwine=function(e){var t,o;this.isProduce||0!=this.twineValidRound||0!=this.frozenValidRound||(this.twineValidRound=GameModel.TwineRound,(t=this.showEffect(GameModel.EffectType.Twine,"1.chanrao",!1)).y=GameModel.BlockWidth/4*this.info.size,t.angle=this.x>e.x?0:180,(o=t.getComponent(sp.Skeleton)).setCompleteListener(function(){o.setCompleteListener(null),o.loop=!0,o.setAnimation(0,"2.xunhuan",!0)}))},p.prototype.subFrozenRound=function(){0<this.frozenValidRound&&(this.frozenValidRound--,1==this.frozenValidRound||0==this.frozenValidRound&&(this.frozenValidRound=GameModel.FrozenRound)),this.isFrozenOneRound&&(this.isFrozenOneRound=!1,0==this.frozenValidRound&&(this.hideEffect(GameModel.EffectType.Frozen),this.playReady())),0<this.twineValidRound&&(this.twineValidRound--,1==this.twineValidRound||0==this.twineValidRound&&(this.twineValidRound=GameModel.TwineRound))},p.prototype.beElectrocuted=function(e){this.electrocutedHurt=e},p.prototype.recoveryBlood=function(e){var t;this.mHealthPoint<this.fullHealthPoint&&(this.mHealthPoint+=e,this.mHealthPoint>this.fullHealthPoint&&(this.mHealthPoint=this.fullHealthPoint),this.refreshHealthPoint(),t=this.manager.gameNode.convertToScenePoint(this.position,ex.v2temp()),this.manager.showBloodTips(t.x+GameModel.BlockWidth/2,t.y+GameModel.BlockWidth,e,GameModel.FontColorRecovery))},p.prototype.recoveryRatio=function(e){e=Math.ceil(this.fullHealthPoint*(e/100)),this.recoveryBlood(e)},p.prototype.bombHit=function(e){e=Math.ceil(this.fullHealthPoint*(e/100)),this.hit(e)},p.prototype.poisoningRatio=function(e){e=Math.ceil(this.fullHealthPoint*(e/100)),0==this.propPoisonedHurt&&0==this.poisonedHurt&&(this.propPoisonedHurt=e,this.showEffect(GameModel.EffectType.Poisoning))},p.prototype.burnedRatio=function(e){0==this.burnedHurt&&this.showEffect(GameModel.EffectType.Burning),e=Math.ceil(this.fullHealthPoint*(e/100)),this.burnedHurt=e},p.prototype.burned=function(e){e<=0||(0==this.burnedHurt&&this.showEffect(GameModel.EffectType.Burning),this.burnedHurt=Math.ceil(e))},p.prototype.crossRecovery=function(e){e=Math.ceil(this.fullHealthPoint*(e/100)),this.crossRecoveryHP=e},p.prototype.beLink=function(e){this.linkSource=e;var t=this.getEffect(GameModel.EffectType.Link);t||(t=this.playEffect(GameModel.EffectType.Link,null,!0),this.effectList.push(t),this.showEffect(GameModel.EffectType.LinkShield),console.log("Link effects have been shown."));var o=this.centerPos.sub(e.centerPos,ex.v2temp()).len();e=ex.pToAngle(e.centerPos.sub(this.centerPos,ex.v2temp())),t.angle=ex.convertToRotation(e),t.setScale(o/(1.4*GameModel.BlockWidth),1),console.log("belink:"+this.info.name)},p.prototype.playEffect=function(e,t,o){return this.manager.playEffect(e,this.x,this.y,0,this.info.size,t,o)},p.prototype.showEffect=function(e,t,o){return o=this.manager.playEffectWithNode(this.node,e,this.info.size,t,o=null==o||o),this.effectList.push(o),o},p.prototype.hideEffect=function(e){for(var t=0;t<this.effectList.length;t++){var o=this.effectList[t];if(o.name==e){this.manager.hideEffect(o),this.effectList.splice(t,1);break}}},p.prototype.getEffect=function(e){if(!e)return null;for(var t=0;t<this.effectList.length;t++){var o=this.effectList[t];if(o.name==e)return o}return null},p.prototype.onDeath=function(){this.isDetonator?(this.bInvincible=!0,this.state=GameModel.EnemyState.DelayClear,this.spine.setAnimation(0,"4.siwang",!0)):(this.state=GameModel.EnemyState.Death,this.rigidBody.active=!1,this.isCrossRecovery&&(this.state=GameModel.EnemyState.DelayClear,this.spine.setAnimation(0,"4.linghun",!0))),this.manager.gameNode.enemyBeKill(),this.frozenValidRound=this.twineValidRound=0,this.resetEffect(),this.canRevive?(this.spine.setAttachment("toukui","yincang"),this.spine.setAnimation(0,"4.linghun",!0)):(this.isAnimal&&!this.isDivide&&(this.playEffect(GameModel.EffectType.Die).zIndex=GameModel.MapHeight),this.isProduce||this.manager.addKill()),SoundManager.vibrateShort(),this.isAnimal&&SoundManager.playSound(Model.AudioUrl.Die),this.isBombVertical?this.manager.gameNode.calBomb(this,GameModel.EnemyID.F021):this.isBombHorizontal?this.manager.gameNode.calBomb(this,GameModel.EnemyID.F024):this.isBombMultidirectional?this.manager.gameNode.calBomb(this,GameModel.EnemyID.F027):this.enemyType==GameModel.EnemyType.Noxious?this.manager.gameNode.propPoisoning(this):this.enemyType==GameModel.EnemyType.Burned?this.manager.gameNode.burned(this):this.enemyType==GameModel.EnemyType.Vine?(this.manager.gameNode.twine(this),this.playEffect(GameModel.EffectType.VineDie)):this.isIce?(this.manager.gameNode.frozen(this),this.playEffect(GameModel.EffectType.IceBreak),SoundManager.playSound(Model.AudioUrl.IceBreak)):this.isDivide?(this.manager.gameNode.divideEnemy(this),this.playEffect(GameModel.EffectType.DivideDie)):this.enemyType==GameModel.EnemyType.Obstruct&&(this.playEffect(GameModel.EffectType.RockBreak),SoundManager.playSound(Model.AudioUrl.RockBreak))},p.prototype.isReady=function(){return this.state==GameModel.EnemyState.Ready&&this.y<0},p.prototype.isDie=function(){return this.state==GameModel.EnemyState.Death},p.prototype.isDelayClear=function(){return this.state==GameModel.EnemyState.DelayClear},p.prototype.isAlive=function(){return this.state==GameModel.EnemyState.Ready||this.canRevive},p.prototype.die=function(){this.state=GameModel.EnemyState.Death,this.resetEffect()},p.prototype.revive=function(){this.resetData(),this.rigidBody.active=!0,this.reviveTimes=0,this.mHealthPoint=Math.ceil(this.fullHealthPoint*(this.info.healper/100)),console.log("revive hp:",this.mHealthPoint),this.refreshHealthPoint(),this.playReady(),this.playEffect(GameModel.EffectType.Revive),SoundManager.playSound(Model.AudioUrl.Revive)},p.prototype.removeSelf=function(){this.canRevive||(this.manager.gameNode.removeEnemy(this),this.isProduce||this.manager.gameNode.addCoin(this))},p.prototype.checkIsInvincible=function(e){if(this.bInvincible)return!0;if(e&&this.isInvincible){var t=this.node.parent.convertToWorldSpaceAR(this.position,ex.v2temp());if(e.x>=t.x&&e.x<=t.x+this.info.size*GameModel.BlockWidth&&e.y<=t.y)return!0}return!1},p.prototype.hit=function(e,t,o){if(this.isProduce)return!1;if(e<=0)return!1;if(this.isBeLink)return SoundManager.playSoundSingle(Model.AudioUrl.HitShield,.1),this.hitEffectAni.showAni(),!1;if(this.checkIsInvincible(t))return SoundManager.playSoundSingle(Model.AudioUrl.HitShield,.1),this.hitEffectAni.showAni(),!1;!t||0<(n=t.shooter.randomCritical())&&(e=n,o=null,GameData.completeTask(GameModel.TaskType.CriticalHit));var i=!0;t&&0<this.curseHurt&&(e+=this.curseHurt);var n=this.manager.attackRound%2;this.isHalfHurt&&(e=0==n?Math.ceil(e*(this.info.addhurt.reduce/100)):Math.ceil(e*(1+this.info.addhurt.increase/100))),0<this.shieldValidTimes&&(this.shieldValidTimes--,i=!(e=1),0==this.shieldValidTimes&&(this.shieldProgressBar.node.active=!1,(a=this.getEffect(GameModel.EffectType.Shield))&&(a.active=!1)),SoundManager.playSoundSingle(Model.AudioUrl.HitShield,.1)),this.mHealthPoint-=e,this.mHealthPoint<0&&(this.mHealthPoint=0),this.refreshHealthPoint();var a=(n=this.manager.gameNode.convertToScenePoint(this.position,ex.v2temp())).x+GameModel.BlockWidth*this.info.size/2;return n=n.y+GameModel.BlockWidth*this.info.size/2,this.manager.showBloodTips(a,n,-e,o),i&&(this.spine&&this.spine.skeletonData&&this.isAnimal&&!this.isBeFronzeStatic&&this.spine.setAnimation(0,"3.beida",!1),this.spine.setMaterial(0,this.material_spine_attacked),this.sprite.setMaterial(0,this.material_sprite_attacked),this.hitAniTime=.2,t)&&(SoundManager.playSoundSingle(Model.AudioUrl.Hit,.1),e=this.manager.gameNode,o=t.x-e.worldPos.x-GameModel.BlockWidth/2,i=t.y-e.worldPos.y-GameModel.BlockWidth/2,e=GameConfig.usingAuxArms,this.manager.playEffect("hit_"+e,o,i)),this.mHealthPoint<=0&&(this.onDeath(),t&&this.isDie()&&this.removeSelf(),!0)},p.prototype.hitHpRatio=function(e){e=Math.ceil(this.mHealthPoint*(e/100)),this.hit(e)},p.prototype.hitDelay=function(e,t,o){void 0===o&&(o=0),0<t?(this.delayHitInfo.hurt=e,this.delayHitInfo.time=t,this.delayHitInfo.burnedHurt=o):(this.hit(e),this.burned(o))},p.prototype.useAdd=function(){this.mHealthPoint--,this.refreshHealthPoint(),this.mHealthPoint<=0&&this.die(),this.playEffect(GameModel.EffectType.AddBullet),SoundManager.playSound(Model.AudioUrl.Produce)},p.prototype.useMul=function(){this.produceUsed=!0,this.playEffect(GameModel.EffectType.AddBullet),SoundManager.playSound(Model.AudioUrl.Produce)},p.prototype.useProduce=function(){this.die(),SoundManager.playSound(Model.AudioUrl.Produce)},p.prototype.calBeforeRoundBuff=function(){var e;this.isProduce&&(e=null,this.isAddition?e=GameModel.EffectType.Addition:this.isMultiplication?e=GameModel.EffectType.Multiplication:this.isAddCapacity?e=GameModel.EffectType.AddCapacity:this.isSkillBuff&&(e=GameModel.EffectType.SkillBuff),e&&!this.getEffect(e)&&this.showEffect(e)),this.isShield&&(this.shieldValidTimes=this.info.shield,this.shieldProgressBar.node.active=!0,this.refreshHealthPoint(),(e=this.getEffect(GameModel.EffectType.Shield))?e.active=!0:this.showEffect(GameModel.EffectType.Shield))},p.prototype.calAfterRoundBuff=function(){this.isRecoveryHP&&(this.recoveryRatio(this.info.healper),this.playEffect(GameModel.EffectType.Recovery),SoundManager.playSound(Model.AudioUrl.Recovery)),0<this.crossRecoveryHP&&(this.recoveryBlood(this.crossRecoveryHP),this.crossRecoveryHP=0,this.playEffect(GameModel.EffectType.Recovery)),this.isLayEggs&&this.manager.gameNode.layeggs(this),0<this.propPoisonedHurt&&this.hit(this.propPoisonedHurt,null,GameModel.FontColorNoxious),0<this.burnedHurt&&this.hit(this.burnedHurt,null,GameModel.FontColorFire),this.subFrozenRound(),0<this.poisonedHurt&&this.hit(this.poisonedHurt,null,GameModel.FontColorNoxious),this.curseHurt},p.prototype.calAfterAttackBuff=function(){this.linkSource&&(this.linkSource=null,this.hideEffect(GameModel.EffectType.Link),this.hideEffect(GameModel.EffectType.LinkShield)),0<this.electrocutedHurt&&(this.hit(this.electrocutedHurt,null,GameModel.FontColorLightning),this.electrocutedHurt=0,SoundManager.playSoundSingle(Model.AudioUrl.BuffElectric)),this.hideEffect(GameModel.EffectType.Connect)},p.prototype.clear=function(){this.resetEffect(),this.node.destroy()},l([a({type:cc.Sprite,tooltip:"icon"})],p.prototype,"sprite",void 0),l([a({type:sp.Skeleton,tooltip:"spine"})],p.prototype,"spine",void 0),l([a({type:cc.RigidBody,tooltip:"Rigid body"})],p.prototype,"rigidBody",void 0),l([a({type:cc.PhysicsBoxCollider,tooltip:"Collision zone"})],p.prototype,"boxCollider",void 0),l([a({type:cc.Label,tooltip:"multipleLabel"})],p.prototype,"multipleLabel",void 0),l([a({type:cc.Label,tooltip:"HPlabel"})],p.prototype,"hpLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"HpProgressBar"})],p.prototype,"hpProgressBar",void 0),l([a({type:cc.ProgressBar,tooltip:"ShieldProgressBar"})],p.prototype,"shieldProgressBar",void 0),l([a({type:u.default,tooltip:"Hit Special Effect (Invincible)"})],p.prototype,"hitEffectAni",void 0),n=d=l([n],p),r.default=n,cc._RF.pop()},{}],ExpireNode:[function(e,t,o){"use strict";cc._RF.push(t,"7941e+aAspBIKj6TKhmW6+U","ExpireNode");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c,d=a("BaseScript");function h(){return null!==l&&l.apply(this,arguments)||this}a=(n=cc._decorator).ccclass,n.property,s(h,l=d.default),(c=h).show=function(){l.beginLoading.call(this)&&(G.showLoading(),cc.resources.load("prefab/ExpireNode",cc.Prefab,function(e,t){G.hideLoading(),e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))}))},Object.defineProperty(h,"fileName",{get:function(){return"ExpireNode"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"className",{get:function(){return c.fileName},enumerable:!1,configurable:!0}),h.prototype.onLoad=function(){this.pageName="Delay",l.prototype.onLoad.call(this),this.enterPage({existVideo:!0})},h.prototype.onDelayClick=function(){var e=this;G.rewardOperation(this.pageName,"Delay",function(){e.requestReward(),e.close()}),SoundManager.playSound(Model.AudioUrl.Click)},h.prototype.requestReward=function(){GameData.delayTaskTime(),MSGEvent.sendEvent(MSGEvent.DELAY_TASK)},a=c=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],h),r.default=a,cc._RF.pop()},{}],Extend:[function(e,t){"use strict";var o;cc._RF.push(t,"5cd0cBODPhEsKaWjGMrOVc7","Extend"),function(e){cc.Sprite.prototype.loadImage=function(e,t){var o=this;(t?cc.assetManager.getBundle(t):cc.resources).load(e,cc.SpriteFrame,function(e,t){e?console.warn(e):o&&o.isValid&&(o.spriteFrame=t)})},cc.Sprite.prototype.loadSubpackageImage=function(e){this.loadImage(e,"subpackage")},cc.Sprite.prototype.loadSubgameImage=function(e){this.loadImage(e,"subgame")},e.hexToColor=function(e){return e=e.replace(/^#?/,"0x"),e=parseInt(e),cc.color(e>>16,(65280&e)>>8,255&e)},e.tmpVector2=cc.v2(0,0);var t=cc.v2(0,0);e.v2temp=function(e,o){return void 0===o&&(o=0),"number"==typeof(e=void 0===e?0:e)?(t.x=e,t.y=o):(t.x=e.x,t.y=e.y),t};var o=cc.v3(0,0,0);function i(t){var o=Math.floor(t/60);return t=Math.floor(t%60),e.formatNumber(o,2)+":"+e.formatNumber(t,2)}function n(e,t){return e=new Date(e),t=new Date(null!=t?t:Date.now()),e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}e.v3temp=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=0),"number"==typeof(e=void 0===e?0:e)?(o.x=e,o.y=t,o.z=i):(o.x=e.x,o.y=e.y,o.z=e.z),o},e.pAdd=function(e,t,o){return(o=null!=o?o:cc.v2()).x=e.x+t.x,o.y=e.y+t.y,o},e.pSub=function(e,t,o){return(o=null!=o?o:cc.v2()).x=e.x-t.x,o.y=e.y-t.y,o},e.pMult=function(e,t,o){return(o=null!=o?o:cc.v2()).x=e.x*t,o.y=e.y*t,o},e.pLength=function(t){return Math.sqrt(e.pLengthSQ(t))},e.pLengthSQ=function(t){return e.pDot(t,t)},e.pDot=function(e,t){return e.x*t.x+e.y*t.y},e.pDistance=function(o,i){return e.pLength(e.pSub(o,i,t))},e.pForAngle=function(e,t){return(t=null!=t?t:cc.v2()).x=Math.cos(e),t.y=Math.sin(e),t},e.pToAngle=function(e){return Math.atan2(e.y,e.x)},e.convertToRotation=function(e){return 180/Math.PI*e},e.convertToAngle=function(e){return Math.PI/180*e},e.rand=function(e,t){var o=Math.floor(e+Math.random()*(t-e+1));return o=Math.min(o,t),Math.max(o,e)},e.randFloat=function(e,t){return e+Math.random()*(t-e)},e.formatNumber=function(e,t){for(var o="";0<t;)e<Math.pow(10,t-1)&&(o+="0"),t--;return 0<e?o+e:o},e.formatSecondToMinute=i,e.formatDateTime=function(e){if(e<=0)return"00:00";var t,o=Math.floor(e/86400);return 0<o?0<(t=Math.floor(e%86400/3600))?o+"Day"+t+"Hour":o+"Day":0<(t=Math.floor(e/3600))?0<(o=Math.floor(e%3600/60))?t+"Hour"+o+"Minutes":t+"Hour":i(e%3600)},e.shuffle=function(e){for(var t=e.length;t;){var o=Math.floor(Math.random()*t--),i=[e[t],e[o]];e[o]=i[0],e[t]=i[1]}},e.isToday=function(e){return n(e)},e.isSameDay=n,e.listenerOnError=function(){window.onerror=function(e,t,o,i,n){return G.pushEvent("JsError",{errMsg:e}),console.warn(e+"\n"+t+":"+o+":"+i+"\n"+n),!1}}}(o=o||{}),window.ex=o,cc._RF.pop()},{}],FlashAlphaShader:[function(e,t,o){"use strict";cc._RF.push(t,"a72e9DtP/VEMoxS01osznR+","FlashAlphaShader");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var s,l=cc._decorator;function c(){var e=null!==s&&s.apply(this,arguments)||this;return e.flashMaterial=null,e.flashTime=0,e}n=l.ccclass,l.property,r(c,s=cc.Component),c.prototype.update=function(e){this.flashMaterial||(this.flashMaterial=this.node.getComponent(cc.Sprite).getMaterial(0)),this.flashMaterial&&(this.flashTime+=e,6<this.flashTime&&(this.flashTime=0),this.flashMaterial.setProperty("time",this.flashTime))},n=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([n],c),a.default=n,cc._RF.pop()},{}],FreeGold:[function(e,t,o){"use strict";cc._RF.push(t,"3ac01FQUiBCyb2OuKYxjkJ3","FreeGold");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript"),u=n("RewardGoldTips");function p(){var e=null!==c&&c.apply(this,arguments)||this;return e.rewardLabel=null,e.btnReceive=null,e.uidLabel=null,e.rewardGold=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(p,c=h.default),(d=p).show=function(){GameConfig.haveRewardGoldValidTimes()?c.isShown.call(this)||c.beginLoading.call(this)&&(G.showLoading(),cc.resources.load("prefab/FreeGold",cc.Prefab,function(e,t){G.hideLoading(),e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))})):G.showToast({title:"Not enough gold,,Today's free collection times have been exhausted."})},Object.defineProperty(p,"fileName",{get:function(){return"FreeGold"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),p.prototype.onLoad=function(){this.pageName="Gold coin shortage",c.prototype.onLoad.call(this),this.enterPage({existBanner:!1,existVideo:!0});var e=GameConfig.getCoinCostInfo(GameData.currLevel);this.rewardGold=360*e.online,this.rewardLabel.string=GA.formatNumber(this.rewardGold);var t=this.btnReceive.node.children[0].getComponent(cc.Sprite);G.isWeChat()?(e=GA.isNextRewardVideo("Receive gold coin")?"video":"share",Utils.loadSubpackageImage("prefab/icon_"+e,t)):Utils.loadSubpackageImage("prefab/icon_video",t),this.uidLabel.string="UID:"+G.uid},p.prototype.start=function(){},p.prototype.onReceiveClick=function(){var e=this;G.rewardOperation(this.pageName,"Receive gold coin",function(){e.requestReward()})},p.prototype.requestReward=function(){var e=GameData.gold;GameData.addGold(this.rewardGold),GameData.receiveGift(),MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO,{before:e}),u.default.show(this.rewardGold),this.close()},l([a({type:cc.Label,tooltip:"Rewardlabel"})],p.prototype,"rewardLabel",void 0),l([a({type:cc.Button,tooltip:"Get"})],p.prototype,"btnReceive",void 0),l([a({type:cc.Label,tooltip:"UserIDlabel"})],p.prototype,"uidLabel",void 0),n=d=l([n],p),r.default=n,cc._RF.pop()},{}],FreeStamina:[function(e,t,o){"use strict";cc._RF.push(t,"8ce691IjMhBdKVYxSJxXCgi","FreeStamina");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.rewardLabel=null,e.rewardStamina=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(){c.isShown.call(this)||c.beginLoading.call(this)&&cc.resources.load("prefab/FreeStamina",cc.Prefab,function(e,t){e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))})},Object.defineProperty(u,"fileName",{get:function(){return"FreeStamina"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),u.prototype.onLoad=function(){this.pageName="Low energy",c.prototype.onLoad.call(this),this.enterPage({existVideo:!0}),this.rewardStamina=GameConfig.GameConf.endurancevideo,this.rewardLabel.string=""+this.rewardStamina},u.prototype.start=function(){},u.prototype.onReceiveClick=function(){var e=this;G.rewardOperation(this.pageName,"Physical recovery",function(){e.requestReward()})},u.prototype.requestReward=function(){GameData.addStamina(this.rewardStamina),MSGEvent.sendEvent(MSGEvent.UPDATE_STAMINA),G.showToast({title:"Congratulations on winning"+this.rewardStamina+"energy"}),this.close()},l([a({type:cc.Label,tooltip:"Rewardlabel"})],u.prototype,"rewardLabel",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],FreeTrial:[function(e,t,o){"use strict";cc._RF.push(t,"f93cb01iBxJ1b5yhEgUuxgl","FreeTrial");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.trialList=null,e.closeCallback=null,e.itemTemplate=null,e.btnContinue=null,e.trialItems=[],e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(e){var t=this.randomTrialList();t?c.isShown.call(this)||c.beginLoading.call(this)&&cc.resources.load("prefab/FreeTrial",cc.Prefab,function(o,i){o?cc.error(o):((i=cc.instantiate(i)).getComponent(d).setData(t,e),cc.Canvas.instance.node.addChild(i))}):e&&e()},Object.defineProperty(u,"fileName",{get:function(){return"FreeTrial"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),u.randomTrialList=function(){if(3<=GameData.currLevel){var e=GameModel.AuxTrialProbabilityList,t=Math.floor((GameData.currLevel-1)/10);if(e=(e=e[Math.min(t,e.length-1)])[t=(GameData.currLevel-1)%5],3==(t=1+t)||5==t?(GameConfig.lastLoseLevel-1)%5+1!=t&&(e=0,console.log("The current level is not displayed.")):2<=GameConfig.trialContinueClose&&(e=0,console.log("Continuous closing not displayed")),e&&ex.rand(1,100)<=e){for(var o=[];;){var i=ex.rand(1,GameModel.ArmsCount);if(!o.includes(i)&&(o.push(i),3<=o.length))break}return o}}return null},u.prototype.setData=function(e,t){this.trialList=e,this.closeCallback=t},u.prototype.onLoad=function(){this.pageName="Trial",c.prototype.onLoad.call(this),this.enterPage({existVideo:!0}),this.addItem(this.itemTemplate),this.itemTemplate.x=-180;for(var e=1;e<3;e++){var t=cc.instantiate(this.itemTemplate);t.x=this.itemTemplate.x+180*e,this.itemTemplate.parent.addChild(t),this.addItem(t)}GameInfo.isShowTextButton()||this.btnContinue.loadSubpackageImage("prefab/btn_continue")},u.prototype.start=function(){},u.prototype.addItem=function(e){var t=this.trialItems.length,o=e.getChildByName("icon").getComponent(cc.Sprite);e.getChildByName("btn_trial").getComponent(cc.Button).clickEvents[0].customEventData=""+t,this.trialItems.push({icon:o}),Utils.loadSubpackageImage("prefab/trial_"+this.trialList[t],o)},u.prototype.close=function(){this.closeCallback&&this.closeCallback(),c.prototype.close.call(this)},u.prototype.onCloseClick=function(){c.prototype.onCloseClick.call(this),GameConfig.trialContinueClose++},u.prototype.onTrialClick=function(e,t){var o=this,i=this.trialList[t];G.rewardOperation(this.pageName,"Ful\xb7l trial",function(){o.requestReward(i),o.close()},null,""+i)},u.prototype.requestReward=function(e){GameConfig.trialContinueClose=0,GameConfig.trialAuxArms=e},l([a({type:cc.Node,tooltip:"Trial list"})],u.prototype,"itemTemplate",void 0),l([a({type:cc.Sprite,tooltip:"Play"})],u.prototype,"btnContinue",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],GameConfig:[function(e,t){"use strict";cc._RF.push(t,"6f943wjOHNKT5RafAB2ocKL","GameConfig");var o=window.GameConfig=(Object.defineProperty(i.prototype,"usingAuxArms",{get:function(){return 0<this.trialAuxArms?this.trialAuxArms:GameData.currAuxArms},enumerable:!1,configurable:!0}),i.prototype.initialize=function(){this.AuxLockList.sort(function(e,t){return e.type>t.type?1:e.type<t.type?-1:0});for(var e,t,o=0;o<this.AuxLockList.length;o++){var i=this.AuxLockList[o];console.log(i.name,"type="+i.type+":","unlock type",i.unlock.type,"unlock level:",i.unlock.level)}this.maxGameLevel=this.MainArms[this.MainArms.length-1].level,this.maxPlayerLevel=this.maxGameLevel,console.log("level:",this.maxGameLevel,"player:",this.maxPlayerLevel),this.refreshPlayerLevel(),this.refreshRoleAdded(),0!=GameData.lastLoginTime&&ex.isToday(GameData.lastLoginTime)||(GameData.login(),GameData.completeTask(GameModel.TaskType.Login)),!G.isPreview&&GameData.stamina<this.GameConf.endurancelimit&&(e=Math.round((Date.now()-GameData.staminaResumeTime)/1e3))>this.GameConf.endurancecd.time&&(t=Math.floor(e/this.GameConf.endurancecd.time),GameData.addStamina(t,!0),GameData.updateResumeStaminaTime()),ex.isToday(GameData.giftData.lastgettime)||GameData.recoveryGift(),0<GameData.taskStartTime?(t=Date.now()-GameData.taskStartTime,n=Math.ceil(t/864e5),t=GameData.taskStartTime+t%864e5,ex.isSameDay(GameData.taskStartTime,t)?this.taskContinuedDay=n:this.taskContinuedDay=n+1):this.taskContinuedDay=1,GuideUtils.initialize();var n=null!==(n=ProjectConfig.AdConfig.CustomAdUpdateTimes)&&void 0!==n?n:3;AdManager.setCustomAdValidTimes(new Map([[Model.AdTag.HorizontalList,n],[Model.AdTag.SingleCustom,1],[Model.AdTag.MatrixList,999]]))},i.prototype.initWithData=function(e){e.AdConfig&&this.setAdConfig(e.AdConfig),e.GameConfig&&this.setGameConfig(e.GameConfig),e.MainArms&&this.setMainArms(e.MainArms),e.Enemy&&this.setEnemy(e.Enemy),e.GameCoin&&this.setGameCoin(e.GameCoin),e.EnemyTips&&this.setEnemyTips(e.EnemyTips),e.TaskConfig&&this.setTaskList(e.TaskConfig),e.BuffConfig&&this.setBuffList(e.BuffConfig),this.initAuxiliaryArmsData(e)},i.prototype.initLevelData=function(e,t){var o=this;e.forEach(function(e){t[e.key]&&o.setLevel(t[e.key])})},i.prototype.initAuxiliaryArmsData=function(e){e.AuxiliaryArms01&&this.setAuxiliaryArms(e.AuxiliaryArms01),e.AuxiliaryArms02&&this.setAuxiliaryArms(e.AuxiliaryArms02),e.AuxiliaryArms03&&this.setAuxiliaryArms(e.AuxiliaryArms03)},i.prototype.setAdConfig=function(e){(e=this.csvToJSON(e))&&1<e.length&&(e=e[1],ProjectConfig.AdConfig=e)},i.prototype.setGameConfig=function(e){(e=this.csvToJSON(e))&&1<=e.length&&((e=e[1]).auxiliaryunlock&&(e.auxiliaryunlock=this.parseAuxiliaryUnlock(e.auxiliaryunlock)),e.endurancecd&&(e.endurancecd=this.parseEndurancecd(e.endurancecd)),e.weaponcri&&(e.weaponcri=this.parseArmsCriticalConst(e.weaponcri)),e.crirate&&(e.crirate=this.parseMinMax(e.crirate)),e.crimag&&(e.crimag=this.parseMinMax(e.crimag)),this.GameConf=e)},i.prototype.setLevel=function(e){var t=this,o=this.csvToJSON(e);o.shift(),o.forEach(function(e){if(e.enemy&&(e.enemy=t.parseLeveEnemy(e.enemy),t.showCheck(e.enemy.length!=e.round)&&console.warn("The level enemy configuration is incorrect:level="+e.level+",Wave number="+e.round+",Number of enemies:"+e.enemy.length)),e.points&&(e.points=t.parseLevePoints(e.points),t.showCheck(!e.points)&&console.warn("\u5173\u5361\u5750\u6807\u914d\u7f6e\u9519\u8bef:level="+e.level+",\u6ce2\u6570="+e.round+",\u5750\u6807\u6570:"+e.points.length)),e.hp&&(e.hp=t.parseLeveHealthPoint(e.hp),t.showCheck(e.hp.length!=e.round)&&console.warn("Level enemy health is incorrectly configured:level="+e.level+",Wave number="+e.round+",Blood volume:"+e.hp.length)),t.DEBUG){window.errorCount||(window.errorCount={count:0});var o=window.errorCount;if(o.count<10)for(var i=0;i<e.round;i++)e.enemy[i]&&e.points[i]&&e.enemy[i].length!=e.points[i].length&&(console.warn("The level is incorrectly configured with enemy number points:level="+e.level+",round="+(i+1)+",enemy count:"+e.enemy[i].length+","+e.points[i].length),o.count++),e.enemy[i]&&e.hp[i]&&e.enemy[i].length!=e.hp[i].length&&(console.warn("\u5173\u5361\u914d\u7f6e\u654c\u4eba\u6570\u91cfHP\u9519\u8bef:level="+e.level+",round="+(i+1)+",hp count:"+e.enemy[i].length+","+e.hp[i].length),o.count++)}}),this.LevelList?(e=this.LevelList).push.apply(e,o):this.LevelList=o},i.prototype.setMainArms=function(e){(e=this.csvToJSON(e)).shift(),e.forEach(function(){}),this.MainArms=e},i.prototype.setAuxiliaryArms=function(e){var t=this,o=this.csvToJSON(e);o.shift(),o.forEach(function(e){e.unlock&&(e.unlock=t.parseArmsUnlock(e.unlock),t.AuxLockList.push(e))}),this.AuxiliaryArms?(e=this.AuxiliaryArms).push.apply(e,o):this.AuxiliaryArms=o},i.prototype.setEnemy=function(e){var t=this;(e=this.csvToJSON(e)).shift(),e.forEach(function(e){e.enemytype=10*(e.classify+1)+e.type,e.addhurt&&(e.addhurt=t.parseEnemyAddHurt(e.addhurt))}),this.EnemyList=e},i.prototype.setGameCoin=function(e){(e=this.csvToJSON(e)).shift(),this.CoinCostList=e},i.prototype.setEnemyTips=function(e){(e=this.csvToJSON(e)).shift(),this.EnemyTipsList=e},i.prototype.setTaskList=function(e){(e=this.csvToJSON(e)).shift(),this.TaskList=e},i.prototype.setBuffList=function(e){(e=this.csvToJSON(e)).shift(),this.BuffList=e},i.prototype.getGuideLevelInfo=function(){var e=GameModel.GuideLevelEnemy,t=GameModel.GuideLevelPoint,o=GameModel.GuideLevelHP;return{level:0,round:2,enemy:this.parseLeveEnemy(e),points:this.parseLevePoints(t),hp:this.parseLeveHealthPoint(o),mul:0,add:0,per:100,exp:0}},i.prototype.getLevelInfo=function(e){if(0==e)return this.getGuideLevelInfo();var t=this.LevelList.length;if(e>this.LevelList[t-1].level)return this.LevelList[t-1];for(var o=0;o<this.LevelList.length;o++)if(this.LevelList[o].level==e)return this.LevelList[o]},i.prototype.getCoreArmsInfo=function(e){return e=Math.min(e,this.maxGameLevel),this.MainArms[e-1]},i.prototype.getAuxiliaryArmsInfo=function(e,t){if(this.AuxiliaryArms){if(0==t)return null;t=Math.min(t,this.maxGameLevel);for(var o=0;o<this.AuxiliaryArms.length;o++){var i=this.AuxiliaryArms[o];if(i.type==e&&i.level==t)return i}}return null},i.prototype.getCoinCostInfo=function(e){e=Math.min(e,this.maxGameLevel);for(var t=0;t<this.CoinCostList.length;t++){var o=this.CoinCostList[t];if(o.level==e)return o}return null},i.prototype.getEnemyInfo=function(e){for(var t=0;t<this.EnemyList.length;t++)if(this.EnemyList[t].id==e)return this.EnemyList[t];return console.warn("\u672a\u67e5\u8be2\u5230\u654c\u4eba,"+e),null},i.prototype.getEnemyTipsInfo=function(e,t){for(var o=0;o<this.EnemyTipsList.length;o++){var i=this.EnemyTipsList[o];if(i.level==e)if(i.round){if(i.round==t)return i}else if(1==t)return i}return null},i.prototype.checkUnlockAux=function(e){e=null!=e?e:GameData.currLevel;for(var t=0;t<this.AuxLockList.length;t++){var o=this.AuxLockList[t];if(o.unlock.type==GameModel.AuxUnlockType.Level&&e==o.unlock.level&&!GameData.hasAuxiliary(o.type))return GameData.unlockAuxiliary(o.type),o.type}return 0},i.prototype.haveRewardGoldValidTimes=function(){var e=G.isNative()?GameModel.RewardGoldLimitApp:GameModel.RewardGoldLimitWechat;return GameData.giftData.times<e},i.prototype.getOnlineReward=function(){28800<(t=Math.ceil((Date.now()-GameData.lastOnlineReceiveTime)/1e3))&&(t=28800);var e=this.getCoinCostInfo(GameData.currLevel).online/300,t=Math.ceil(e*t)+GameData.gameLevelExtraReward;return this.onlineRewardMax=Math.ceil(28800*e),this.onlineRewardGold=Math.min(t,this.onlineRewardMax),this.onlineRewardGold},i.prototype.refreshPlayerLevel=function(){for(var e=GameData.exp,t=0,o=0,i=this.MainArms.length;o<i;o++){var n=this.MainArms[o];if(e<=(t+=n.exp)){this.playerLevel=n.level;break}}t<e&&(this.playerLevel=this.maxPlayerLevel),console.log("current player level:",this.playerLevel)},i.prototype.refreshRoleAdded=function(){this.roleAttackAdded=0;for(var e=this.roleLuckAdded=0,t=GameData.auxArmsList.length;e<t;e++){var o=GameData.auxArmsList[e];0<o.level&&(this.roleAttackAdded+=Math.floor(o.level/10),this.roleLuckAdded+=Math.floor(o.lucklevel/10))}console.log("role attack added:",this.roleAttackAdded,"role luck added:",this.roleLuckAdded)},i.prototype.getCurrentPower=function(e){var t=0,o=this.getCoreArmsInfo(GameData.coreGrade.capacitylevel).bulletcount;t+=25*GameData.coreGrade.level+15*GameData.coreGrade.lucklevel+300*o;for(var i=0,n=GameData.auxArmsList.length;i<n;i++){var a,r=GameData.auxArmsList[i];0<r.level&&(a=this.getAuxiliaryArmsInfo(r.type,r.capacitylevel).bulletcount,t+=10*r.level+5*r.lucklevel+50*a)}return this.calPlayerLevelAdded(t,e)},i.prototype.calPlayerLevelAdded=function(e,t){return t=null!=t?t:this.playerLevel,Math.ceil(e*(1+t/100))},i.prototype.syncTaskData=function(){for(var e=0;e<this.TaskList.length;e++){var t=this.TaskList[e],o=GameData.getTaskData(t.id);t.state=o?o.state:GameModel.TaskState.Normal,t.completeNum=GameData.getTaskCompletedTimes(t.tasktype),t.state!=GameModel.TaskState.Received&&t.completeNum>=t.parameter&&(t.state=GameModel.TaskState.CanReceive)}},i.prototype.haveCanReceiveTask=function(){for(var e=0;e<this.TaskList.length;e++){var t=this.TaskList[e];if(t.day<=this.taskContinuedDay&&t.state==GameModel.TaskState.CanReceive)return!0}return!1},i.prototype.getBuffInfoWithGroup=function(e){for(var t=[],o=0,i=this.BuffList.length;o<i;o++){var n=this.BuffList[o];n.type==e&&n.usetimes<n.limit&&t.push(n)}return t},i.prototype.resetBuffUseTimes=function(){for(var e=0,t=this.BuffList.length;e<t;e++)this.BuffList[e].usetimes=0},i.prototype.checkShowCoreArmsRedTips=function(){return!!this.checkShowCoreArmsLevelRedTips()||!!this.checkShowCoreArmsLuckRedTips()||!!this.checkShowCoreArmsCapacityRedTips()},i.prototype.checkShowCoreArmsLevelRedTips=function(){var e=GameData.getCoreArmsLevel();return o.getCoinCostInfo(e).atk<=GameData.gold},i.prototype.checkShowCoreArmsLuckRedTips=function(){var e=GameData.getCoreLuckLevel();return o.getCoinCostInfo(e).playerluck<=GameData.gold},i.prototype.checkShowCoreArmsCapacityRedTips=function(){var e=GameData.getCoreCapacityLevel();return o.getCoinCostInfo(e).playerbullet<=GameData.gold},i.prototype.checkShowAuxArmsRedTips=function(){if(GameData.currLevel<GameModel.AuxArmsTabBarUnlockLevel)return!1;for(var e=0;e<GameData.auxArmsList.length;e++){var t=GameData.auxArmsList[e];if(0!=t.level){if(this.getCoinCostInfo(t.level).atk<=GameData.gold)return!0;if(this.getCoinCostInfo(t.level).weaponluck<=GameData.gold)return!0;if(this.getCoinCostInfo(t.level).weaponbullet<=GameData.gold)return!0}}return!1},i.prototype.getCurrentScene=function(e){return(e=null!=e?e:GameData.currLevel)<=200?e<=20?1:e<=40?2:e<=60?3:e<=100?4:e<=150?5:6:Math.ceil((e-200)/50)%6+1},i.prototype.showParseFail=function(e,t){this.DEBUG&&(G.showModal({title:"Tips",showCancel:!1,content:(null!=t?t:"")+"\u914d\u7f6e\u5b57\u6bb5\u683c\u5f0f\u9519\u8bef:"+e}),console.error((null!=t?t:"")+"\u914d\u7f6e\u5b57\u6bb5\u683c\u5f0f\u9519\u8bef:"+e))},i.prototype.csvToJSON=function(e){return Papa.parse(e.trim(),{dynamicTyping:!0,header:!0}).data},i.prototype.parseMinMax=function(e){return 2<=(e=this.parseSplitList(e,",")).length?{min:parseInt(e[0]),max:parseInt(e[1])}:null},i.prototype.parseAuxiliaryUnlock=function(e){return 2<=(e=this.parseSplitList(e,",")).length?{left:e[0],right:e[1]}:null},i.prototype.parseEndurancecd=function(e){return 2<=(e=this.parseSplitList(e,",")).length?{time:parseInt(e[0]),count:parseInt(e[1])}:null},i.prototype.parseArmsCriticalConst=function(e){for(var t=[],o=this.parseSplitList(e,";"),i=0;i<o.length;i++){var n=this.parseSplitList(o[i],",");2<=n.length&&t.push({criticalhit:n[0],criticalhurt:n[1]})}return t},i.prototype.parseLeveEnemy=function(e){for(var t=[],o=this.parseSplitList(e,"|"),i=0;i<o.length;i++){var n=this.parseSplitList(o[i],";");t.push(n)}return t},i.prototype.parseLevePoints=function(e){for(var t=[],o=this.parseSplitList(e,"|"),i=0;i<o.length;i++){for(var n=this.parseSplitList(o[i],";"),a=[],r=0;r<n.length;r++){var s=this.parseSplitList(n[r],",");if(!(s&&2<=s.length))return console.warn("\u914d\u7f6e\u9519\u8bef"+e),null;a.push({x:parseInt(s[0]),y:parseInt(s[1])})}t.push(a)}return t},i.prototype.parseLeveHealthPoint=function(e){for(var t=[],o=this.parseSplitList(e,"|"),i=0;i<o.length;i++){for(var n=this.parseSplitList(o[i],";"),a=0;a<n.length;a++)n[a]=parseInt(n[a]);t.push(n)}return t},i.prototype.parseArmsUnlock=function(e){var t=this.parseSplitList(e,",");return 2<=t.length?{type:parseInt(t[0]),level:parseInt(t[1]),star:parseInt(t[1])}:(console.warn("\u914d\u7f6e\u9519\u8bef"+e),null)},i.prototype.parseEnemyAddHurt=function(e){var t=this.parseSplitList(e,",");return 2<=t.length?{increase:parseInt(t[0]),reduce:parseInt(t[1])}:(console.warn("\u914d\u7f6e\u9519\u8bef"+e),null)},i.prototype.parseSplitList=function(e,t){return"number"==typeof e?[e]:e.split(t)},i.prototype.parseJsonList=function(e){return JSON.parse(e)},i.prototype.showCheck=function(e){return this.DEBUG&&e},i.prototype.checkLevel=function(){for(var e=this.LevelList.length,t=0;t<e;t++)this.checkLevelInfo(this.LevelList[t])},i.prototype.checkLevelInfo=function(e){for(var t=0;t<e.round;t++){for(var o=t+1,i=e.points[t],n=e.enemy[t],a=new Map,r=0,s=0;s<i.length;s++){var l=i[s],c=this.getEnemyInfo(n[s]);if(!c)return console.warn("The enemy does not exist:level="+e.level),!1;c.classify==GameModel.EnemyClassify.Animal&&r++;var d=c.size;if(1<d)for(var h=d*d,u=0;u++<h-1;){var p=u%d,f=Math.floor(u/d),m=l.x+p,g=l.y+f;if(8<=m)return console.warn("Coordinate transgression:level="+e.level+",round="+o+","+c.id+",point=("+l.x+","+l.y+")"),!1;if(p=g*GameModel.MapCol+m,f=a.get(p))return console.warn("Coordinate conflict1:level="+e.level+",round="+o+","+c.id+"&"+f+",point=("+m+","+g+")"),!1;a.set(p,c.id)}var y=l.y*GameModel.MapCol+l.x,v=a.get(y);if(v)return console.warn("Coordinate conflict2:level="+e.level+",round="+o+","+c.id+"&"+v+",point=("+l.x+","+l.y+")"),!1;a.set(y,c.id)}0==r&&console.warn("No living thing:level="+e.level+",round="+o)}return!0},new i);function i(){this.DEBUG=!1,this.DEBUG_LEVEL=!1,this.AutomatedTesting=!1,this.TestLevel=0,this.TestAuxiliaryType=0,this.GameConf=null,this.LevelList=null,this.MainArms=null,this.AuxiliaryArms=null,this.EnemyList=null,this.CoinCostList=null,this.EnemyTipsList=null,this.TaskList=null,this.BuffList=null,this.playerLevel=0,this.AuxLockList=[],this.maxGameLevel=0,this.maxPlayerLevel=0,this.trialAuxArms=0,this.trialContinueClose=0,this.lastLoseLevel=0,this.winTimes=0,this.playTimes=0,this.taskShowTimes=0,this.showGoldAni=!1,this.bSubgameLoaded=!1,this.roleAttackAdded=0,this.roleLuckAdded=0,this.levelExpAdded=0,this.levelRewardAdded=0,this.signed=!1,this.onlineRewardGold=0,this.onlineRewardMax=0,this.taskContinuedDay=0}cc._RF.pop()},{}],GameData:[function(e,t){"use strict";cc._RF.push(t,"025ad7itYxN5acAqaRolX8f","GameData");var o=window.GameData=(i.prototype.check=function(){console.log("GameData is ok.")},i.prototype.initWithData=function(e){var t,o;try{if(null==e||""==e)return this.gold=null!==(t=GameConfig.GameConf.gold)&&void 0!==t?t:0,this.stamina=null!==(o=GameConfig.GameConf.endurance)&&void 0!==o?o:0,void(this.lastOnlineReceiveTime=Date.now());var i=JSON.parse(e);i.currLevel&&(this.currLevel=i.currLevel),i.gold&&(this.gold=i.gold),i.exp&&(this.exp=i.exp),i.star&&(this.star=i.star),i.stamina&&(this.stamina=i.stamina),i.staminaResumeTime&&(this.staminaResumeTime=i.staminaResumeTime),i.lastOnlineReceiveTime&&(this.lastOnlineReceiveTime=i.lastOnlineReceiveTime),i.gameLevelExtraReward&&(this.gameLevelExtraReward=i.gameLevelExtraReward),i.guideStep&&(this.guideStep=i.guideStep),i.giftData&&(this.giftData=i.giftData),i.taskStartTime&&(this.taskStartTime=i.taskStartTime),this.guideStep>=Model.GuideStep.End&&0==this.taskStartTime&&(this.taskStartTime=Date.now()),i.receivedTaskList&&(this.receivedTaskList=i.receivedTaskList),i.completedTaskList&&(this.completedTaskList=i.completedTaskList),i.receiveStarTimes&&(this.receiveStarTimes=i.receiveStarTimes);var n=function(e){var t,o=0<e.level?1:0;e.strengthlevel&&(e.lucklevel=Math.floor(e.strengthlevel/5),e.lucklevel=Math.max(e.lucklevel,o),e.strengthlevel=0),e.lucklevel=null!==(t=e.lucklevel)&&void 0!==t?t:o,e.capacitylevel=null!==(e=e.capacitylevel)&&void 0!==e?e:o};if(i.coreGrade&&(this.coreGrade=i.coreGrade,n(this.coreGrade)),i.currAuxArms&&(this.currAuxArms=i.currAuxArms),i.auxArmsList){this.auxArmsList=i.auxArmsList;for(var a=0,r=this.auxArmsList.length;a<r;a++)n(this.auxArmsList[a])}i.settingData&&(this.settingData=i.settingData),i.lastShowPrivacyTime&&(this.lastShowPrivacyTime=i.lastShowPrivacyTime),i.gameArchive&&(this.gameArchive=i.gameArchive),i.lastLoginTime&&(this.lastLoginTime=i.lastLoginTime)}catch(e){console.warn(e)}},i.prototype.initGMData=function(){var e;if(ProjectConfig.NoAd,["ovIf85YaU-j3JrXl_uO0BU3RRgeE","ovIf85a1mk4eEp-qEGY11g0IRF24","ovIf85bOLl_xQ6czbBHfnlvTkjMg"].includes(G.openId)){if(GameConfig.AutomatedTesting&&(GameConfig.DEBUG_LEVEL=!0),0<GameConfig.TestLevel)for(this.currLevel=GameConfig.TestLevel,e=this.currLevel;0<=e--;)GameConfig.checkUnlockAux(e);0<GameConfig.TestAuxiliaryType&&(this.currAuxArms=GameConfig.TestAuxiliaryType,this.gradeAuxArms(this.currAuxArms),this.gradeAuxLuck(this.currAuxArms),this.gradeAuxCapacity(this.currAuxArms))}},i.prototype.save=function(){try{this.lastGameTime=Date.now(),GA.PA.setStorageSync("GameData",JSON.stringify(this))}catch(e){console.warn(e)}},i.prototype.upload=function(){var e,t;GameConfig.DEBUG_LEVEL||(this.lastGameTime=Date.now(),e=JSON.stringify(this),t=this.currLevel,API.request({path:"game/reqSaveUser",params:{userId:G.uid,data:e,guanqia:t}}))},i.prototype.saveAndUpload=function(){cc.Canvas.instance.scheduleOnce(this.callLaterSaveAndUpload)},i.prototype.callLaterSaveAndUpload=function(){o.save(),o.upload()},i.prototype.addGold=function(e){0<(e=Math.round(e))&&(this.gold+=e,this.saveAndUpload())},i.prototype.payGold=function(e){return e=Math.round(e),this.gold>=e&&(this.gold-=e,this.saveAndUpload(),!0)},i.prototype.addStar=function(e){0<e&&(this.star+=e,this.saveAndUpload())},i.prototype.login=function(){this.lastLoginTime=Date.now(),this.saveAndUpload()},i.prototype.passLevel=function(){this.currLevel++;var e=GameConfig.checkUnlockAux();0<e&&(0==this.currAuxArms&&(this.currAuxArms=e),GameInfo.newArms=!0),this.setUserCloudStorage(),this.saveAndUpload()},i.prototype.setUserCloudStorage=function(){var e,t;!G.isPreview&&GA.isPlatform([GA.Platform.QQ,GA.Platform.WeChat])&&(console.log("setUserCloudStorage"),t=G.isWeChat()?(e={wxgame:{score:this.currLevel,update_time:Math.round(Date.now()/1e3)},cost_ms:36500},[{key:"level",value:JSON.stringify(e)}]):[{key:"level",value:""+this.currLevel}],GA.PA.setUserCloudStorage({KVDataList:t,success:function(){console.log("set level success")}}))},i.prototype.addStamina=function(e,t){void 0===t&&(t=!1),0<e&&(this.stamina+=e,t&&this.stamina>GameConfig.GameConf.endurancelimit&&(this.stamina=GameConfig.GameConf.endurancelimit),this.stamina>=GameConfig.GameConf.endurancelimit&&(this.staminaResumeTime=0),this.saveAndUpload())},i.prototype.consumeStamina=function(e){return this.stamina>=e&&(this.stamina-=e,this.saveAndUpload(),!0)},i.prototype.updateResumeStaminaTime=function(){this.stamina<GameConfig.GameConf.endurancelimit&&(this.staminaResumeTime=Date.now(),this.saveAndUpload())},i.prototype.checkAndUpdateStaminaResumeTime=function(){this.stamina<GameConfig.GameConf.endurancelimit&&0==this.staminaResumeTime&&(this.staminaResumeTime=Date.now(),this.saveAndUpload())},i.prototype.saveGuideStep=function(e){this.guideStep=e,this.saveAndUpload()},i.prototype.addExp=function(e){0<(e=Math.round(e))&&(this.exp+=e,this.saveAndUpload())},i.prototype.signIn=function(){this.signday<7&&(this.signday++,7==this.signday&&(this.signgroup=1,this.signday=0)),this.lastsigntime=Date.now(),this.saveAndUpload()},i.prototype.receiveGift=function(){this.giftData.times++,this.giftData.lastgettime=Date.now(),this.saveAndUpload()},i.prototype.recoveryGift=function(){this.giftData.times=0,this.giftData.lastgettime=0,this.saveAndUpload()},i.prototype.recordTaskStartTime=function(){this.taskStartTime=Date.now(),this.saveAndUpload()},i.prototype.delayTaskTime=function(){this.taskStartTime=Date.now()-1e3*(GameModel.TaskValidTime-86400),this.saveAndUpload()},i.prototype.getTaskData=function(e){for(var t=0;t<this.receivedTaskList.length;t++)if(this.receivedTaskList[t].id==e)return this.receivedTaskList[t];return null},i.prototype.getCompletedTask=function(e){for(var t=0;t<this.completedTaskList.length;t++)if(this.completedTaskList[t].type==e)return this.completedTaskList[t];return null},i.prototype.getTaskCompletedTimes=function(e){return(e=o.getCompletedTask(e))?e.completetimes:0},i.prototype.completeTask=function(e){this.saveTaskAddValueWithType(e)},i.prototype.completeTaskAddTimes=function(e,t){this.saveTaskAddValueWithType(e,t)},i.prototype.completeTaskSetTimes=function(e,t){this.saveTaskSetValueWithTimes(e,t)},i.prototype.addCompleteTaskData=function(e,t){this.completedTaskList.push({type:e,completetimes:t})},i.prototype.saveTaskAddValueWithType=function(e,t){void 0===t&&(t=1);var o=this.getCompletedTask(e);o?o.completetimes+=t:this.addCompleteTaskData(e,t),this.saveAndUpload()},i.prototype.saveTaskSetValueWithTimes=function(e,t){void 0===t&&(t=1);var o=this.getCompletedTask(e);o?o.completetimes=t:this.addCompleteTaskData(e,t),this.saveAndUpload()},i.prototype.changeTaskReceiveState=function(e){var t=this.getTaskData(e);t?t.state=GameModel.TaskState.Received:this.receivedTaskList.push({id:e,state:GameModel.TaskState.Received}),this.saveAndUpload()},i.prototype.receiveStarReward=function(){this.receiveStarTimes++,this.saveAndUpload()},i.prototype.getCoreArmsLevel=function(){return GameConfig.DEBUG_LEVEL?this.currLevel:this.coreGrade.level},i.prototype.getCoreLuckLevel=function(){return GameConfig.DEBUG_LEVEL?this.currLevel:this.coreGrade.lucklevel},i.prototype.getCoreCapacityLevel=function(){return GameConfig.DEBUG_LEVEL?Math.min(10,this.currLevel):this.coreGrade.capacitylevel},i.prototype.gradeCoreArms=function(){this.coreGrade.level++,this.saveAndUpload()},i.prototype.gradeCoreLuck=function(){this.coreGrade.lucklevel++,this.saveAndUpload()},i.prototype.gradeCoreCapacity=function(){this.coreGrade.capacitylevel++,this.saveAndUpload()},i.prototype.getAuxData=function(e){for(var t=0;t<this.auxArmsList.length;t++)if(this.auxArmsList[t].type==e)return this.auxArmsList[t];var o={type:e,level:0,lucklevel:0,capacitylevel:0};return this.auxArmsList.push(o),o},i.prototype.useAuxiliary=function(e){this.currAuxArms=e,this.saveAndUpload()},i.prototype.hasAuxiliary=function(e){return(e=this.getAuxData(e))&&0<e.level},i.prototype.getAuxiliaryArmsLevel=function(e){return GameConfig.DEBUG_LEVEL?this.currLevel:this.getAuxData(e).level},i.prototype.getAuxLuckLevel=function(e){return GameConfig.DEBUG_LEVEL?this.currLevel:this.getAuxData(e).lucklevel},i.prototype.getAuxCapacityLevel=function(e){return GameConfig.DEBUG_LEVEL?Math.min(10,this.currLevel):this.getAuxData(e).capacitylevel},i.prototype.gradeAuxArms=function(e){return(e=this.getAuxData(e)).level++,this.saveAndUpload(),e.level},i.prototype.gradeAuxLuck=function(e){return(e=this.getAuxData(e)).lucklevel++,this.saveAndUpload(),e.lucklevel},i.prototype.gradeAuxCapacity=function(e){this.getAuxData(e).capacitylevel++,this.saveAndUpload()},i.prototype.unlockAuxiliary=function(e){0==(e=this.getAuxData(e)).level&&(e.level=1,e.lucklevel=1,e.capacitylevel=1,o.completeTask(GameModel.TaskType.GetArms),this.saveAndUpload())},i.prototype.addLevelExtraReward=function(e){e=Math.ceil(e),this.gameLevelExtraReward+=e,this.saveAndUpload()},i.prototype.receiveOnlineReward=function(e){this.addGold(e),this.lastOnlineReceiveTime=Date.now(),this.gameLevelExtraReward=0,this.saveAndUpload()},i.prototype.changeSetting=function(e){e==GameModel.SettingType.Music?this.settingData.music?this.settingData.music=GameModel.SettingState.Closed:this.settingData.music=GameModel.SettingState.Opened:e==GameModel.SettingType.Effect?this.settingData.sound?this.settingData.sound=GameModel.SettingState.Closed:this.settingData.sound=GameModel.SettingState.Opened:e==GameModel.SettingType.KillVibrate&&(this.settingData.kill_vibrate?this.settingData.kill_vibrate=GameModel.SettingState.Closed:this.settingData.kill_vibrate=GameModel.SettingState.Opened),this.saveAndUpload()},i.prototype.resetShowPrivacyTime=function(){this.lastShowPrivacyTime=Date.now(),this.saveAndUpload()},i.prototype.saveGameArchive=function(){},i.prototype.clearGameArchive=function(){},new i);function i(){this.currLevel=1,this.gold=0,this.exp=0,this.star=0,this.stamina=0,this.staminaResumeTime=0,this.guideStep=Model.GuideStep.AttackEnd,this.signday=0,this.signgroup=0,this.lastsigntime=0,this.giftData={times:0,lastgettime:0},this.lastOnlineReceiveTime=0,this.gameLevelExtraReward=0,this.taskStartTime=0,this.receivedTaskList=[],this.completedTaskList=[],this.receiveStarTimes=0,this.coreGrade={type:0,level:1,lucklevel:1,capacitylevel:1},this.currAuxArms=0,this.auxArmsList=[],this.settingData={music:1,sound:1,kill_vibrate:1},this.lastShowPrivacyTime=0,this.gameArchive=null,this.lastLoginTime=0,this.lastGameTime=0}cc._RF.pop()},{}],GameInfo:[function(e,t){"use strict";function o(){this.isNewUser=!1,this.newArms=!1,this.launchTime=Date.now(),this.lastShowRewardVideoTime=0,this.lastShowFullVideoTime=0}cc._RF.push(t,"bca8dXcPgJPXYpHY/bMQ6mH","GameInfo"),window.GameInfo=(o.prototype.isShowTextButton=function(){return!GA.isPlatform([GA.Platform.ByteDance,GA.Platform.WeChat])},o.prototype.isShowNativedAd=function(){if(!G.underCheck){if(GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo]))return!0;if(G.isAndroid()&&GA.Info.distributionChannel==GA.DistributionChannel.OPPO)return!0}return!1},o.prototype.isShowNativeAdCheat=function(){return!(!ProjectConfig.AdConfig.AdCheatSwitch||G.underCheck)},o.prototype.checkShowFullVideo=function(){return!1},o.prototype.rewardVideoAdClosed=function(){this.lastShowRewardVideoTime=Date.now(),GameData.completeTask(GameModel.TaskType.PlayVideo)},o.prototype.shareSuccess=function(){},new o),cc._RF.pop()},{}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"4f81bOQ4ARF8KczVjaIVpsZ","GameManager");var i=e,n=o;Object.defineProperty(n,"__esModule",{value:!0});var a=i("AuxCannon"),r=i("PoolManager"),s=i("Recorder");function l(e){this.root=null,this.gameUI=null,this.gameNode=null,this.coreCannon=null,this.leftCannon=null,this.rightCannon=null,this.luckyCannon=null,this.gameTime=0,this.roundTime=0,this.levelInfo=null,this.currLevel=0,this.gameRound=0,this.attackRound=0,this.moveTimes=0,this.hitCount=0,this.maxHitCount=0,this.killCount=0,this.enemyTotal=0,this.enemyRoundTotalList=[],this.bulletSpeedRatio=0,this.bulletSpeedUpNeedTime=0,this.enemyMoveActionTime=0,this.atkTime=0,this.recorderManager=null,this.fightState=GameModel.FightState.Ready,this.gameState=GameModel.GameState.None,this.gameEndCallback=null,this.tipsLabelPool=null,this.showBloodTipsCount=0,this.gameUI=e,this.gameNode=e.gameNode,this.coreCannon=e.gameNode.coreCannon,this.leftCannon=e.gameNode.leftCannon,this.rightCannon=e.gameNode.rightCannon,window.GameManager=this,(l.instance=this).recorderManager=s.default.create(this),r.default.instance.initBulletPrefab(e.bulletPrefab)}Object.defineProperty(l.prototype,"eventLevel",{get:function(){return 10*this.currLevel+this.gameRound+1},enumerable:!1,configurable:!0}),l.prototype.initGame=function(e){var t=this;this.gameEndCallback=e,this.gameTime=0,GuideUtils.isAttackGuide?this.currLevel=0:this.currLevel=GameData.currLevel,this.gameRound=0,this.hitCount=0,this.killCount=0,this.enemyTotal=0,this.maxHitCount=0,this.enemyRoundTotalList.splice(0),this.leftCannon.disable(),this.rightCannon.disable(),this.recorderManager.initialize(),GameData.gameArchive&&(i=GameData.gameArchive,this.currLevel=i.level,this.gameRound=i.round,this.killCount=i.killCount),console.log("current level="+this.currLevel),this.levelInfo=GameConfig.getLevelInfo(this.currLevel);var o=GameData.getCoreArmsLevel(),i=(e=GameData.getCoreLuckLevel(),GameData.getCoreCapacityLevel());GuideUtils.isAttackGuide&&(o=e=i=GameData.currLevel),this.coreCannon.initialize(this,GameConfig.getCoreArmsInfo(o),e,i),this.gameNode.initialize(this),0<(e=GameConfig.usingAuxArms)&&(i=(r=GameData.getAuxData(e)).level,n=r.lucklevel,r=r.capacitylevel,0<GameConfig.trialAuxArms&&(i=n=GameData.currLevel,r=Math.min(10,GameData.currLevel)),e=GameConfig.getAuxiliaryArmsInfo(e,i),i>=GameConfig.GameConf.auxiliaryunlock.left&&this.leftCannon.initialize(this,e,n,r),i>=GameConfig.GameConf.auxiliaryunlock.right&&this.rightCannon.initialize(this,e,n,r),this.coreCannon.useAuxCannon(e),this.coreCannon.isOpenLucky&&(i=cc.instantiate(this.leftCannon.node),this.gameNode.node.addChild(i),this.luckyCannon=i.getComponent(a.default),this.luckyCannon.initialize(this,e,n,r,!0)));var n,r,s=0;this.levelInfo.enemy.forEach(function(e,o){for(var i=t.enemyRoundTotalList[o]=0;i<e.length;i++){var n=e[i];GameConfig.getEnemyInfo(n).enemytype!=GameModel.EnemyType.Produce&&(s++,t.enemyRoundTotalList[o]++)}console.log("round"+(o+1)+" enemy count = "+t.enemyRoundTotalList[o])}),this.enemyTotal=s,this.addEnemy(0),this.gameUI.refreshGameRound(this.levelInfo.round),this.gameUI.refreshLevelLabel(),this.initMap(),0<this.currLevel&&this.currLevel%5==0&&(n=GameModel.MapWidth/2-GameModel.BlockWidth/2,r=GameModel.MapHeight/2,this.playEffect(GameModel.EffectType.Boss,n,-r).zIndex=GameModel.MapRow+1)},l.prototype.initMap=function(){this.roundTime=0,this.attackRound=0,this.moveTimes=0,this.gameNode.initLevel(),this.gameUI.setFailTipsVisible(!1),this.gameUI.checkShowEnemyTips(),console.log("round =",this.levelInfo.round,", current round =",this.gameRound+1),G.pushEvent(Model.EventType.GameStart,{mode:"Wave number"},this.eventLevel)},l.prototype.createBullet=function(e){var t=r.default.instance.createBullet();return t.node.setPosition(e),this.gameUI.bulletNode.addChild(t.node),t},l.prototype.recoveryBullet=function(e){r.default.instance.recoveryBullet(e)},l.prototype.update=function(e){this.isGameRunning()&&(this.gameTime+=e,this.roundTime+=e,this.isEnemyMove()?(this.enemyMoveActionTime+=e,this.enemyMoveActionTime>=GameModel.MoveActionDuration&&this.checkGameOver()):this.isAttack()&&(this.atkTime+=e,this.atkTime>=GameModel.ShowBulletSpeedUpTime&&0==this.bulletSpeedRatio&&this.showSpeedUp(),0<this.bulletSpeedUpNeedTime&&(this.bulletSpeedUpNeedTime-=e,this.bulletSpeedUpNeedTime<=0&&this.showSpeedUp()),0<this.currLevel)&&(e=GameConfig.GameConf.recoverytime)&&this.atkTime>e&&this.gameUI.setRecoveryBtnVisible(!0))},l.prototype.showSpeedUp=function(){this.bulletSpeedRatio=GameModel.BulletMoveSpeedRatio,this.gameNode.showSpeedUp()},l.prototype.changeDirection=function(e){this.gameNode.changeDirection(e)},l.prototype.startFire=function(e){this.hitCount=0,this.startAttack(),this.gameNode.takeAimEnd(),this.coreCannon.startFire(e),this.luckyCannonStartFire(),this.recorderManager.start()},l.prototype.hitTarget=function(e){return(e=this.gameNode.hitTarget(e))&&(this.hitCount++,this.gameUI.refreshHitLabel(this.hitCount),this.coreCannon.calFieryDragonHurt(),0==this.bulletSpeedRatio&&(this.bulletSpeedUpNeedTime=2.6)),e},l.prototype.fireEnd=function(e){e.isAuxiliary||this.auxCannonStartFire()},l.prototype.reviveGame=function(){this.gameNode.reviveGame(),this.gameUI.setFailTipsVisible(!1),this.startGame()},l.prototype.useBuff=function(e,t){return!!this.isTakeAim()&&this.gameNode.useBuff(e,t)},l.prototype.recorderEnd=function(){this.recorderManager.stop()},l.prototype.auxCannonStartFire=function(){this.leftCannon.isEnable&&this.leftCannon.isReady()&&this.leftCannon.autoFire(),this.rightCannon.isEnable&&this.rightCannon.isReady()&&this.rightCannon.autoFire()},l.prototype.luckyCannonStartFire=function(){var e,t=this.coreCannon.shotRange;!this.luckyCannon||(e=this.gameNode.randomEmptyPosition())&&(this.luckyCannon.show(),this.luckyCannon.position=e,this.luckyCannon.updateWorldPos(),this.luckyCannon.randomFire(t))},l.prototype.allStopBulletMove=function(){this.coreCannon.stopBulletMove(),this.leftCannon.stopBulletMove(),this.rightCannon.stopBulletMove(),this.luckyCannon&&this.luckyCannon.stopBulletMove()},l.prototype.allCannonReady=function(){return!(!this.coreCannon.isReady()||this.leftCannon.isEnable&&!this.leftCannon.isReady()||this.rightCannon.isEnable&&!this.rightCannon.isReady()||this.luckyCannon&&!this.luckyCannon.isReady())},l.prototype.testingGameWin=function(){this.gameNode.clear(),this.checkGameWin()},l.prototype.updateAllBulletPathPoint=function(e){this.coreCannon.updateAllBulletPathPoint(e),this.leftCannon.isEnable&&this.leftCannon.updateAllBulletPathPoint(e),this.rightCannon.isEnable&&this.rightCannon.updateAllBulletPathPoint(e),this.luckyCannon&&this.luckyCannon.updateAllBulletPathPoint(e)},l.prototype.showTipsLabel=function(e,t,o,i,n,a){var r=this;this.tipsLabelPool||(this.tipsLabelPool=new cc.NodePool);var s=null,l=null;(l=0<this.tipsLabelPool.size()?(s=this.tipsLabelPool.get()).getComponent(cc.Label):(s=new cc.Node("node")).addComponent(cc.Label)).string=o,s.setPosition(e,t),s.scale=1,i?(s.color=i,l.font=this.gameUI.propHurtFont,l.fontSize=27):(s.color=cc.Color.WHITE,l.font=this.gameUI.hurtFont,l.fontSize=35),cc.Canvas.instance.node.addChild(s),n?cc.tween(s).by(1,{y:100}).call(function(){r.tipsLabelPool.put(s),a&&a()}).start():(n=ex.rand(1,40)-20,s.scale=0,cc.tween(s).by(.2,{x:n,y:40,scale:1.5},{easing:"circOut"}).by(.1,{y:20,scale:-.5}).by(.8,{y:60}).call(function(){r.tipsLabelPool.put(s),a&&a()}).start())},l.prototype.showBloodTips=function(e,t,o,i){var n=this;0<o?this.showTipsLabel(e,t,"+"+GA.formatNumber(o),i,!0):this.showBloodTipsCount<20&&(this.showBloodTipsCount++,this.showTipsLabel(e,t,""+GA.formatNumber(-o),i,!1,function(){n.showBloodTipsCount--}))},l.prototype.playEffect=function(e,t,o,i,n,a,s){return n?(t+=GameModel.BlockWidth*n/2,o+=GameModel.BlockWidth*n/2):(t+=GameModel.BlockWidth/2,o+=GameModel.BlockWidth/2),(s=r.default.instance.showEffect({parent:this.gameNode.node,type:e,x:t,y:o,delay:i,size:n,aniName:a,loop:s})).zIndex=GameModel.MapRow,s},l.prototype.playEffectWithNode=function(e,t,o,i,n){var a=GameModel.BlockWidth*o/2;return r.default.instance.showEffect({parent:e,type:t,x:a,y:a,size:o,loop:n,aniName:i})},l.prototype.hideEffect=function(e){r.default.instance.hideEffect(e)},l.prototype.startGame=function(){this.gameState=GameModel.GameState.Running,this.takeAim()},l.prototype.pauseGame=function(){this.gameState=GameModel.GameState.Pause},l.prototype.resumeGame=function(){this.gameState=GameModel.GameState.Running},l.prototype.isGameReady=function(){return this.gameState==GameModel.GameState.Ready},l.prototype.isGamePause=function(){return this.gameState==GameModel.GameState.Pause},l.prototype.isGameRunning=function(){return this.gameState==GameModel.GameState.Running},l.prototype.isGameEnd=function(){return this.gameState==GameModel.GameState.End},l.prototype.isTakeAim=function(){return this.isGameRunning()&&this.fightState==GameModel.FightState.TakeAim},l.prototype.isAttack=function(){return this.fightState==GameModel.FightState.Attack},l.prototype.isAttackEnd=function(){return this.fightState==GameModel.FightState.AttackEnd},l.prototype.isEnemyMove=function(){return this.fightState==GameModel.FightState.EnemyMove},l.prototype.fightReady=function(){this.fightState=GameModel.FightState.Ready},l.prototype.takeAim=function(){var e=this;this.fightState=GameModel.FightState.TakeAim,this.attackRound++,this.gameNode.calBeforeRoundBuff(),this.hitCount=0,this.gameUI.refreshHitLabel(this.hitCount),this.checkShowBackBuff(),GameConfig.AutomatedTesting&&(this.startAttack(),this.gameUI.scheduleOnce(function(){for(var t=e.gameNode.getDangerEnemy(),o=e.gameNode.worldPos.y-(GameModel.MapRow-3)*GameModel.BlockWidth,i=new Map,n=10;n<170;n++){var a,r,s=ex.convertToAngle(n+.5),l=e.gameUI.testCalcLine(s),c=!1;if(t)for(var d=0;d<l.length;d++){var h=l[d];if(h.hitPos<GameModel.WallPos.None&&h.point.y<o){c=!0;break}}else c=!0;c&&(a=l.length,(r=i.get(a))?r.push(s):i.set(a,[s]))}var u=0;i.forEach(function(e,t){u<t&&(u=t)});var p=i.get(u),f=p[ex.rand(0,p.length-1)];console.log("testing fire rotation=",ex.convertToRotation(f)),p=e.coreCannon,f=ex.pForAngle(f,ex.v2temp()).normalizeSelf(),f=p.worldPos.add(f.mulSelf(300),f),e.startFire(f)},.3))},l.prototype.startAttack=function(){this.fightState=GameModel.FightState.Attack,this.atkTime=0,this.bulletSpeedRatio=0,this.bulletSpeedUpNeedTime=0},l.prototype.enemyMove=function(){this.moveTimes++,this.fightState=GameModel.FightState.EnemyMove,this.enemyMoveActionTime=0,this.gameNode.enemyMove()},l.prototype.stopBulletMove=function(){this.allStopBulletMove(),this.checkGameWin()},l.prototype.addKill=function(){this.killCount++,this.gameUI.refreshLevelProgress(this.killCount,this.enemyRoundTotalList[this.gameRound])},l.prototype.addEnemy=function(e){0<e&&(this.enemyTotal+=e,this.enemyRoundTotalList[this.gameRound]+=e),this.gameUI.refreshEnemyCount(this.enemyTotal),this.gameUI.refreshLevelProgress(this.killCount,this.enemyRoundTotalList[this.gameRound])},l.prototype.checkShowBackBuff=function(){var e=this.gameNode.checkCanUseBackBuff();this.gameUI.setBackBuffVisible(e)},l.prototype.roundOver=function(e){e=e?Model.EventType.GameSuccess:Model.EventType.GameFailed,G.pushEvent(e,{mode:"Wave number",Duration:Math.round(this.roundTime)},this.eventLevel),console.log("Single wave time:",Math.round(this.roundTime))},l.prototype.checkGameOver=function(){var e;this.isGameRunning()&&this.isEnemyMove()&&(console.log("End of enemy movement"),this.gameNode.checkGameFail()?(this.roundOver(!1),this.gameover(!1)):(e=this.gameNode.checkShowGameFailTips(),this.gameUI.setFailTipsVisible(e),this.gameNode.calAfterRoundBuff(),this.gameNode.refreshEnemy(),this.gameNode.hasEnemy()?this.gameNode.hasVisibleEnemy()?(console.log("has visible enemy."),this.takeAim()):(console.log("no visible enemy."),this.fightReady(),this.gameNode.scheduleOnce(this.enemyMove.bind(this),.1)):this.nextRound()))},l.prototype.checkGameWin=function(){var e,t,o=this;this.allCannonReady()&&!this.isAttackEnd()&&(this.fightState=GameModel.FightState.AttackEnd,console.log("End of bullet attack"),this.gameUI.setRecoveryBtnVisible(!1),e=this.gameNode.calAfterAttackBuff(),this.gameNode.hasEnemy()&&(e+=this.coreCannon.calAuxiliaryRoundHurt()),t=function(){o.gameNode.hasEnemy()?o.enemyMove():o.nextRound(),o.recorderManager.pause()},0<e?this.gameUI.scheduleOnce(t,e):t())},l.prototype.nextRound=function(){var e,t,o=this;this.roundOver(!0),this.gameNode.enemyClear(),++this.gameRound<this.levelInfo.round?(this.gameUI.restoreBuffValidTimes(),e=GameModel.MapWidth/2-GameModel.BlockWidth/2,t=GameModel.MapHeight/2,this.playEffect(GameModel.EffectType.Round,e,-t).zIndex=GameModel.MapRow+1,this.fightReady(),setTimeout(function(){o.gameNode.roundClear(),o.initMap(),o.startGame()},1500),SoundManager.playSound(Model.AudioUrl.Round)):this.gameover(!0)},l.prototype.clear=function(){this.gameState=GameModel.GameState.None,this.coreCannon.clear(),this.leftCannon.clear(),this.rightCannon.clear(),this.gameNode.clear(),this.luckyCannon&&(this.luckyCannon.clear(),this.luckyCannon.node.destroy(),this.luckyCannon=null),r.default.instance.clear()},l.prototype.gameover=function(e){var t,o=this;console.log("game over",e),this.gameState!=GameModel.GameState.End&&(this.gameState=GameModel.GameState.End,setTimeout(function(){o.gameEndCallback&&o.gameEndCallback(e)},1500),GameData.clearGameArchive(),SoundManager.stopMusic(),t=e?Model.AudioUrl.Win:Model.AudioUrl.Lose,SoundManager.playSound(t))},l.instance=null,i=l,n.default=i,cc._RF.pop()},{}],GameModel:[function(e,t){"use strict";cc._RF.push(t,"61f9cPxfJZL6bvGIe+AhbZ9","GameModel");var o,i,n,a,r,s=t;(i=o=o||{}).CurrencyZIndex=999,i.GradeToastZIndex=i.CurrencyZIndex+1,i.SceneCoverZIndex=i.CurrencyZIndex+1,i.GuideHaveCoverZIndex=i.CurrencyZIndex+1,i.SceneTopZIndex=i.CurrencyZIndex+2,i.MovePathTipsDistance=700,i.MovePathTipsMinDistance=800,i.TaskValidTime=604800,i.RewardGoldLimitWechat=999,i.RewardGoldLimitApp=3,i.BulletMoveSpeed=1e3,i.ShowBulletSpeedUpTime=8,i.BulletMoveSpeedRatio=2,i.BulletAttackEndShowTime=1,i.AddCapacityLevelMax=10,i.SkillBuffLevelMax=25,i.FieryDragonBlockMoveTime=.08,i.BlockWidth=90,i.MapCol=7,i.MapRow=10,i.MapCount=i.MapCol*i.MapRow,i.MapWidth=i.BlockWidth*i.MapCol,i.MapHeight=i.BlockWidth*i.MapRow,i.LightningHurtRange=14,i.MoveDelayTime=.5,i.MoveDuration=.5,i.MoveActionDuration=i.MoveDelayTime+i.MoveDuration,i.FrozenRound=4,i.TwineRound=3,i.ContinueWin=[2,3,5,8,10],i.ContinueLose=[1,2,3,5,5,3,2],i.CoreArmsTabBarUnlockLevel=2,i.AuxArmsTabBarUnlockLevel=3,(r=i.WallPos||(i.WallPos={}))[r.None=100]="None",r[r.Left=101]="Left",r[r.Right=102]="Right",r[r.Top=103]="Top",r[r.Bottom=104]="Bottom",(a=i.EffectType||(i.EffectType={})).Guide="guide",a.Round="round",a.Boss="boss",a.Refresh="refresh",a.RefreshLayEggs="refresh_layeggs",a.Collide="collide",a.Dust="dust",a.Addition="addition",a.Multiplication="multiplication",a.AddCapacity="addcapacity",a.AddBullet="addbullet",a.SkillBuff="skillbuff",a.Coin="coin",a.Bomb="bomb",a.BombGround="bomb_ground",a.Recovery="recoveryhp",a.Knife="knife",a.KnifeLight="knife_light",a.BurnedBomb="burned_bomb",a.Burning="burning",a.Link="link",a.LinkShield="link_shield",a.Frozen="frozen",a.Twine="twine",a.Revive="revive",a.Poisoning="poisoning",a.Shield="shield",a.Cursed="cursed",a.FireBomb="bomb",a.HitBack="hit_back",a.Connect="connect",a.LightningX="lightning_x",a.LightningGridReady="lightning_grid_ready",a.LightningGrid="lightning_grid",a.FieryDragon="fiery_dragon",a.Die="die",a.DivideDie="divide_die",a.VineDie="vine_die",a.IceBreak="ice_break",a.RockBreak="rock_break",a.NoxiousBreak="noxious_break",a.ClearBomb="clear_bomb",(n=i.TaskType||(i.TaskType={}))[n.Login=1]="Login",n[n.KillEnemy=2]="KillEnemy",n[n.PlayGame=3]="PlayGame",n[n.GameWin=4]="GameWin",n[n.GradePlayer=5]="GradePlayer",n[n.GradeRole=6]="GradeRole",n[n.GradeArms=7]="GradeArms",n[n.UpgradeRoleAtkToLevel=8]="UpgradeRoleAtkToLevel",n[n.UpgradeRoleLuckToLevel=9]="UpgradeRoleLuckToLevel",n[n.UpgradeRoleCapacityToLevel=10]="UpgradeRoleCapacityToLevel",n[n.UpgradeAtkToLevel1=11]="UpgradeAtkToLevel1",n[n.UpgradeLuckToLevel1=12]="UpgradeLuckToLevel1",n[n.UpgradeCapacityToLevel1=13]="UpgradeCapacityToLevel1",n[n.UpgradeAtkToLevel2=14]="UpgradeAtkToLevel2",n[n.UpgradeLuckToLevel2=15]="UpgradeLuckToLevel2",n[n.UpgradeCapacityToLevel2=16]="UpgradeCapacityToLevel2",n[n.UpgradeAtkToLevel3=17]="UpgradeAtkToLevel3",n[n.UpgradeLuckToLevel3=18]="UpgradeLuckToLevel3",n[n.UpgradeCapacityToLevel3=19]="UpgradeCapacityToLevel3",n[n.UpgradeAtkToLevel4=20]="UpgradeAtkToLevel4",n[n.UpgradeLuckToLevel4=21]="UpgradeLuckToLevel4",n[n.UpgradeCapacityToLevel4=22]="UpgradeCapacityToLevel4",n[n.UpgradeAtkToLevel5=23]="UpgradeAtkToLevel5",n[n.UpgradeLuckToLevel5=24]="UpgradeLuckToLevel5",n[n.UpgradeCapacityToLevel5=25]="UpgradeCapacityToLevel5",n[n.GetArms=26]="GetArms",n[n.ReceiveOnline=27]="ReceiveOnline",n[n.CostGold=28]="CostGold",n[n.PlayVideo=29]="PlayVideo",n[n.CriticalHit=30]="CriticalHit",(s=i.TaskState||(i.TaskState={}))[s.Normal=0]="Normal",s[s.CanReceive=1]="CanReceive",s[s.Received=2]="Received",(r=i.CannonState||(i.CannonState={}))[r.Ready=1]="Ready",r[r.Attack=2]="Attack",r[r.FireEnd=3]="FireEnd",(a=i.BulletState||(i.BulletState={}))[a.Ready=1]="Ready",a[a.Move=2]="Move",a[a.Stop=3]="Stop",(n=i.BulletClassify||(i.BulletClassify={}))[n.None=0]="None",n[n.Shot=1]="Shot",n[n.Random=2]="Random",(r=s=i.BulletMoveType||(i.BulletMoveType={}))[r.None=0]="None",r[r.Rotation=1]="Rotation",(a=i.HurtAniState||(i.HurtAniState={}))[a.None=0]="None",a[a.Move=1]="Move",a[a.Scale=2]="Scale",a[a.End=3]="End",(r=n=i.ArmsType||(i.ArmsType={}))[r.None=0]="None",r[r.Count=1]="Count",r[r.Lucky=2]="Lucky",r[r.Noxious=3]="Noxious",r[r.Connect=4]="Connect",r[r.Curse=5]="Curse",r[r.Fire=6]="Fire",r[r.Frozen=7]="Frozen",r[r.Bomb=8]="Bomb",r[r.Lightning=9]="Lightning",r[r.Back=10]="Back",r[r.FieryDragon=11]="FieryDragon",(a=i.AuxUnlockType||(i.AuxUnlockType={}))[a.Level=1]="Level",a[a.Sign=2]="Sign",(r=i.LobbyShowType||(i.LobbyShowType={}))[r.None=0]="None",r[r.GradeRole=1]="GradeRole",r[r.GradeArms=2]="GradeArms",(a=i.SettingType||(i.SettingType={}))[a.Music=1]="Music",a[a.Effect=2]="Effect",a[a.KillVibrate=3]="KillVibrate",(r=i.SettingState||(i.SettingState={}))[r.Closed=0]="Closed",r[r.Opened=1]="Opened",(a=i.BuffType||(i.BuffType={}))[a.CoreArmsCount=1]="CoreArmsCount",a[a.TempAddCoreArmsCount=2]="TempAddCoreArmsCount",a[a.AuxArmsCount=3]="AuxArmsCount",a[a.AttackAdded=4]="AttackAdded",a[a.TempAddAttackAdded=5]="TempAddAttackAdded",a[a.CirticalHit=6]="CirticalHit",a[a.TempAddCirticalHit=7]="TempAddCirticalHit",a[a.CirticalHitHurt=8]="CirticalHitHurt",a[a.TempAddCirticalHitHurt=9]="TempAddCirticalHitHurt",a[a.ExpAdded=10]="ExpAdded",a[a.RewardAdded=11]="RewardAdded",a[a.SubAllHp=12]="SubAllHp",a[a.KillLowestHp=13]="KillLowestHp",a[a.Burned=14]="Burned",a[a.Poisoned=15]="Poisoned",a[a.FieryDagon=16]="FieryDagon",a[a.Knife=17]="Knife",a[a.Frozen=18]="Frozen",a[a.Cursed=19]="Cursed",a[a.Back=20]="Back",i.BuffCount=i.BuffType.Back,(r=i.EnemyClassify||(i.EnemyClassify={}))[r.Obstruct=0]="Obstruct",r[r.Animal=1]="Animal",(a=i.EnemyID||(i.EnemyID={})).F011="F011",a.F012="F012",a.F013="F013",a.F014="F014",a.F021="F021",a.F022="F022",a.F023="F023",a.F024="F024",a.F025="F025",a.F026="F026",a.F027="F027",a.F028="F028",a.F029="F029",a.S011="S011",a.S131="S131",a.S141="S141",(a=r=i.EnemyType||(i.EnemyType={}))[a.Produce=11]="Produce",a[a.Bomb=12]="Bomb",a[a.Obstruct=13]="Obstruct",a[a.Noxious=14]="Noxious",a[a.Triangle=15]="Triangle",a[a.Burned=16]="Burned",a[a.Detonator=17]="Detonator",a[a.Vine=18]="Vine",a[a.Ice=19]="Ice",a[a.Ordinary=21]="Ordinary",a[a.MoveDouble=22]="MoveDouble",a[a.RecoveryBlood=23]="RecoveryBlood",a[a.Divide=24]="Divide",a[a.LayEggs=25]="LayEggs",a[a.CrossRecovery=26]="CrossRecovery",a[a.Link=27]="Link",a[a.Revive=28]="Revive",a[a.Shield=29]="Shield",a[a.HalfHurt=30]="HalfHurt",a[a.Sprint=31]="Sprint",a[a.Invincible=32]="Invincible",a[a.DivideChild=33]="DivideChild",a[a.LayEggsChild=34]="LayEggsChild",(a=i.EnemySizeType||(i.EnemySizeType={}))[a.Normal=1]="Normal",a[a.Big=2]="Big",a[a.Boss=3]="Boss",(a=i.EnemyState||(i.EnemyState={}))[a.Ready=1]="Ready",a[a.Death=2]="Death",a[a.DelayClear=3]="DelayClear",i.ObstructAnimateList=[r.Noxious,r.Burned,r.Detonator,r.Vine,r.Ice],i.SmallEnemyList=[r.Vine,r.DivideChild,r.LayEggsChild,r.Ice],i.ObstructAliases=["mul","add","bomb","rock","noxious","triangle","burned","detonator","vine","ice"],i.AnimalAliases=["ordinary","move2","recovery","divide","layeggs","crossrecovery","link","revive","shield","halfhurt","sprint","invincible","dividesub","layeggssub"],i.FontColorRecovery=ex.hexToColor("#fef100"),i.FontColorNoxious=ex.hexToColor("#34e530"),i.FontColorCurse=ex.hexToColor("#d54aff"),i.FontColorFire=ex.hexToColor("#ff4c0d"),i.FontColorLightning=ex.hexToColor("#d3ffff"),i.FontColorOrdinary=ex.hexToColor("#ffec78"),i.BulletMoveAttributeList=[{movetype:s.None,offset:0,fadeTime:.15,stroke:18,particle:!1,spine:!1},{movetype:s.None,offset:0,fadeTime:.15,stroke:10,particle:!1,spine:!1},{movetype:s.Rotation,offset:10,fadeTime:.15,stroke:32,particle:!1,spine:!1},{movetype:s.None,offset:15,fadeTime:.17,stroke:36,particle:!0,spine:!1},{movetype:s.Rotation,offset:0,fadeTime:.15,stroke:32,particle:!1,spine:!1},{movetype:s.None,offset:0,fadeTime:.15,stroke:18,particle:!0,spine:!1},{movetype:s.Rotation,offset:10,fadeTime:.15,stroke:32,particle:!1,spine:!1},{movetype:s.None,offset:0,fadeTime:.15,stroke:24,particle:!0,spine:!1},{movetype:s.Rotation,offset:8,fadeTime:.15,stroke:32,particle:!1,spine:!1},{movetype:s.None,offset:24,fadeTime:.15,stroke:32,particle:!1,spine:!0},{movetype:s.None,offset:26,fadeTime:.17,stroke:32,particle:!1,spine:!1},{movetype:s.None,offset:0,fadeTime:.15,stroke:32,particle:!0,spine:!1}],i.AuxTrialProbabilityList=[[80,70,100,60,100],[70,60,50,50,20],[60,50,20,40,0],[50,40,0,30,0],[40,30,0,20,0],[30,20,0,10,0]],i.ArmsCount=n.FieryDragon,i.TipsList=[{title:"Reward claim tip",content:"The 7th day bonus gives you legendary weapons and lots of gold",level:1},{title:"Reward claim tips",content:"You can also get a lot of gold by hanging up offline",level:1},{title:"Upgrade prompt",content:"Upgrade the hero can be easier to pass",level:1},{title:"Upgrade prompt",content:"When the going gets tough, try upgrading your weapon",level:1},{title:"Upgrade prompt",content:"Prioritizing the damage of heroes or weapons is a good idea",level:1},{title:"Weapon skill tips",content:"Katana weapons can quickly defeat bloody monsters",level:2},{title:"Weapon skill tips",content:"The higher the katana weapon combo, the higher the draw damage",level:2},{title:"Weapon skill tips",content:"The ninja dart weapon summons ninjas to assist in combat",level:6},{title:"Weapon skill tips",content:"Ninja dart weapon Ninja location is random",level:6},{title:"Weapon skill tips",content:"Monsters hit with mushroom weapons are poisoned",level:11},{title:"Weapon skill tips",content:"The Meteor Hammer weapon deals batch damage to the same type",level:16},{title:"Weapon skill tips",content:"The doll weapon casts a curse on the monster",level:21},{title:"Weapon skill tips",content:"Cursed enemies who take damage will ascend",level:21},{title:"Weapon skill tips",content:"The explosive weapon will explode when it hits the monster",level:26},{title:"Weapon skill tips",content:"Monsters hit by the Ice Staff weapon will freeze with probability",level:1},{title:"Weapon skill tips",content:"Frozen monsters advance every 3 turns",level:1},{title:"Weapon skill tips",content:"The barrel weapon defeats the monster with a big explosion",level:31},{title:"Weapon skill tips",content:"The Lightning Hammer weapon releases X-shaped lightning when struck",level:36},{title:"Weapon skill tips",content:"Strike Axe weapon will likely repel vertical monsters",level:1},{title:"Monster character tips",content:"Blue Dragon advances 2 squares per turn",level:1},{title:"Monster character tips",content:"Mushroom Monster summons one mushroom boy per turn",level:1},{title:"Monster character tips",content:"Skull Monster automatically regenerates health every turn",level:1},{title:"Monster character tips",content:"The Nightmare Black Cat restores life to its surroundings when defeated",level:1},{title:"Monster character tips",content:"When the big tree people are defeated, they split into a group of little tree people",level:1},{title:"Monster character tips",content:"Black Magicians release protective shrouds on monsters",level:1},{title:"Monster character tips",content:"The White Mage's shield can withstand bullet damage",level:1},{title:"Monster character tips",content:"The White Mage's shield restores every turn",level:1},{title:"Monster character tips",content:"The White Mage's shield can be destroyed by multiple bullets",level:1},{title:"Hindrance characteristic suggestion",content:"Tangled monsters can only advance once every 2 turns",level:1},{title:"Hindrance characteristic suggestion",content:"Explosive barrels and poison POTS effectively weaken monsters",level:1},{title:"Victory condition tip",content:"Defeat all the monsters can pass",level:1},{title:"Failure condition prompt",content:"The game fails when the enemy breaks through the bottom",level:1}],i.GuideLevelEnemy="S011;S011;S011;S011;S011;S011;S011;S011;S011;S011;S023;S011|S031;S031;S031;S031;S061;S031;S061;S031;S031;S031;S061;S061;S031",i.GuideLevelPoint="2,9;3,9;4,9;5,9;6,9;2,8;6,8;2,7;6,7;2,6;3,6;6,6|2,10;6,10;3,9;5,9;1,8;4,8;7,8;3,7;5,7;2,6;3,6;5,6;6,6",i.GuideLevelHP="6000000;6000000;6000000;6000000;6000000;6000000;6000000;6000000;6000000;6000000;56000000;6000000|9900000;9900000;9900000;9900000;15000000;18000000;15000000;9900000;9900000;15000000;15000000;15000000;15000000",(n=i.FightState||(i.FightState={}))[n.Ready=0]="Ready",n[n.TakeAim=1]="TakeAim",n[n.Attack=2]="Attack",n[n.AttackEnd=3]="AttackEnd",n[n.EnemyMove=4]="EnemyMove",(i=i.GameState||(i.GameState={}))[i.None=0]="None",i[i.Ready=1]="Ready",i[i.Running=2]="Running",i[i.Pause=3]="Pause",i[i.End=4]="End",window.GameModel=o,cc._RF.pop()},{}],GameNode:[function(e,t,o){"use strict";cc._RF.push(t,"1a42fphSIFE4LH5MBj+jimT","GameNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("BuffNode"),h=n("AuxCannon"),u=n("CoreCannon"),p=n("Enemy");function f(){var e=null!==c&&c.apply(this,arguments)||this;return e.enemyPrefab=null,e.coreCannon=null,e.leftCannon=null,e.rightCannon=null,e.aniCover=null,e.iconSpeedUp=null,e.takeAimArrow=null,e.manager=null,e.worldPos=cc.v2(),e.worldPosRect={left:0,top:0,right:0,bottom:0},e.enemyIndex=0,e.allEnemies=[],e.levelPoints=[],e.skillBuffHurtList=[],e.randomAddCapacityPropNum=0,e.randomSkillBuffPropNum=0,e.hasDeathEnemy=!1,e.bShowAuxHurtAni=!1,e.bGotSkillBuff=!1,e.bRemoveBullet=!1,e.guideEffect=null,e.lightningEffectList=[],e.coinList=[],e.enemyPool=new cc.NodePool,e}n=(a=cc._decorator).ccclass,a=a.property,s(f,c=cc.Component),Object.defineProperty(f.prototype,"leftEnemyCount",{get:function(){for(var e=0,t=0;t<this.allEnemies.length;t++){var o=this.allEnemies[t];o.isAlive()&&!o.isProduce&&e++}return e},enumerable:!1,configurable:!0}),f.prototype.onLoad=function(){try{this.node.children[0].active=!1}catch(n){}this.iconSpeedUp.active=!1,this.iconSpeedUp.zIndex=GameModel.MapRow,this.takeAimArrow.active=!1,this.aniCover.active=!1,cc.tween(this.iconSpeedUp).repeatForever(cc.tween().to(.5,{scale:1.3}).to(.5,{scale:1})).start()},f.prototype.start=function(){this.node.convertToWorldSpaceAR(ex.v2temp(0,0),this.worldPos),console.log("GameNode world pos:",this.worldPos.x,this.worldPos.y),this.worldPosRect.left=Math.floor(this.worldPos.x),this.worldPosRect.top=Math.ceil(this.worldPos.y);var e=ex.v2temp(GameModel.MapWidth,-GameModel.MapHeight);this.node.convertToWorldSpaceAR(e,e),this.worldPosRect.right=Math.ceil(e.x),this.worldPosRect.bottom=Math.floor(e.y),console.log("game map world rightBottom:",this.worldPosRect.right,this.worldPosRect.bottom)},f.prototype.initialize=function(e){this.manager=e,this.takeAimArrow.active=!1,this.bShowAuxHurtAni=!1,this.bGotSkillBuff=!1,this.randomAddCapacityPropNum=0,this.randomSkillBuffPropNum=0,this.skillBuffHurtList.splice(0);for(var t,o=0;o<GameModel.ArmsCount;o++){var i=GameConfig.getAuxiliaryArmsInfo(o+1,this.manager.currLevel).hurt;this.skillBuffHurtList.push(i)}this.manager.currLevel<=5&&(t=GameModel.MapWidth/2-GameModel.BlockWidth/2,e=-(GameModel.MapHeight-GameModel.BlockWidth),this.guideEffect=this.manager.playEffect(GameModel.EffectType.Guide,t,e,0,0,null,!0))},f.prototype.initLevel=function(){this.enemyIndex=0,this.levelPoints.splice(0);for(var e=this.manager.levelInfo,t=this.manager.gameRound,o=e.points[t],i=e.enemy[t],n=e.hp[t],a=0;a<o.length;a++)this.levelPoints.push({x:o[a].x,y:o[a].y,enemy:i[a],hp:n[a]});this.levelPoints.sort(function(e,t){return e.y<t.y?1:e.y>t.y?-1:0}),this.refreshEnemy(),SoundManager.playSound(Model.AudioUrl.Appear)},f.prototype.refreshEnemy=function(){for(var e=GameModel.MapHeight,t=GameModel.BlockWidth,o=this.manager.levelInfo,i=this.manager.attackRound,n=this.manager.moveTimes,a=this.levelPoints,r=GameModel.MapRow+2,s=a.length;s--;){var l=a[s],c=l.x,d=l.y-n;r<d||(c=t*(c-1),d=t*((d=0<i&&d<r?r:d)-1)-e,0<i&&!this.blockIsEmpty(c,d)||(l=this.createEnemy(l.enemy,c,d,l.hp,o),0==i&&l.isReady()&&this.manager.playEffect(GameModel.EffectType.Refresh,c,d,0,l.info.size),a.splice(s,1)))}},f.prototype.createEnemy=function(e,t,o,i,n){var a,r=this.createEnemyPool();return r.index=this.enemyIndex,r.info=GameConfig.getEnemyInfo(e),r.fullHealthPoint=i,r.isProduce?r.isAddition?r.fullHealthPoint=n.add:r.isMultiplication&&(r.fullHealthPoint=n.mul,r.mulRatio=n.mul):(n=(n=null!=n?n:this.manager.levelInfo).per,2<=GameConfig.winTimes?(a=GameConfig.winTimes-2,a=Math.min(a,GameModel.ContinueWin.length-1),n+=GameModel.ContinueWin[a]):GameConfig.winTimes<=-2&&(a=Math.abs(GameConfig.winTimes)-2%GameModel.ContinueLose.length,n-=GameModel.ContinueLose[a]),r.fullHealthPoint=i*(n/100)),r.active=o<=0,r.position=ex.v2temp(t,o),r.initialize(),r.updateZIndex(),this.allEnemies.push(r),this.enemyIndex++,r},f.prototype.lateUpdate=function(){this.hasDeathEnemy&&(this.hasDeathEnemy=!1,this.manager.updateAllBulletPathPoint(null))},f.prototype.getEnemy=function(e){for(var t=0;t<this.allEnemies.length;t++){var o=this.allEnemies[t];if(o.index==e&&!o.isDie())return o}return null},f.prototype.sortEnemies=function(){this.allEnemies.sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:0})},f.prototype.hitTarget=function(e){for(var t=0;t<this.allEnemies.length;t++){var o=this.allEnemies[t];if(o.index==e&&o.isReady())return o}return null},f.prototype.getMoveValidHeight=function(e){if(e.isSprint){if(!e.isReady())return GameModel.BlockWidth;if(e.y==-GameModel.MapHeight)return 0}var t=GameModel.MapHeight;e.isSprint&&(t+=e.y+GameModel.BlockWidth);for(var o=e.x+e.info.size*GameModel.BlockWidth,i=0;i<this.allEnemies.length;i++){var n=this.allEnemies[i];if(n.isAlive())for(var a=n.willOccupyBlocks,r=0;r<a.length;r++){var s=a[r];s.y<e.targetPos.y&&s.x>=e.x&&s.x<o&&(s=e.targetPos.y-s.y,t=Math.min(s,t))}}return t-GameModel.BlockWidth},f.prototype.getBackValidHeight=function(e){if(e.targetPos.y>=-GameModel.BlockWidth*e.info.size)return 0;for(var t=GameModel.BlockWidth,o=Math.abs(e.targetPos.y),i=e.x+e.info.size*t,n=0;n<this.allEnemies.length;n++){var a=this.allEnemies[n];if(a.isAlive()&&a!=e&&a.y<0)for(var r=a.willOccupyBlocks,s=0;s<r.length;s++){var l=r[s];l.y>e.targetPos.y&&l.x>=e.x&&l.x<i&&(l=l.y-e.targetPos.y,o=Math.min(l,o))}}return o-e.info.size*t},f.prototype.randomLinkTarget=function(){for(var e=20;0<e;){var t=ex.rand(0,this.allEnemies.length-1);if((t=this.allEnemies[t]).isReady()&&!t.isLink&&!t.isBeLink&&!t.isProduce)return t;e--}return null},f.prototype.randomAddCapacityProp=function(){var e=this.randomEmptyPosition();return!!e&&(this.createEnemy(GameModel.EnemyID.F013,e.x,e.y,0),this.sortEnemies(),!0)},f.prototype.randomSkillBuffProp=function(){var e=this.randomEmptyPosition();return!!e&&(this.createEnemy(GameModel.EnemyID.F014,e.x,e.y,0),this.sortEnemies(),!0)},f.prototype.delayRemoveBullet=function(){var e=this;this.coreCannon.delayRemoveBullet(),this.leftCannon.delayRemoveBullet(),this.rightCannon.delayRemoveBullet(),this.manager.luckyCannon&&this.manager.luckyCannon.delayRemoveBullet(),this.scheduleOnce(function(){e.manager.checkGameWin()},GameModel.BulletAttackEndShowTime)},f.prototype.changeDirection=function(e){this.takeAimArrow.active=!0,e=e.sub(this.coreCannon.worldPos,ex.v2temp()).normalizeSelf(),e=ex.pToAngle(e),this.takeAimArrow.angle=ex.convertToRotation(e)-90},f.prototype.takeAimEnd=function(){this.bRemoveBullet=!1,this.takeAimArrow.active=!1,this.guideEffect&&(this.manager.hideEffect(this.guideEffect),this.guideEffect=null)},f.prototype.hasEnemy=function(){if(0<this.levelPoints.length)return!0;for(var e=this.allEnemies.length;e--;){var t=this.allEnemies[e];if(t.isAnimal&&t.isAlive())return!0}return!1},f.prototype.hasVisibleEnemy=function(){for(var e=this.allEnemies.length;e--;){var t=this.allEnemies[e];if(t.isAnimal&&t.isReady())return!0}return!1},f.prototype.topHasEnemy=function(){for(var e=2*GameModel.BlockWidth,t=this.allEnemies.length;t--;){var o=this.allEnemies[t];if(o.isAnimal&&o.isReady()&&o.y>=-e)return!0}return!1},f.prototype.convertToScenePoint=function(e,t){return(t=null!=t?t:cc.v2()).x=e.x+this.node.x+this.node.parent.x,t.y=e.y+this.node.y+this.node.parent.y,t},f.prototype.randomEmptyPosition=function(){for(var e=20;0<e;){var t=(o=ex.rand(0,GameModel.MapCount-1))%GameModel.MapCol,o=Math.floor(o/GameModel.MapCol),i=t*GameModel.BlockWidth,n=-(o+1)*GameModel.BlockWidth,a=!1;e:for(var r=this.allEnemies.length;r--;){var s=this.allEnemies[r];if(s.isDivide||s.isAlive())for(var l=s.moving?s.willOccupyBlocks:s.occupyBlocks,c=0;c<l.length;c++){var d=l[c];if(d.x==i&&d.y==n){a=!0;break e}}}if(!a)return ex.v2temp(i,n);e--}return null},f.prototype.getAutoFireEnemy=function(e){for(var t=1500,o=null,i=0;i<this.allEnemies.length;i++){var n,a=this.allEnemies[i];a.isDie()||a.isProduce||(n=ex.pDistance(e.position,a.position))<t&&(t=n,o=a)}return o},f.prototype.getDangerEnemy=function(){for(var e=-(GameModel.MapRow-3)*GameModel.BlockWidth,t=0;t<this.allEnemies.length;t++){var o=this.allEnemies[t];if(!o.isDie()&&!o.isProduce&&o.y<e)return o}return null},f.prototype.getArchiveData=function(){for(var e=GameModel.MapHeight,t=GameModel.BlockWidth,o=[],i=0,n=this.allEnemies.length;i<n;i++){var a,r,s=this.allEnemies[i];s.isDie()||(a=s.x/t+1,r=Math.round((s.y+e)/t)+1,o.push({enemy:s.info.id,x:a,y:r,hp:s.leftHealthPoint}))}return o},f.prototype.blockIsEmpty=function(e,t){for(var o=this.allEnemies.length;o--;){var i=this.allEnemies[o];if(i.isAlive())for(var n=i.willOccupyBlocks,a=0;a<n.length;a++){var r=n[a];if(r.x==e&&r.y==t)return!1}}return!0},f.prototype.randomLayeggsPosition=function(e){for(var t=[],o=-e/GameModel.BlockWidth,i=0;i<o*GameModel.MapCol;i++){var n=i%GameModel.MapCol,a=Math.floor(i/GameModel.MapCol);n*=GameModel.BlockWidth,a=-(a+1)*GameModel.BlockWidth,this.blockIsEmpty(n,a)&&t.push({x:n,y:a})}return 0<t.length?(e=t[ex.rand(0,t.length-1)],ex.v2temp(e.x,e.y)):null},f.prototype.enemyMove=function(){for(var e=this,t=0;t<this.allEnemies.length;t++){var o=this.allEnemies[t];o.targetPos.set(o.position)}var i=GameModel.BlockWidth,n=this.topHasEnemy(),a=this;for(t=0;t<this.allEnemies.length;t++)!function(t){var o=a.allEnemies[t];if(!o.isBeFrozen&&(o.isAlive()||o.isDelayClear())){var r=i*o.info.move;0<=o.y&&!n&&(r=2*i),t=a.getMoveValidHeight(o),0<(r=Math.min(r,t))&&(o.targetPos.y-=r,!o.active&&o.targetPos.y<=0&&o.show(),o.moving=!0,o.showHp(),o.move(r),cc.tween(o.node).delay(GameModel.MoveDelayTime).to(GameModel.MoveDuration,{y:o.targetPos.y}).call(function(){o.moving=!1,o.updateZIndex(),o.isProduce&&o.y<-GameModel.MapHeight&&o.die(),e.manager.checkGameOver()}).start())}}(t)},f.prototype.checkCollideEnemy=function(e,t){for(var o=this.allEnemies.length;o--;){var i=this.allEnemies[o];if(i.isReady()&&i.enemyType==t){var n=i.boundingBox;if(n.x=this.worldPos.x+i.x,n.y=this.worldPos.y+i.y,n.contains(e.position))return i}}},f.prototype.checkCanUseBackBuff=function(){for(var e=-4*GameModel.BlockWidth,t=0;t<this.allEnemies.length;t++)if(this.allEnemies[t].targetPos.y<=e)return!0;return!1},f.prototype.calBeforeRoundBuff=function(){var e=this;this.coreCannon.calBeforeRoundBuff(),this.randomAddCapacityPropNum<GameModel.AddCapacityLevelMax&&this.randomAddCapacityProp()&&this.randomAddCapacityPropNum++,this.randomSkillBuffPropNum<GameModel.SkillBuffLevelMax&&this.manager.attackRound%3==0&&this.randomSkillBuffProp()&&this.randomSkillBuffPropNum++;for(var t=0;t<this.allEnemies.length;t++){var o,i=this.allEnemies[t];i.isReady()&&(i.calBeforeRoundBuff(),i.isLink)&&(o=this.randomLinkTarget())&&o.beLink(i)}this.bGotSkillBuff&&(this.bGotSkillBuff=!1,this.manager.pauseGame(),d.default.show(function(t){e.manager.resumeGame();for(var o=0,i=t.length;o<i;o++){var n=t[o];n.selected&&e.useBuff(n.type,n.value)}e.checkGameWin()}))},f.prototype.calAfterRoundBuff=function(){for(var e=this.allEnemies.length;e--;)(t=this.allEnemies[e]).isDelayClear()&&(t.isDetonator?(this.detonatorBomb(t),this.playRangeEffect(t,GameModel.EffectType.Bomb,t.info.size)):t.isCrossRecovery&&this.crossRecovery(t));var t,o=!1;for(e=this.allEnemies.length;e--;)(t=this.allEnemies[e]).isReady()?(t.isLayEggs&&(o=!0),t.isMultiplication&&t.produceUsed&&t.die(),t.calAfterRoundBuff()):t.isDie()&&t.canRevive?t.revive():t.isDelayClear()&&t.die();o&&this.sortEnemies()},f.prototype.calAfterAttackBuff=function(){var e=this;this.coreCannon.calAfterAttackBuff(),this.hideSpeedUp();for(var t=this.allEnemies.length;t--;){var o=this.allEnemies[t];o.isReady()&&o.calAfterAttackBuff()}var i=0;this.lightningEffectList&&0<this.lightningEffectList.length&&(this.showLightningAttackEffect(),i=.5);var n=this.coinList.length,a=this;for(t=0;t<n;t++)!function(t){var o=a.coinList[t];o.zIndex=GameModel.MapRow;var i=o.position.x>GameModel.MapWidth/2?1:-1,n=.2*(o.position.y-a.coreCannon.y);cc.tween(o).delay(.03*t).bezierTo(.5,o.getPosition(),cc.v2(o.position.x+400*i,o.position.y-n),a.coreCannon.position).call(function(){e.manager.hideEffect(o)}).start()}(t);return this.coinList.splice(0),Math.max(i,.03*n)},f.prototype.checkShowGameFailTips=function(){return this.checkGameFail(-(GameModel.MapHeight-3*GameModel.BlockWidth))},f.prototype.checkGameFail=function(e){e=null!=e?e:-GameModel.MapHeight;for(var t=this.allEnemies.length;t--;){var o=this.allEnemies[t];if(!o.isProduce&&o.y<e)return!0}return!1},f.prototype.checkGameWin=function(){this.hasEnemy()?this.hasVisibleEnemy()||this.manager.enemyMove():this.manager.nextRound()},f.prototype.enemyBeKill=function(){this.hasDeathEnemy=!0,this.manager.isAttack()&&(this.bRemoveBullet||this.hasVisibleEnemy()||(this.bRemoveBullet=!0,this.delayRemoveBullet()))},f.prototype.addSkillBuff=function(e){this.bGotSkillBuff=!0,console.log("get skill buff.");var t=e.info.size*GameModel.BlockWidth;t=e.position.add(ex.v2temp(t/2,t/2)),t=this.manager.gameNode.convertToScenePoint(t,ex.v2temp()),Utils.showImageTips("tips/lbl_skillbuff",t.x,t.y)},f.prototype.showSpeedUp=function(){this.iconSpeedUp.active=!0},f.prototype.hideSpeedUp=function(){this.iconSpeedUp.active=!1},f.prototype.reviveGame=function(){for(var e=0;e<this.allEnemies.length;e++){var t=this.allEnemies[e];t.isDie()&&t.canRevive?t.revive():t.isDelayClear()&&t.die()}this.enemyBack(6)},f.prototype.useBuff=function(e,t){if(e==GameModel.BuffType.Back)return this.enemyBack(t),!0;if(e==GameModel.BuffType.CoreArmsCount)return this.coreCannon.addBulletCapacity(t),!0;if(e==GameModel.BuffType.TempAddCoreArmsCount)return this.coreCannon.addTemporaryBulletCapacity(t),!0;if(e==GameModel.BuffType.AuxArmsCount)return this.leftCannon.isEnable&&this.leftCannon.addBulletCapacity(t),this.rightCannon.isEnable&&this.rightCannon.addBulletCapacity(t),!0;if(e==GameModel.BuffType.AttackAdded)return this.coreCannon.addBulletAtk(t),!0;if(e==GameModel.BuffType.TempAddAttackAdded)return this.coreCannon.addTemporaryBulletAtk(t),!0;if(e==GameModel.BuffType.CirticalHit)return this.coreCannon.addCriticalHitPer(t),this.leftCannon.isEnable&&this.leftCannon.addCriticalHitPer(t),this.rightCannon.isEnable&&this.rightCannon.addCriticalHitPer(t),!0;if(e==GameModel.BuffType.TempAddCirticalHit)return this.coreCannon.addTemporaryCirticalHitPer(t),this.leftCannon.isEnable&&this.leftCannon.addTemporaryCirticalHitPer(t),this.rightCannon.isEnable&&this.rightCannon.addTemporaryCirticalHitPer(t),!0;if(e==GameModel.BuffType.CirticalHitHurt)return this.coreCannon.addCriticalHitHurt(t),this.leftCannon.isEnable&&this.leftCannon.addCriticalHitHurt(t),this.rightCannon.isEnable&&this.rightCannon.addCriticalHitHurt(t),!0;if(e==GameModel.BuffType.TempAddCirticalHitHurt)return this.coreCannon.addTemporaryCriticalHitHurt(t),this.leftCannon.isEnable&&this.leftCannon.addTemporaryCriticalHitHurt(t),this.rightCannon.isEnable&&this.rightCannon.addTemporaryCriticalHitHurt(t),!0;if(e==GameModel.BuffType.ExpAdded)GameConfig.levelExpAdded=t;else if(e==GameModel.BuffType.RewardAdded)GameConfig.levelRewardAdded=t;else{if(e==GameModel.BuffType.SubAllHp)return this.hitAllRatio(t),!0;if(e==GameModel.BuffType.KillLowestHp)return(t=this.getLowestHpEnemy())&&t.hit(t.fullHealthPoint),!0;if(e==GameModel.BuffType.Burned){var o=this.skillBuffHurtList[GameModel.ArmsType.Fire-1];return this.buffHitAll(e,o),!0}if(e==GameModel.BuffType.Poisoned)return o=this.skillBuffHurtList[GameModel.ArmsType.Noxious-1],this.buffHitAll(e,o),!0;if(e==GameModel.BuffType.Frozen)return this.buffHitAll(e,1),!0;if(e==GameModel.BuffType.FieryDagon)return o=this.skillBuffHurtList[GameModel.ArmsType.FieryDragon-1],0<(i=this.fieryDragon2Hurt(o))&&this.scheduleOnce(this.checkGameWin.bind(this),i),!0;var i;if(e==GameModel.BuffType.Knife)return o=this.skillBuffHurtList[GameModel.ArmsType.Count-1],0<(i=this.countHurt(o))&&this.scheduleOnce(this.checkGameWin.bind(this),i),!0;if(e==GameModel.BuffType.Cursed)return o=this.skillBuffHurtList[GameModel.ArmsType.Curse-1],this.curseTheLast(o),!0}return!1},f.prototype.enemyBack=function(e){for(var t=e*GameModel.BlockWidth,o=this,i=this.allEnemies.length;i--;)!function(e){var i;(i=o.allEnemies[e]).y<0&&i.isAlive()&&(e=o.getBackValidHeight(i),0<(e=Math.min(t,e))&&(i.targetPos.y+=e,i.moving=!0,cc.tween(i.node).to(.1,{y:i.targetPos.y}).call(function(){i.moving=!1,i.updateZIndex()}).start()))}(i)},f.prototype.addCoin=function(e){if(this.manager.isAttack()){var t=0;(i=ex.rand(1,100))<=10?t=1:i<=30?t=2:i<=60&&(t=3);for(var o=GameModel.BlockWidth,i=GameModel.BlockWidth*e.info.size,n=Math.round(.1*i),a=Math.round(.9*i);0<=--t;){var r=e.x+ex.rand(n,a)-o/2,s=e.y+ex.rand(n,a)-o/2;(r=this.manager.playEffect(GameModel.EffectType.Coin,r,s,0,0,null,!0)).zIndex=-s,this.coinList.push(r)}}},f.prototype.calBomb=function(e,t){var o=e.x,i=e.y,n=e.info.size;if(t==GameModel.EnemyID.F021)for(var a=0;a<n;a++){this.bomb(e,o+a*GameModel.BlockWidth,-1);for(var r=0;r<GameModel.MapRow;r++){var s=-GameModel.BlockWidth*(r+1),l=Math.abs(s-i)/GameModel.BlockWidth*.05;this.manager.playEffect(GameModel.EffectType.Bomb,o,s,l)}}else if(t==GameModel.EnemyID.F024)for(a=0;a<n;a++)for(this.bomb(e,-1,i+a*GameModel.BlockWidth),r=0;r<GameModel.MapCol;r++){var c=GameModel.BlockWidth*r;l=Math.abs(c-o)/GameModel.BlockWidth*.05,this.manager.playEffect(GameModel.EffectType.Bomb,c,i,l)}else if(t==GameModel.EnemyID.F027){var d=GameModel.BlockWidth,h=(t=e.info.size,e.x+t*d),u=e.y+t*d;for(a=this.allEnemies.length;a--;){var p=this.allEnemies[a];if(p&&p.isReady()&&!p.isProduce){var f=p.occupyBlocks;for(r=0;r<f.length;r++){var m=f[r];if(m.x>=e.x-d&&m.x<=h&&m.y>=e.y-d&&m.y<=u){p.bombHit(e.info.hurtper);break}}}}this.playRangeEffect(e,GameModel.EffectType.Bomb,t)}},f.prototype.bomb=function(e,t,o){for(var i=this.allEnemies.length;i--;){var n=this.allEnemies[i];if(n.isReady()&&!n.isProduce)for(var a=n.occupyBlocks,r=0;r<a.length;r++){var s=a[r];if(-1==t){if(o==s.y){n.bombHit(e.info.hurtper);break}}else if(-1==o&&t==s.x){n.bombHit(e.info.hurtper);break}}}},f.prototype.detonatorBomb=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.x+o*t,n=e.y+o*t,a=e.targetPos,r=0;r<this.allEnemies.length;r++){var s=this.allEnemies[r];if(s.isReady()&&!s.isProduce)for(var l=s.willOccupyBlocks,c=0;c<l.length;c++){var d=l[c];if(d.x>=a.x-t&&d.x<=i&&d.y>=a.y-t&&d.y<=n){s.bombHit(e.info.hurtper);break}}}},f.prototype.propPoisoning=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.x+o*t,n=e.y+o*t,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r!=e&&r.isReady()&&!r.isProduce)for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.x>=e.x-t&&c.x<=i&&c.y>=e.y-t&&c.y<=n){r.poisoningRatio(e.info.hurtper);break}}}this.playRangeEffect(e,GameModel.EffectType.NoxiousBreak,o),SoundManager.playSound(Model.AudioUrl.BuffPoisoning)},f.prototype.burned=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.x+o*t,n=e.y+o*t,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r!=e&&r.isReady()&&!r.isProduce)for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.x>=e.x-t&&c.x<=i&&c.y>=e.y-t&&c.y<=n){r.burnedRatio(e.info.hurtper);break}}}this.playRangeEffect(e,GameModel.EffectType.BurnedBomb,o)},f.prototype.twine=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.x+o*t,n=e.y+o*t,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r!=e&&r.isReady()&&!r.isVine&&!r.isProduce)for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.y>=e.y&&c.y<n&&(c.x==e.x-t||r.x==i)){r.beTwine(e);break}}}},f.prototype.frozen=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.x+o*t,n=e.y+o*t,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r!=e&&r.isReady()&&!r.isIce&&!r.isProduce)for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.y>=e.y&&c.y<n&&(c.x==e.x-t||r.x==i)){r.beFrozen();break}}}},f.prototype.divideEnemy=function(e){for(var t=e.occupyBlocks,o=0;o<t.length;o++){var i=t[o],n=Math.ceil(e.fullHealthPoint*(e.info.healper/100));this.createEnemy(GameModel.EnemyID.S131,i.x,i.y,n)}this.manager.addEnemy(t.length),this.sortEnemies()},f.prototype.layeggs=function(e){var t=Math.ceil(e.fullHealthPoint*(e.info.healper/100));(e=this.randomLayeggsPosition(e.y))&&(t=this.createEnemy(GameModel.EnemyID.S141,e.x,e.y,t),this.sortEnemies(),this.manager.playEffect(GameModel.EffectType.RefreshLayEggs,e.x,e.y,0,t.info.size),this.manager.addEnemy(1))},f.prototype.crossRecovery=function(e){for(var t=GameModel.BlockWidth,o=e.info.size,i=e.targetPos,n=i.x+o*t,a=i.y+o*t,r=0;r<this.allEnemies.length;r++){var s=this.allEnemies[r];if(s.isReady()&&!s.isProduce)for(var l=s.willOccupyBlocks,c=0;c<l.length;c++){var d=l[c];if(d.x>=i.x-t&&d.x<=n&&d.y>=i.y&&d.y<a){s.crossRecovery(e.info.healper);break}if(d.x>=i.x&&d.x<n&&d.y>=i.y-t&&d.y<=a){s.crossRecovery(e.info.healper);break}}}},f.prototype.countHurt=function(e){var t=this,o=0,i=GameModel.MapWidth/2-GameModel.BlockWidth/2,n=GameModel.MapHeight-+GameModel.BlockWidth;return this.aniCover.active=!0,this.bShowAuxHurtAni?(this.aniCover.zIndex=0,this.manager.playEffect(GameModel.EffectType.KnifeLight,i,-n),SoundManager.playSound(Model.AudioUrl.BuffCount),o=.3):(this.bShowAuxHurtAni=!0,o=1.5,this.aniCover.zIndex=GameModel.MapRow,this.manager.playEffect(GameModel.EffectType.Knife,i,-n),this.scheduleOnce(function(){t.aniCover.zIndex=0,t.manager.playEffect(GameModel.EffectType.KnifeLight,i,-n),SoundManager.playSound(Model.AudioUrl.BuffCount)},o-.3)),this.scheduleOnce(function(){t.aniCover.active=!1,e=Math.ceil(e/t.leftEnemyCount),t.hitAll(e)},o-.1),o},f.prototype.connectHurt=function(e,t){for(var o=this.allEnemies.length;o--;){var i=this.allEnemies[o];i!=t&&i.isReady()&&i.enemyType==t.enemyType&&(i.hit(e),i.beConnect(t))}},f.prototype.poisoning=function(e,t){for(var o=t.x-this.worldPos.x,i=t.y-this.worldPos.y,n=GameModel.BlockWidth,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r.isReady()&&!r.isProduce)for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.x+n>=o-n&&c.x<=o+n&&c.y+n>=i-n&&c.y<=i+n){r.poisoning(e);break}}}},f.prototype.curseHurt=function(e,t,o){for(var i=o,n=0;n<this.allEnemies.length;n++){var a=this.allEnemies[n];a.x==o.x&&a.isReady()&&!a.isProduce&&a.y>i.y&&(i=a)}i.hit(t,null,GameModel.FontColorCurse),this.manager.playEffect(GameModel.EffectType.Cursed,i.x,i.y,0,i.info.size),i.curse(e)},f.prototype.fireHurt=function(e,t,o){for(var i=[],n=GameModel.BlockWidth,a=Math.floor((o.x-this.worldPos.x)/n)*n,r=-Math.floor((this.worldPos.y-o.y)/n)*n,s=0;s<Math.pow(3,2);s++){var l=s%3,c=Math.floor(s/3);l=a+(l-1)*GameModel.BlockWidth,c=r+(c-1)*GameModel.BlockWidth,0<=l&&l<GameModel.MapWidth&&c>=-GameModel.MapHeight&&c<0&&ex.rand(1,8)<=3&&(this.manager.playEffect(GameModel.EffectType.FireBomb,l,c),i.push({x:l,y:c}))}if(SoundManager.playSoundSingle(Model.AudioUrl.BuffBurned),0<i.length)for(s=this.allEnemies.length;s--;){var d=this.allEnemies[s];if(d!=t&&d.isReady()&&!d.isProduce){var h=d.occupyBlocks;e:for(var u=0;u<h.length;u++)for(var p=h[u],f=0;f<i.length;f++){var m=i[f];if(p.x==m.x&&p.y==m.y){d.hit(e,null,GameModel.FontColorFire),d.burned(.18*e);break e}}}}t.burned(.18*e)},f.prototype.backHurt=function(e,t,o){t.hit(e),this.manager.playEffect(GameModel.EffectType.HitBack,t.x,t.y,0,t.info.size),SoundManager.playSound(Model.AudioUrl.HitBack);for(var i=[t],n=t.x+t.info.size*GameModel.BlockWidth,a=0;a<this.allEnemies.length;a++){var r=this.allEnemies[a];if(r.moving||r.targetPos.set(r.position),r.y>t.y&&r.isReady())for(var s=r.occupyBlocks,l=0;l<s.length;l++){var c=s[l];if(c.x>=t.x&&c.x<n){r.hit(e),i.push(r);break}}}var d=!1,h=this;for(a=i.length;a--;)!function(e){var t,n=i[e],a=GameModel.BlockWidth;e=h.getBackValidHeight(n),0<(a=Math.min(a,e))&&(t=null,d||(d=!0,t=o),n.targetPos.y+=a,n.moving=!0,cc.tween(n.node).to(.1,{y:n.targetPos.y}).call(function(){n.moving=!1,n.updateZIndex(),t&&t()}).start())}(a)},f.prototype.crossBomb=function(e,t){for(var o=GameModel.BlockWidth,i=t.info.size,n=t.x+i*o,a=t.y+i*o,r=0;r<this.allEnemies.length;r++){var s=this.allEnemies[r];if(s.isReady()&&!s.isProduce)for(var l=s.occupyBlocks,c=0;c<l.length;c++){var d=l[c];if(d.x>=t.x-o&&d.x<=n&&d.y>=t.y&&d.y<a){s.hit(e)&&this.crossBomb(e,s);break}if(d.x>=t.x&&d.x<n&&d.y>=t.y-o&&d.y<=a){s.hit(e)&&this.crossBomb(e,s);break}}}var h=t.x,u=t.y,p=i+2,f=p-1;for(r=0;r<Math.pow(p,2);r++){var m=r%p,g=Math.floor(r/p);(0!=m||0!=g&&g!=f)&&(m!=f||0!=g&&g!=f)&&(m=h+(m-1)*GameModel.BlockWidth,g=u+(g-1)*GameModel.BlockWidth,0<=m&&m<GameModel.MapWidth&&g>=-GameModel.MapHeight&&g<0&&this.manager.playEffect(GameModel.EffectType.Bomb,m,g))}},f.prototype.lightningHurt=function(e,t){this.manager.playEffect(GameModel.EffectType.LightningX,t.x,t.y),SoundManager.playSound(Model.AudioUrl.HitLightningX);for(var o=GameModel.BlockWidth,i=GameModel.LightningHurtRange/2,n=this.allEnemies.length;n--;){var a=this.allEnemies[n];if(a!=t&&a.isReady()&&!a.isProduce)for(var r=0;r<a.info.size*a.info.size;r++)for(var s=r%a.info.size,l=Math.floor(r/a.info.size),c=a.x+s*o,d=a.y+l*o,h=1;h<=i;h++){var u=h*o;(c==t.x+u&&d==t.y+u||c==t.x+u&&d==t.y-u||c==t.x-u&&d==t.y+u||c==t.x-u&&d==t.y-u)&&a.hit(e,null,GameModel.FontColorLightning)}}},f.prototype.powerGridHurt=function(e,t){for(var o=0;o<this.allEnemies.length;o++){var i=this.allEnemies[o];i.y==t.y&&i.isReady()&&!i.isProduce&&i.beElectrocuted(e)}this.showLightningReadyEffect(t.y)},f.prototype.fieryDragon1Hurt=function(e,t,o){var i,n=GameModel.BlockWidth;i=(o=o.x-this.worldPos.x)<=t.x?t.x:(o=Math.floor((o-t.x)/n),o=Math.min(o,t.info.size-1),t.x+o*n),n=-n*Math.ceil(GameModel.MapRow/2),this.manager.playEffect(GameModel.EffectType.FieryDragon,i,n,0,0,"danlong"),SoundManager.playSound(Model.AudioUrl.FieryDragon);for(var a=GameModel.FieryDragonBlockMoveTime,r=0;r<this.allEnemies.length;r++){var s=this.allEnemies[r];if(s.isReady()&&!s.isProduce)for(var l=s.occupyBlocks,c=0;c<l.length;c++)if(l[c].x==i){var d=(GameModel.MapRow-Math.abs(s.y)/GameModel.BlockWidth)*a;s.hitDelay(e,d,.18*e);break}}},f.prototype.fieryDragon2Hurt=function(e){for(var t=100,o=null,i=0;i<this.allEnemies.length;i++)(s=this.allEnemies[i]).isReady()&&!s.isProduce&&s.leftHealthPointPercent<t&&(t=s.leftHealthPointPercent,o=s);if(o){var n=GameModel.BlockWidth,a=o.x;3<=o.info.size&&(a=o.x+n);var r=-n*Math.ceil(GameModel.MapRow/2);this.manager.playEffect(GameModel.EffectType.FieryDragon,a,r,0,0,"shuanglong"),SoundManager.playSound(Model.AudioUrl.FieryDragon);var s,l=GameModel.FieryDragonBlockMoveTime,c=a-n,d=a+n;for(i=0;i<this.allEnemies.length;i++)if((s=this.allEnemies[i]).isReady()&&!s.isProduce)for(var h=s.occupyBlocks,u=0;u<h.length;u++){var p=h[u];if(p.x>=c&&p.x<=d){p=(GameModel.MapRow-Math.abs(s.y)/GameModel.BlockWidth)*l,s.hitDelay(e,p);break}}return l*(GameModel.MapRow+1)}return 0},f.prototype.getLowestHpEnemy=function(){for(var e=Number.MAX_VALUE,t=null,o=0,i=this.allEnemies.length;o<i;o++){var n=this.allEnemies[o];n.isReady()&&!n.isProduce&&n.leftHealthPoint<e&&(e=n.leftHealthPoint,t=n)}return t},f.prototype.curseTheLast=function(e){for(var t=[],o=0,i=this.allEnemies.length;o<i;o++){var n,a,r=this.allEnemies[o];!r.isReady()||r.isProduce||(!(a=t[n=r.x/GameModel.BlockWidth])||r.y>a.y)&&(t[n]=r)}t.forEach(function(t){t.curse(e)})},f.prototype.hitAll=function(e){for(var t=this.allEnemies.length;t--;){var o=this.allEnemies[t];o.isReady()&&o.hit(e)}},f.prototype.hitAllRatio=function(e){for(var t=this.allEnemies.length;t--;){var o=this.allEnemies[t];o.isReady()&&o.hitHpRatio(e)}},f.prototype.buffHitAll=function(e,t){for(var o=this.allEnemies.length;o--;){var i=this.allEnemies[o];i.isReady()&&!i.isProduce&&(e==GameModel.BuffType.Burned?i.burned(t):e==GameModel.BuffType.Poisoned?i.poisoning(t):e==GameModel.BuffType.Frozen&&i.beFrozenOneRound())}},f.prototype.playRangeEffect=function(e,t,o){for(var i=e.x,n=e.y,a=i+o*GameModel.BlockWidth/2,r=o+2,s=0;s<Math.pow(r,2);s++){var l=s%r,c=Math.floor(s/r),d=i+(l-1)*GameModel.BlockWidth;l=n+(c-1)*GameModel.BlockWidth,0<=d&&d<GameModel.MapWidth&&l>=-GameModel.MapHeight&&l<0&&(c=Math.abs(a-d)/GameModel.BlockWidth*.05,this.manager.playEffect(t,d,l,c))}},f.prototype.showLightningReadyEffect=function(e){var t,o,i=Math.ceil(-e/GameModel.BlockWidth);this.lightningEffectList[i]||(console.log("show lightning:",e,i),t=GameModel.EffectType.LightningGridReady,o=GameModel.MapWidth/2-GameModel.BlockWidth/2,e=this.manager.playEffect(t,o,e,0,0,null,!0),this.lightningEffectList[i]=e)},f.prototype.showLightningAttackEffect=function(){for(var e=GameModel.EffectType.LightningGrid,t=0;t<this.lightningEffectList.length;t++){var o,i=this.lightningEffectList[t];i&&(this.manager.hideEffect(i),this.lightningEffectList[t]=null,o=i.x-GameModel.BlockWidth/2,i=i.y-GameModel.BlockWidth/2,this.manager.playEffect(e,o,i),SoundManager.playSound(Model.AudioUrl.HitLightningGrid))}},f.prototype.createEnemyPool=function(){var e=0<this.enemyPool.size()?this.enemyPool.get().getComponent(p.default):p.default.create(this.enemyPrefab);return this.node.addChild(e.node),e},f.prototype.removeEnemy=function(e){this.recoveryEnemy(e);for(var t=0;t<this.allEnemies.length;t++)if(this.allEnemies[t]==e){this.allEnemies.splice(t,1);break}},f.prototype.recoveryEnemy=function(e){cc.director.getActionManager().removeAllActionsFromTarget(e.node,!0),this.enemyPool.put(e.node)},f.prototype.enemyClear=function(){var e=this;this.allEnemies.forEach(function(t){t.isDie()||t.isProduce||(e.manager.addKill(),e.manager.playEffect(GameModel.EffectType.ClearBomb,t.x,t.y,0,t.info.size).zIndex=GameModel.MapHeight),t.die()}),this.allEnemies.splice(0)},f.prototype.roundClear=function(){var e=this;this.lightningEffectList.forEach(function(t){e.manager.hideEffect(t)}),this.lightningEffectList.splice(0)},f.prototype.clear=function(){this.roundClear(),this.allEnemies.forEach(function(e){e.clear()}),this.allEnemies.splice(0),this.levelPoints.splice(0),this.enemyPool.clear()},l([a({type:cc.Prefab,tooltip:"EnemyPrefab"})],f.prototype,"enemyPrefab",void 0),l([a({type:u.default,displayName:"Main gun"})],f.prototype,"coreCannon",void 0),l([a({type:h.default,displayName:"Secondary gun port"})],f.prototype,"leftCannon",void 0),l([a({type:h.default,displayName:"Second gun right"})],f.prototype,"rightCannon",void 0),l([a({type:cc.Node,tooltip:"AniCover"})],f.prototype,"aniCover",void 0),l([a({type:cc.Node,tooltip:"IconSpeedUp"})],f.prototype,"iconSpeedUp",void 0),l([a({type:cc.Node,tooltip:"TakeAimArrow"})],f.prototype,"takeAimArrow",void 0),n=l([n],f),r.default=n,cc._RF.pop()},{}],GameOver:[function(e,t,o){"use strict";cc._RF.push(t,"5eccc8K9dlLl6H0QToLRf1n","GameOver");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("MatrixList"),h=n("RewardBox"),u=n("RewardGoldTips"),p=n("ShareNode");(a=c=c||{})[a.Normal=0]="Normal",a[a.Title=1]="Title",a[a.WinLight=2]="WinLight",a[a.Unfold=3]="Unfold",a[a.ZoomIn=4]="ZoomIn",a[a.ZoomOut=5]="ZoomOut",a[a.FadeIn=6]="FadeIn";var f,m=[{width:60,mul:2},{width:60,mul:3},{width:85,mul:4},{width:176,mul:5},{width:85,mul:4},{width:60,mul:3},{width:60,mul:2}];function g(){var e=null!==f&&f.apply(this,arguments)||this;return e.winSpine=null,e.content=null,e.winNode=null,e.loseNode=null,e.continueBtn=null,e.playerLevelLabel=null,e.playerLevelProgressBar=null,e.levelLabel=null,e.rewardLabel=null,e.multiplePoint=null,e.multipleBar=null,e.multipleLabel=null,e.gradeRoleNode=null,e.gradeArmsNode=null,e.playerLevelNode=null,e.gameUI=null,e.isWin=!1,e.gameLevel=0,e.maxHitCount=0,e.levelRewardGold=0,e.extraRewardGold=0,e.pointRange={min:0,max:0},e.direction=0,e.multiple=0,e.bShowPlayerLevelUp=!1,e.aniPause=!1,e.aniShownTime=0,e.winAniList=null,e.loseAniList=null,e.gradeTipsNodes=[],e.doubleClicked=!1,e}a=(n=cc._decorator).ccclass,n=n.property,s(g,f=cc.Component),g.prototype.onLoad=function(){console.log("GameOver onLoad."),this.pageName="settlement",this.gameUI||(this.node.active=!1),(t=this.node.getChildByName("watermark"))&&(t.width=187*(cc.winSize.width/187+2),t.height=184*(cc.winSize.height/184+2),cc.tween(t).repeatForever(cc.tween().to(15,{x:-187,y:-184}).to(0,{x:0,y:0})).start()),this.pointRange.min=-this.multipleBar.width/2,this.pointRange.max=this.multipleBar.width/2,this.addTipsItem(this.gradeRoleNode),this.addTipsItem(this.gradeArmsNode),this.playerLevelNode=this.playerLevelProgressBar.node.parent,this.winAniList=[{name:"win_light",aniMode:c.WinLight},{name:"win_title",aniMode:c.Title,interval:1},{name:"win_cup",aniMode:c.ZoomIn},{node:this.levelLabel.node,aniMode:c.Normal},{node:this.playerLevelNode,aniMode:c.FadeIn},{name:"win_tips_lbl",aniMode:c.Normal,interval:.1},{name:"over_tips_bg",aniMode:c.Unfold},{node:this.rewardLabel.node.parent,aniMode:c.ZoomOut,duration:.2},{name:"multiple_bar",aniMode:c.FadeIn},{name:"multiple_point",aniMode:c.FadeIn},{node:this.multipleLabel.node.parent,aniMode:c.FadeIn,interval:0},{node:this.continueBtn.node,aniMode:c.Normal}];var e=this.gradeTipsNodes[0],t=this.gradeTipsNodes[1];this.loseAniList=[{name:"lose_title",aniMode:c.Title,interval:1},{node:this.playerLevelNode,aniMode:c.FadeIn},{name:"win_tips_lbl",aniMode:c.Normal,interval:.1},{name:"over_tips_bg",aniMode:c.Unfold},{node:this.rewardLabel.node.parent,aniMode:c.ZoomOut,duration:.2},{name:"lose_grade_lbl",aniMode:c.Normal,interval:.1},{node:this.gradeRoleNode,aniMode:c.Unfold,interval:0},{node:this.gradeArmsNode,aniMode:c.Unfold},{node:e.icon,aniMode:c.ZoomOut,interval:0},{node:t.icon,aniMode:c.ZoomOut},{node:e.light,aniMode:c.Normal,interval:0},{node:t.light,aniMode:c.Normal},{node:e.tips,aniMode:c.FadeIn,interval:0},{node:t.tips,aniMode:c.FadeIn,interval:0},{node:e.goto,aniMode:c.FadeIn,interval:0},{node:t.goto,aniMode:c.FadeIn},{name:"btn_continue_lose",aniMode:c.Normal},{node:this.continueBtn.node,aniMode:c.Normal}],this.initAniList(this.winNode,this.winAniList),this.initAniList(this.loseNode,this.loseAniList),GameInfo.isShowTextButton()||this.continueBtn.loadSubpackageImage("prefab/btn_continue"),ProjectConfig.AdConfig.MatrixListSwitch&&AdManager.preloadMatrixCustomAd()},g.prototype.addTipsItem=function(e){var t=e.getChildByName("light"),o=e.getChildByName("icon"),i=e.getChildByName("tips_lbl");e=e.getChildByName("grade_button"),this.gradeTipsNodes.push({light:t,icon:o,tips:i,goto:e}),cc.tween(t).repeatForever(cc.tween().by(6,{angle:360})).start()},g.prototype.initAniList=function(e,t){for(var o=.1,i=0;i<t.length;i++){var n=t[i];n.beginTime=o;var a=n.interval;o+=a||0==a?a:.3,n.node||(n.node=e.getChildByName(n.name))}},g.prototype.hide=function(){this.node.active=!1},g.prototype.gameEnd=function(e){var t=this;this.isWin=e,this.gameLevel=GameData.currLevel,this.node.active=!0,this.winNode.active=e,this.loseNode.active=!e,e||(GameConfig.lastLoseLevel=this.gameLevel);var o=this.gameUI.manager;GameData.completeTaskAddTimes(GameModel.TaskType.KillEnemy,o.killCount),GameData.completeTask(GameModel.TaskType.PlayGame);var i=o.killCount/o.enemyTotal,n=(i=Math.min(i,1),o.levelInfo);GameData.addExp(n.exp*i*(1+GameConfig.levelExpAdded/100)),GameConfig.levelExpAdded=0,o=GameConfig.playerLevel,GameConfig.refreshPlayerLevel(),n=GameConfig.playerLevel,this.bShowPlayerLevelUp=!1,o<n&&(this.bShowPlayerLevelUp=!0,GameData.completeTask(GameModel.TaskType.GradePlayer)),e?(0<=GameConfig.winTimes?GameConfig.winTimes++:GameConfig.winTimes=0,GameData.addStamina(GameConfig.GameConf.enduranceconsume,!0),GameData.completeTaskSetTimes(GameModel.TaskType.GameWin,this.gameLevel)):GameConfig.winTimes<=0?GameConfig.winTimes--:GameConfig.winTimes=0,GameConfig.playTimes++,e?(this.content.active=!1,this.winSpine.node.active=!0,this.winSpine.setAnimation(0,"animation",!1),this.winSpine.setCompleteListener(function(){var e=t.gameLevel;GameConfig.AutomatedTesting||e%5!=3&&e%5!=0?t.showShare():h.default.show(t.showShare.bind(t))}),SoundManager.playSound(Model.AudioUrl.WinFlag)):this.scheduleOnce(this.showShare.bind(this)),this.levelLabel.string=this.gameLevel+"Level",n=GameConfig.getCoinCostInfo(this.gameLevel),this.levelRewardGold=n.winreward*(1+GameConfig.levelRewardAdded/100),GameConfig.levelRewardAdded=0,GameData.addGold(this.levelRewardGold),GameData.addLevelExtraReward(n.rewardextras*i),e?(this.direction=1,this.multiplePoint.x=0,this.multiple=5,this.rewardLabel.node.parent.y=-7,this.playerLevelNode.y=140,this.refreshMultipleLabel(),n=GameConfig.getCoinCostInfo(this.gameLevel),this.extraRewardGold=n.winreward):(this.direction=0,this.multiple=0,this.extraRewardGold=0,this.rewardLabel.node.parent.y=240,this.playerLevelNode.y=400,this.rewardLabel.string="x"+GA.formatNumber(this.levelRewardGold)),G.enterPage({page:this.pageName,existBanner:!e,existVideo:e}),GameConfig.AutomatedTesting&&this.scheduleOnce(function(){console.log("next level"),t.close(),e?t.gameUI.onNextLevel():t.gameUI.onReplayGame()},2)},g.prototype.showShare=function(){var e=this.gameUI.manager;e.maxHitCount>this.maxHitCount&&G.isByteDanceKwaigame()?(this.maxHitCount=e.maxHitCount,p.default.show(e.maxHitCount,this.showUI.bind(this))):this.showUI()},g.prototype.showUI=function(){this.content.active=!0,this.winSpine.node.active=!1,this.refreshLevelProgress(),this.hideAllContent(this.isWin?this.winNode:this.loseNode),this.schedule(this.onAniUpdate,.1),this.isWin&&!G.isLongScreen()?AdManager.hideBannerWithTimes():AdManager.showBannerWithTimes()},g.prototype.refreshLevelProgress=function(){this.playerLevelLabel.string=""+GameConfig.playerLevel;for(var e=GameData.exp,t=0,o=0,i=GameConfig.MainArms.length;o<i;o++){var n=GameConfig.MainArms[o];if(e<=(t+=n.exp)){n=(n.exp-(t-e))/n.exp,this.playerLevelProgressBar.progress=n;break}}t<e&&(this.playerLevelProgressBar.progress=1)},g.prototype.hideAllContent=function(e){this.aniShownTime=0,this.rewardLabel.node.parent.active=this.continueBtn.node.active=!1,this.playerLevelNode.active=!1,e.children.forEach(function(e){e.active=!1}),this.isWin||this.gradeTipsNodes.forEach(function(e){e.goto.active=e.icon.active=e.light.active=e.tips.active=!1})},g.prototype.onAniUpdate=function(e){var t=this;if(!this.aniPause){this.aniShownTime+=e;for(var o=this.isWin?this.winAniList:this.loseAniList,i=0;i<o.length;i++){var n=o[i];n.node&&this.aniShownTime>=n.beginTime&&n.node.isValid&&!n.node.active&&(n.node.active=!0,n.aniMode==c.WinLight?this.playWinLightAni(n):n.aniMode==c.Title?this.playTitleAni(n):n.aniMode==c.ZoomIn?this.playZoomInAni(n):n.aniMode==c.ZoomOut?this.playZoomOutAni(n):n.aniMode==c.Unfold?this.playUnfoldAni(n):n.aniMode==c.FadeIn&&this.playFadeInAni(n),this.bShowPlayerLevelUp&&n.node==this.playerLevelNode&&(this.aniPause=!0,this.scheduleOnce(function(){t.gameUI.levelUp.show(function(){t.aniPause=!1})},.8)))}this.continueBtn.node.active&&(console.log("stop aimation update"),this.unschedule(this.onAniUpdate))}},g.prototype.playTitleAni=function(e){var t=e.node;e=t.y,t.scale=1.3,t.y-=200,cc.tween(t).to(.2,{scale:1},{easing:"backOut"}).delay(.2).to(.4,{y:e}).to(.1,{scale:1.2}).to(.4,{scale:1},{easing:"bounceOut"}).start()},g.prototype.playWinLightAni=function(e){(e=e.node).scale=1,e.opacity=255,cc.tween(e).to(.3,{scale:6}).to(.2,{opacity:0}).start()},g.prototype.playZoomInAni=function(e){var t=e.node;t.scale=0,e=null!==(e=e.duration)&&void 0!==e?e:.4,cc.tween(t).to(e,{scale:1},{easing:"backOut"}).start()},g.prototype.playZoomOutAni=function(e){var t=e.node;t.scale=3,e=null!==(e=e.duration)&&void 0!==e?e:.4,cc.tween(t).to(e,{scale:1},{easing:"backOut"}).start()},g.prototype.playUnfoldAni=function(e){var t=e.node;t.scaleY=0,e=null!==(e=e.duration)&&void 0!==e?e:.4,cc.tween(t).to(e,{scaleY:1},{easing:"elasticOut"}).start()},g.prototype.playFadeInAni=function(e){var t=e.node;t.opacity=0,e=null!==(e=e.duration)&&void 0!==e?e:.3,cc.tween(t).to(e,{opacity:255}).start()},g.prototype.update=function(e){if(0!=this.direction){var t=this.multiplePoint,o=this.pointRange;if(e=this.direction*e*800,(e=t.x+e)>=o.max)this.direction=-1,t.x=o.max+(o.max-e);else if(e<=o.min)this.direction=1,t.x=o.min+(o.min-e);else for(var i=(t.x=e)+o.max,n=0,a=0;a<m.length;a++)if(i<=(n+=m[a].width)){this.multiple=m[a].mul,this.refreshMultipleLabel();break}}},g.prototype.refreshMultipleLabel=function(){this.multipleLabel.string="x"+this.multiple;var e=this.levelRewardGold+this.extraRewardGold*this.multiple;this.rewardLabel.string="x"+GA.formatNumber(e)},g.prototype.close=function(){this.node.active=!1,this.unschedule(this.onAniUpdate),G.closePage({page:this.pageName}),AdManager.hideBannerWithTimes()},g.prototype.onGradeRoleClick=function(){GA.clickEvent(this.pageName,"Upgrade hero","other"),this.close(),this.gameUI.onBackHome(GameModel.LobbyShowType.GradeRole),SoundManager.playSound(Model.AudioUrl.Click)},g.prototype.onGradeArmsClick=function(){GA.clickEvent(this.pageName,"Upgrade weapons","other"),this.close(),this.gameUI.onBackHome(GameModel.LobbyShowType.GradeArms),SoundManager.playSound(Model.AudioUrl.Click)},g.prototype.onBackHomeClick=function(){GA.clickEvent(this.pageName,"Continue the game","other"),this.backHome(),ProjectConfig.AdConfig.MatrixListSwitch?d.default.show():G.isOPPO()?G.underCheck||AdManager.showGamePortalAd():AdManager.showInterstitialAd(),SoundManager.playSound(Model.AudioUrl.Click)},g.prototype.backHome=function(){this.node.active&&(this.close(),this.gameUI.onBackHome())},g.prototype.onDoubleClick=function(){var e=this;this.doubleClicked||(this.doubleClicked=!0,this.direction=0,this.scheduleOnce(function(){e.doubleClicked=!1,G.rewardOperation(e.pageName,"Double the settlement bonus",function(){GameConfig.showGoldAni=!0,e.requestReward(),e.backHome()})},.3))},g.prototype.requestReward=function(){var e=this.extraRewardGold*this.multiple;GameData.addGold(e),u.default.show(e+this.levelRewardGold)},l([n({type:sp.Skeleton,tooltip:"spine"})],g.prototype,"winSpine",void 0),l([n({type:cc.Node,tooltip:"content"})],g.prototype,"content",void 0),l([n({type:cc.Node,tooltip:"Winnode"})],g.prototype,"winNode",void 0),l([n({type:cc.Node,tooltip:"Losenode"})],g.prototype,"loseNode",void 0),l([n({type:cc.Sprite,tooltip:"continuebutton"})],g.prototype,"continueBtn",void 0),l([n({type:cc.Label,tooltip:"playerLevellabel"})],g.prototype,"playerLevelLabel",void 0),l([n({type:cc.ProgressBar,tooltip:"PlayerLevelProgressBa"})],g.prototype,"playerLevelProgressBar",void 0),l([n({type:cc.Label,tooltip:"levelLabel"})],g.prototype,"levelLabel",void 0),l([n({type:cc.Label,tooltip:"Rewardlabel"})],g.prototype,"rewardLabel",void 0),l([n({type:cc.Node,tooltip:"multipleicon"})],g.prototype,"multiplePoint",void 0),l([n({type:cc.Node,tooltip:"multipleBar"})],g.prototype,"multipleBar",void 0),l([n({type:cc.Label,tooltip:"multiplelabel"})],g.prototype,"multipleLabel",void 0),l([n({type:cc.Node,tooltip:"gradeRolenode"})],g.prototype,"gradeRoleNode",void 0),l([n({type:cc.Node,tooltip:"GradeArmsNode"})],g.prototype,"gradeArmsNode",void 0),a=l([a],g),r.default=a,cc._RF.pop()},{}],GameUI:[function(e,t,o){"use strict";cc._RF.push(t,"e1b90/rohdEk4SdmmEZANaD","GameUI");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("LobbyNode"),u=n("PrivacyNode"),p=n("DoubleHit"),f=n("EnemyTips"),m=n("GameManager"),g=n("GameNode"),y=n("GameOver"),v=n("GraphicsDottedLine"),b=n("LevelUp"),A=n("Revive");function P(){var e=null!==c&&c.apply(this,arguments)||this;return e.gamePrefab=null,e.bulletPrefab=null,e.cover=null,e.doorSpine=null,e.loadProgressBar=null,e.tipsLabel=null,e.background=null,e.gameBg=null,e.topCover=null,e.bulletNode=null,e.failTipsNode=null,e.graphicsDottedLine=null,e.graphics=null,e.hurtFont=null,e.propHurtFont=null,e.attackSpineMat=null,e.attackSpriteMat=null,e.levelLabel=null,e.enemyCountLabel=null,e.hitProgressBar=null,e.doubleHit=null,e.iconTrialMaxlv=null,e.btnBuffBack=null,e.recoveryBtn=null,e.roundNodeList=[],e.enemyTips=null,e.revive=null,e.gameOver=null,e.levelUp=null,e.manager=null,e.gameNode=null,e.backBuffTimes=0,e.reviveTimes=0,e.tempEnd=cc.v2(),e.tempDirection=cc.v2(),e.pathPoints=[],e.touchPos=cc.v2(),e.bTouchBegan=!1,e.bOpenOffset=!1,e}n=(a=cc._decorator).ccclass,a=a.property,s(P,c=cc.Component),(d=P).prototype.onLoad=function(){this.pageName="In the game",console.log("GameUI onLoad."),d.instance=this;var e=cc.view.getCanvasSize();console.log("canvas size:",e.height,e.width,e.height/e.width);var t=cc.Canvas.instance;e.height/e.width<1.5?(t.fitHeight=!0,t.fitWidth=!1,this.node.setContentSize(cc.winSize)):(t.fitHeight=!1,t.fitWidth=!0),cc.director.getPhysicsManager().enabled=!0,cc.macro.ENABLE_MULTI_TOUCH=!1,this.initSprite()},P.prototype.start=function(){this.initTouchListener()},P.prototype.initSprite=function(){var e=Utils.getSafeAreaTop();G.isLongScreen()&&e<115&&(e=115),this.topCover.node.y=this.node.height/2+272-(e+160),this.gameBg.node.y=this.topCover.node.y-272+GameModel.BlockWidth-10,this.cover.active=!1,this.cover.zIndex=GameModel.SceneCoverZIndex,this.doorSpine.node.active=!1,this.doorSpine.node.zIndex=this.cover.zIndex,this.loadProgressBar.node.active=!1,this.recoveryBtn.active=!1,this.btnBuffBack.active=!1,this.enemyTips.hide(),this.revive.hide(),this.gameOver.hide(),this.failTipsNode.active=!1,cc.tween(this.failTipsNode).repeatForever(cc.tween().to(.7,{opacity:0}).to(.7,{opacity:255})).start(),GuideUtils.showStep==Model.GuideStep.None?(GameConfig.trialAuxArms=GameModel.ArmsType.Count,this.onStartGame()):GameData.gameArchive?this.onStartGame():this.showHome(),!G.isOPPOVivo()||!G.underCheck&&ex.isToday(GameData.lastShowPrivacyTime)||(u.default.show(),GameData.resetShowPrivacyTime())},P.prototype.initTouchListener=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchDown,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},P.prototype.showHome=function(e){h.default.show(e)},P.prototype.update=function(e){this.manager&&this.manager.update(e),this.loadProgressBar.node.active&&(e=this.loadProgressBar.progress,1<(e+=.03)&&(e=0),this.loadProgressBar.progress=e)},P.prototype.onRecoveryClick=function(){this.manager&&this.manager.isAttack()&&(this.manager.stopBulletMove(),GA.clickEvent(this.pageName,"Recycle","other")),SoundManager.playSound(Model.AudioUrl.Click)},P.prototype.onBuffBackClick=function(){var e=this;G.rewardOperation(this.pageName,"Go back 3 Spaces",function(){e.manager.useBuff(GameModel.BuffType.Back,3)?(e.backBuffTimes=1,e.btnBuffBack.active=!1):G.showToast({title:"The current status operation is invalid. Please wait until the turn is over"})})},P.prototype.refreshLevelLabel=function(){this.levelLabel.string="Level"+this.manager.currLevel},P.prototype.refreshHitLabel=function(e){this.doubleHit.refreshHitLabel(e)},P.prototype.refreshEnemyCount=function(e){this.enemyCountLabel.string=""+e},P.prototype.refreshLevelProgress=function(e,t){for(var o=this.manager.gameRound,i=this.manager.levelInfo.round,n=this.manager.enemyRoundTotalList,a=e,r=0;r<n.length;r++)r<o&&(a-=n[r]);this.hitProgressBar.progress=+o/i+a/(t*i)},P.prototype.refreshGameRound=function(e){var t=this.hitProgressBar.node,o=t.width;2==e?this.roundNodeList[1].x=t.x:3==e&&(this.roundNodeList[1].x=t.x-o/2+o/3);for(var i=this.roundNodeList.length,n=0;n<i;n++)this.roundNodeList[n].active=n+1<=e},P.prototype.checkShowEnemyTips=function(){var e=this.manager;(e=GameConfig.getEnemyTipsInfo(e.currLevel,e.gameRound+1))&&this.enemyTips.show(e)},P.prototype.setBackBuffVisible=function(e){0==this.backBuffTimes&&0<this.manager.currLevel&&(this.btnBuffBack.active=e)},P.prototype.setRecoveryBtnVisible=function(e){this.recoveryBtn.active!=e&&(this.recoveryBtn.active=e)},P.prototype.setFailTipsVisible=function(e){this.failTipsNode.active=e},P.prototype.restoreBuffValidTimes=function(){this.reviveTimes=0,this.backBuffTimes=0},P.prototype.showAttackGuide=function(e){var t=this,o=this.gameNode.coreCannon.node.getBoundingBoxToWorld();o.origin=cc.v2(o.origin.x-200,o.origin.y-80+180),o.size=cc.size(o.size.width+400,o.size.height+160),GuideUtils.showAttack(o,function(){var o=ex.convertToAngle(e?53:90);o=ex.pForAngle(o).normalizeSelf(),t.gameNode.coreCannon.worldPos.add(o.mulSelf(1e3),t.touchPos),t.manager.startFire(t.touchPos),GuideUtils.destroy(),G.pushEvent(Model.LoginLogType.HomeStartGame)})},P.prototype.showLoadTipsLabel=function(){this.tipsLabel.node.active=!0,this.loadProgressBar.node.active=!0;for(var e,t=[],o=this.loadProgressBar.progress=0;o<GameModel.TipsList.length;o++)GameModel.TipsList[o].level>=GameData.currLevel&&t.push(GameModel.TipsList[o].content);0<t.length?(e=t[ex.rand(0,t.length-1)],this.tipsLabel.string=e):this.tipsLabel.string=""},P.prototype.hideLoadTipsLabel=function(){this.tipsLabel.node.active=!1,this.loadProgressBar.node.active=!1},P.prototype.initGameManager=function(){var e;return this.manager||((e=cc.instantiate(this.gamePrefab)).setPosition(-e.width/2,-GameModel.BlockWidth),this.gameNode=e.getComponent(g.default),this.gameBg.node.addChild(e),this.gameNode.node.setSiblingIndex(0),this.manager=new m.default(this),this.gameOver.gameUI=this),this.manager.root=this.gameNode.node,this.manager},P.prototype.initGameScene=function(){var e=this;this.manager.initGame(function(t){t||0!=e.reviveTimes?e.showGameOver(t):(e.reviveTimes=1,e.revive.showWithCallback(function(o){o?(e.playMusic(),e.manager.reviveGame()):e.showGameOver(t)}))}),this.manager.startGame(),this.playMusic(),this.showCustomAd(),G.enterPage({page:this.pageName,existVideo:!0}),G.pushEvents([{eventId:Model.LoginLogType.PlayGame},{eventId:Model.EventType.GameStart,detail:{mode:"Level"},extraNum:this.manager.currLevel}])},P.prototype.playMusic=function(){},P.prototype.clearMap=function(){this.reviveTimes=0,this.backBuffTimes=0,this.manager.clear()},P.prototype.showCustomAd=function(){var e;G.isLongScreen()&&(e=GA.PA.getSystemInfoSync(),AdManager.showCustomAd({tag:Model.AdTag.HorizontalList,style:{top:e.screenHeight-100,left:(e.screenWidth-230)/2}}))},P.prototype.hideCustomAd=function(){AdManager.hideCustomAd(Model.AdTag.HorizontalList)},P.prototype.refreshUI=function(){var e=GameConfig.getCurrentScene();this.gameBg.loadSubpackageImage("game/scene"+e+"_bg"),this.topCover.loadSubpackageImage("game/scene"+e+"_top"),this.cover.active=!0,this.iconTrialMaxlv.active=0<GameConfig.trialAuxArms,this.failTipsNode.active=!1,this.refreshHitLabel(0)},P.prototype.roleMove=function(e){this.hideLoadTipsLabel();var t=this.gameNode.coreCannon.spine;t.setAnimation(0,"zoulu",!0);var o=""+GameConfig.usingAuxArms;t.setAttachment("weapon",o),o=t.node.y,t.node.y=o-300,cc.tween(t.node).to(2,{y:o}).call(e).start(),this.manager.leftCannon.spine.setAttachment("weapon","yincang"),this.manager.rightCannon.spine.setAttachment("weapon","yincang"),e=this.cover,cc.tween(e).to(1.5,{opacity:0}).start(),(e=d.instance.doorSpine).node.active=!0,e.setAnimation(0,"kaimen",!1)},P.prototype.onStartGame=function(){var e=this;GameConfig.resetBuffUseTimes(),this.initGameManager(),this.refreshUI(),this.roleMove(function(){e.cover.active=!1,e.doorSpine.node.active=!1,e.initGameScene(),GuideUtils.isAttackGuide&&e.showAttackGuide(!0)})},P.prototype.onNextLevel=function(){this.refreshLevelLabel(),this.initGameScene()},P.prototype.onReplayGame=function(){},P.prototype.onBackHome=function(e){this.showHome(e)},P.prototype.showGameOver=function(e){window.adManager&&window.adManager.showInterstitial(),console.log("showGameOver: ",e?"true":"false"),this.clearMap(),GuideUtils.isAttackGuide?this.onBackHome():(this.gameOver.gameEnd(e),e&&GameData.passLevel()),this.manager.recorderEnd(),this.hideCustomAd(),e=e?Model.EventType.GameSuccess:Model.EventType.GameFailed,G.pushEvents([{eventId:Model.LoginLogType.GameOver},{eventId:e,detail:{mode:"Level",Duration:Math.round(this.manager.gameTime)},extraNum:this.manager.currLevel}]),G.closePage({page:this.pageName})},P.prototype.calcLine=function(e,t,o,i){var n,a,r,s=t.sub(e,this.tempDirection).normalizeSelf(),l=ex.pToAngle(s);0==o&&!this.manager.coreCannon.checkIsValidAngle(l)||(r=Math.min(i-o,1e3),t.x=e.x+r*Math.cos(l),t.y=e.y+r*Math.sin(l),n=cc.director.getPhysicsManager().rayCast(e,t,cc.RayCastType.Closest),a=GameModel.WallPos.None,n&&0<n.length&&(l=(r=n[0]).point,a=r.collider.tag,t=l,r=ex.v2temp(r.normal),r=s.sub(r.mulSelf(2*s.dot(r)),this.tempEnd),l.add(r.mulSelf(1e3),this.tempEnd)),this.pathPoints.push({point:t,hitPos:a}),0<n.length&&a!=GameModel.WallPos.Bottom&&(o+=ex.pDistance(e,t),e=t,t=this.tempEnd,this.calcLine(e,t,o,i)))},P.prototype.testCalcLine=function(e){this.pathPoints.splice(0),ex.pForAngle(e,this.tempDirection);var t=this.manager.coreCannon.worldPos;return e=t.add(this.tempDirection.mulSelf(1500),this.tempEnd),this.calcLine(t,e,0,3e3),this.pathPoints},P.prototype.drawLine=function(){this.pathPoints.splice(0),this.tempEnd.set(this.touchPos);var e=this.manager.coreCannon.worldPos,t=this.tempEnd,o=GameModel.MovePathTipsDistance;this.calcLine(e,t,0,o),o=this.graphicsDottedLine.graphics,this.graphicsDottedLine.clear(),o.lineWidth=6,o.lineJoin=cc.Graphics.LineJoin.MITER,o.lineCap=cc.Graphics.LineCap.ROUND,o.strokeColor=ex.hexToColor("#FFFFFF"),this.graphicsDottedLine.moveTo(e.x,e.y);for(var i=0;i<this.pathPoints.length;i++){var n=this.pathPoints[i];this.graphicsDottedLine.lineTo(n.point)}this.graphicsDottedLine.stroke()},P.prototype.onTouchDown=function(e){this.manager&&this.manager.isTakeAim()&&(e=e.touch.getLocation(),this.bOpenOffset=!1,this.bTouchBegan=!0,e.y<this.manager.gameNode.worldPosRect.bottom+GameModel.BlockWidth&&(e.y+=GameModel.BlockWidth,this.bOpenOffset=!0),this.touchPos.set(e),this.manager.changeDirection(this.touchPos),console.log("---------touch point:",this.touchPos.x,this.touchPos.y),this.drawLine())},P.prototype.onTouchMove=function(e){this.bTouchBegan&&this.manager&&this.manager.isTakeAim()&&(e=e.touch.getLocation(),this.bOpenOffset&&(e.y+=GameModel.BlockWidth),this.touchPos.set(e),this.manager.changeDirection(this.touchPos),this.drawLine())},P.prototype.onTouchEnd=function(){this.bTouchBegan&&this.manager&&this.manager.isTakeAim()&&0<this.pathPoints.length&&this.manager.startFire(this.touchPos),this.graphicsDottedLine.clear(),this.bTouchBegan=!1},P.prototype.onTouchCancel=function(){this.graphicsDottedLine.clear(),this.bTouchBegan=!1},l([a({type:cc.Prefab,tooltip:"GamePrefab"})],P.prototype,"gamePrefab",void 0),l([a({type:cc.Prefab,tooltip:"BulletPrefab"})],P.prototype,"bulletPrefab",void 0),l([a({type:cc.Node,tooltip:"GameCover"})],P.prototype,"cover",void 0),l([a({type:sp.Skeleton,tooltip:"doorSpine"})],P.prototype,"doorSpine",void 0),l([a({type:cc.ProgressBar,tooltip:"LoadProgressBar"})],P.prototype,"loadProgressBar",void 0),l([a({type:cc.Label,tooltip:"Tipslabel"})],P.prototype,"tipsLabel",void 0),l([a({type:cc.Node,tooltip:"background"})],P.prototype,"background",void 0),l([a({type:cc.Sprite,tooltip:"gameBg"})],P.prototype,"gameBg",void 0),l([a({type:cc.Sprite,tooltip:"TopCover"})],P.prototype,"topCover",void 0),l([a({type:cc.Node,tooltip:"BulletNode"})],P.prototype,"bulletNode",void 0),l([a({type:cc.Node,tooltip:"Fail Tips Node"})],P.prototype,"failTipsNode",void 0),l([a({type:v.default,tooltip:"graphicsDottedLine"})],P.prototype,"graphicsDottedLine",void 0),l([a({type:cc.Graphics,tooltip:"graphics"})],P.prototype,"graphics",void 0),l([a({type:cc.BitmapFont,tooltip:"hurtFont"})],P.prototype,"hurtFont",void 0),l([a({type:cc.BitmapFont,tooltip:"PropHurtFont"})],P.prototype,"propHurtFont",void 0),l([a({type:cc.Material,tooltip:"AttackSpineMatspine"})],P.prototype,"attackSpineMat",void 0),l([a({type:cc.Material,tooltip:"AttackSpriteMat"})],P.prototype,"attackSpriteMat",void 0),l([a({type:cc.Label,tooltip:"levellabel"})],P.prototype,"levelLabel",void 0),l([a({type:cc.Label,tooltip:"EnemyCountLabel"})],P.prototype,"enemyCountLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"HitProgressBar"})],P.prototype,"hitProgressBar",void 0),l([a({type:p.default,tooltip:"DoubleHitlabel"})],P.prototype,"doubleHit",void 0),l([a({type:cc.Node,tooltip:"iconTrialMaxlv"})],P.prototype,"iconTrialMaxlv",void 0),l([a({type:cc.Node,tooltip:"btnBuffBack"})],P.prototype,"btnBuffBack",void 0),l([a({type:cc.Node,tooltip:"RecoveryBtn"})],P.prototype,"recoveryBtn",void 0),l([a({type:cc.Node,tooltip:"RoundNodeList"})],P.prototype,"roundNodeList",void 0),l([a({type:f.default,tooltip:"EnemyTips"})],P.prototype,"enemyTips",void 0),l([a({type:A.default,tooltip:"Revive"})],P.prototype,"revive",void 0),l([a({type:y.default,tooltip:"GameOver"})],P.prototype,"gameOver",void 0),l([a({type:b.default,tooltip:"LevelUp"})],P.prototype,"levelUp",void 0),n=d=l([n],P),r.default=n,cc._RF.pop()},{}],GiftNode:[function(e,t,o){"use strict";cc._RF.push(t,"68f2daNakxLeIowxNH8zuMU","GiftNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.rewardLabel=null,e.btnReceive=null,e.rewardGold=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(){c.beginLoading.call(this)&&cc.resources.load("prefab/GiftNode",cc.Prefab,function(e,t){e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))})},Object.defineProperty(u,"fileName",{get:function(){return"GiftNode"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),l([a({type:cc.Label,tooltip:"Rewardlabel"})],u.prototype,"rewardLabel",void 0),l([a({type:cc.Button,tooltip:"Get"})],u.prototype,"btnReceive",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],GlobalDefine:[function(e,t){"use strict";cc._RF.push(t,"8c79bKs1S1JTrMD5Svml/kQ","GlobalDefine");var o=window.G=(i.prototype.check=function(){console.log("G is ok.")},i.prototype.init=function(){this.requestUrl="https://game.17tcw.com/default",this.isPreview||(GA.PA.onShow(function(){console.log("\u56de\u5230\u524d\u53f0")}),GA.PA.onHide(function(){console.log("\u5207\u5230\u540e\u53f0"),o.uid&&(GameData.save(),GameData.upload())}))},i.prototype.initGA=function(e){var t=this,i="",n=null,a=null,r=!1;"undefined"!=typeof GPC?(console.log("GPC:",JSON.stringify(GPC)),i=GPC.appid,a=GPC.uuid,(n=GPC.platform)==GA.Platform.Default&&(this.isPreview=!(r=!0))):(i="wx9c5776661654520b",r=this.isPreview=!0),GA.init({isPreview:r,debugLog:!1,engine:GA.EngineType.CocosCreator,appId:i,platform:n,uuid:a,channelKey:ProjectConfig.AppChannel,resolution:{width:720,height:1280},sharePath:ProjectConfig.AppChannel+"=001",withoutRewardVideoAd:r,uploadGameTimeIntervals:30}).then(function(){console.log("GA init success."),t.init(),console.log('appId is "'+GA.Info.appId+'"'),console.log('Channel is "'+GA.Info.channelId+'"'),console.log("scene is "+GA.Info.scene),console.log("distributionChannel is "+GA.Info.distributionChannel),console.log("Server UUID : "+a+", UnderCheck:"+GA.Info.underCheck),console.log("SystemInfo: "+JSON.stringify(GA.PA.getSystemInfoSync())),console.log("LaunchOptions: "+JSON.stringify(GA.PA.getLaunchOptionsSync()));var o,i="",n="",r="";t.isWeChat()?(i="adunit-747c78e93ac5ef11",n="adunit-753abab1508bc95a",r="adunit-",(o=new Map).set(Model.AdTag.SingleCustom,"adunit-ab0623a83545128a"),o.set(Model.AdTag.HorizontalList,"adunit-417ae171b0cbdcf7"),o.set(Model.AdTag.MatrixList,"adunit-34d3ff607274f0eb"),AdManager.initCustomAd(o)):t.isByteDance()?(i="kl78ed930e6abja3dm",n="kc4i3fkedb0clhde5h",r="cl42l28gjem7cmlk4m",RecorderManager.init()):t.isKwaigame()?(i="",n="2300002291_01",r="2300002291_02",RecorderManager.init()):t.isOPPO()?(i="452536",n="452540",AdManager.initNativeAd("452538"),AdManager.initGamePortalAd("452546"),AdManager.initGameBannerAd("452549")):t.isVivo()?(i="fdaf00382e0c4b03aca80454e73bb5f6",n="4535d97666d7486d98f7077f0c6f6354",r="2c9f567fa5524b4cb9b2f273721ec6a8",AdManager.initNativeAd("ef623527f343479ca115f76e852af906"),AdManager.initGameBannerAd("dbbcb57e80104c24a1b0afa625549658")):t.isNative()&&ex.listenerOnError(),i&&AdManager.initBannerAd(i),n&&AdManager.initRewardVideoAd(n),r&&AdManager.initInterstitialAd(r),e&&e()}).catch(function(i){console.log("GA init failed. "+i),o.showModal({title:"Tips",content:"If the configuration fails to be obtained, click Retry",showCancel:!1,confirmText:"Retry",success:function(){t.initGA(e)}})})},Object.defineProperty(i.prototype,"underCheck",{get:function(){return GA.Info.underCheck},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"appId",{get:function(){return GA.Info.appId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"openId",{get:function(){return GA.Info.openId},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"uid",{get:function(){return""+GA.Info.uid},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"channel",{get:function(){return GA.Info.channelId},enumerable:!1,configurable:!0}),i.prototype.setOpenId=function(e){GA.Info.openId=e},i.prototype.isWeChat=function(){return GA.isPlatform(GA.Platform.WeChat)},i.prototype.isByteDance=function(){return GA.isPlatform(GA.Platform.ByteDance)},i.prototype.isKwaigame=function(){return GA.isPlatform(GA.Platform.Kwaigame)},i.prototype.isOPPO=function(){return GA.isPlatform(GA.Platform.OPPO)},i.prototype.isVivo=function(){return GA.isPlatform(GA.Platform.Vivo)},i.prototype.isQQ=function(){return GA.isPlatform(GA.Platform.QQ)},i.prototype.isM4399MiniGame=function(){return GA.isPlatform(GA.Platform.M4399MiniGame)},i.prototype.isAndroid=function(){return GA.isPlatform(GA.Platform.Android)},i.prototype.isAndroidOPPO=function(){return this.isAndroid()&&GA.Info.distributionChannel==GA.DistributionChannel.OPPO},i.prototype.isByteDanceKwaigame=function(){return GA.isPlatform([GA.Platform.ByteDance,GA.Platform.Kwaigame])},i.prototype.isOPPOVivo=function(){return GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])},i.prototype.isiOS=function(){return GA.isPlatform(GA.Platform.iOS)},i.prototype.isNative=function(){return GA.isPlatform([GA.Platform.iOS,GA.Platform.Android])},i.prototype.pushEvent=function(e,t,o){this.pushEvents([{eventId:e,detail:t,extraNum:o}])},i.prototype.pushEvents=function(e){var t;this.isPreview||(t=[],e.forEach(function(e){t.push({eventId:e.eventId,detail:e.detail?JSON.stringify(e.detail):null,extraNum:e.extraNum||0})}),GA.sentLogs(e))},i.prototype.enterPage=function(e){GA.enterPage(e),(e=(e=GA.Info.pageList)[e.length-2])&&e.page==Model.PageName.Lobby&&AdManager.hideCustomAd(Model.AdTag.SingleCustom)},i.prototype.closePage=function(e){GA.closePage(e),(e=(e=GA.Info.pageList)[e.length-1])&&e.page==Model.PageName.Lobby&&MSGEvent.sendEvent(MSGEvent.SHOW_SINGLECUSTOM)},i.prototype.randomShare=function(e,t,o,i){GA.randomShare({tag:t,page:e,result:function(e){e&&e.reward?(AdManager.refreshRewardScoreStrategy(t),GameInfo.shareSuccess(),o&&o()):i&&i()}})},i.prototype.rewardOperation=function(e,t,o,i,n){var a=this;GA.clickEvent(e,t,"video",n),GA.isNextRewardVideo(t)?AdManager.showVideoAd(e,t,o,i,function(){!a.underCheck&&a.isWeChat()?a.randomShare(e,t,o,i):(i&&i(),a.showToast({title:"Sorry, there are no video ads"}))}):this.randomShare(e,t,o,i)},i.prototype.navigateToMiniProgram=function(e,t,o,i){this.isPreview||GA.PA.navigateToMiniProgram({appId:t.appid,pkgName:t.appid,path:t.path,success:function(i){GA.saveRedirect(e,t.appid,t.path),o&&o(i)},fail:function(e){console.warn(e.errMsg),i&&i()}})},i.prototype.showModal=function(e){this.isPreview?console.log("showModal:"+e.content):GA.PA.showModal(e)},i.prototype.showToast=function(e){this.isPreview?(Utils.showToast(e.title),console.log("showToast:"+e.title)):GA.PA.showToast({title:e.title,icon:"none",duration:2e3})},i.prototype.showLoading=function(e){this.isPreview||o.isNative()||GA.PA.showLoading({title:e||"Loading...",mask:!0})},i.prototype.hideLoading=function(){this.isPreview||GA.PA.hideLoading({})},i.prototype.vibrateShort=function(){this.isPreview||GA.PA.vibrateShort({})},i.prototype.vibrateLong=function(){this.isPreview||GA.PA.vibrateLong({})},i.prototype.isLongScreen=function(){if(cc.winSize.width>cc.winSize.height){if(1.9<cc.winSize.width/cc.winSize.height)return!0}else if(cc.winSize.width<cc.winSize.height&&1.9<cc.winSize.height/cc.winSize.width)return!0;return!1},i.prototype.isLowEndDevice=function(){for(var e=GA.PA.getSystemInfoSync(),t=["iPhone 7","iPhone 6","iPhone 5"],o=0;o<t.length;o++)if(0<=e.model.indexOf(t[o]))return!0;return!1},i.prototype.isIPhoneX=function(){var e=GA.PA.getSystemInfoSync();return 0<=e.model.indexOf("iPhone X")||0<=e.model.indexOf("iPhone 12")||0<=e.model.indexOf("iPhone12")},i.prototype.isIPhone=function(){return 0<=GA.PA.getSystemInfoSync().model.indexOf("iPhone")},i.prototype.isIPad=function(){return 0<=GA.PA.getSystemInfoSync().model.indexOf("iPad")},i.prototype.isAndroidDevice=function(){return 0<=GA.PA.getSystemInfoSync().platform.indexOf("android")},new i);function i(){this.isPreview=!1,this.nickName="",this.avatar="",this.requestUrl=""}cc._RF.pop()},{}],GradeInfo:[function(e,t,o){"use strict";cc._RF.push(t,"113b4KctnxHYrKEGP1mNxS8","GradeInfo");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("FreeGold");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.iconSprite=null,e.titleSprite=null,e.describeSprite=null,e.levelLabel=null,e.atkLabel=null,e.addLabel=null,e.btnGrade=null,e.goldIcon=null,e.goldLabel=null,e.redTips=null,e.currValue=0,e.nextValue=0,e.costGold=0,e.mGradeListener=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=cc.Component),Object.defineProperty(h.prototype,"gradeNext",{get:function(){return this.nextValue},enumerable:!1,configurable:!0}),h.prototype.start=function(){},h.prototype.initSprite=function(e,t){t+=1,this.iconSprite.loadSubpackageImage("home/grade_icon_"+t),this.titleSprite.loadSubpackageImage("home/grade_title_"+t),this.describeSprite.loadSubpackageImage("home/grade_desc_"+e+t)},h.prototype.setOnGradeListener=function(e,t){this.mGradeListener=e.bind(t)},h.prototype.setData=function(e,t,o,i,n){this.costGold=i,this.currValue=e,this.nextValue=t,this.atkLabel.string=GA.formatNumber(e),this.addLabel.string=GA.formatNumber(t),this.levelLabel.string="Lv."+o,this.goldLabel.string=GA.formatNumber(i),this.btnGrade.interactable=!n,this.goldIcon.active=this.goldLabel.node.active=!n},h.prototype.grade=function(){return GameData.payGold(this.costGold)?(MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO),GameData.completeTaskAddTimes(GameModel.TaskType.CostGold,Math.round(this.costGold)),!0):(d.default.show(),!1)},h.prototype.onGradeClick=function(){this.mGradeListener&&this.mGradeListener()},l([a({type:cc.Sprite,tooltip:"icon"})],h.prototype,"iconSprite",void 0),l([a({type:cc.Sprite,tooltip:"Title sprite"})],h.prototype,"titleSprite",void 0),l([a({type:cc.Sprite,tooltip:"Describe sprite"})],h.prototype,"describeSprite",void 0),l([a({type:cc.Label,tooltip:"levelLabel"})],h.prototype,"levelLabel",void 0),l([a({type:cc.Label,tooltip:"Atklabel"})],h.prototype,"atkLabel",void 0),l([a({type:cc.Label,tooltip:"Addlabel"})],h.prototype,"addLabel",void 0),l([a({type:cc.Button,tooltip:"GradeButton"})],h.prototype,"btnGrade",void 0),l([a({type:cc.Node,tooltip:"GoldIcon"})],h.prototype,"goldIcon",void 0),l([a({type:cc.Label,tooltip:"Goldlabel"})],h.prototype,"goldLabel",void 0),l([a({type:cc.Node,tooltip:"Rednode"})],h.prototype,"redTips",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],GradeToast:[function(e,t){"use strict";function o(){this.tipsLabelPool=null}cc._RF.push(t,"6c923GNP6VAD5CmHg+dijLb","GradeToast"),window.GradeToast=(o.prototype.show=function(e,t){this.tipsLabelPool||(this.tipsLabelPool=new cc.NodePool);var o,i=this.tipsLabelPool,n=null,a=null,r=null;0<i.size()?(a=(n=i.get()).getChildByName("left_label").getComponent(cc.Label),r=n.getChildByName("right_label").getComponent(cc.Label)):(n=new cc.Node("node"),o=Utils.createSprite(),Utils.loadSubpackageImage("common/grae_tips_bg",o),n.addChild(o.node),(o=Utils.createSprite()).node.setPosition(55,0),n.addChild(o.node),Utils.loadSubpackageImage("common/grae_tips_icon",o),(a=Utils.createLabel("left_label")).node.setPosition(-65,0),a.fontSize=28,a.verticalAlign=cc.Label.VerticalAlign.CENTER,n.addChild(a.node),(r=Utils.createLabel("right_label")).node.setPosition(100,0),r.fontSize=28,r.verticalAlign=cc.Label.VerticalAlign.CENTER,r.node.color=ex.hexToColor("#00F962"),n.addChild(r.node)),a.string=e,r.string=t,n.setPosition(0,0),n.opacity=255,cc.Canvas.instance.node.addChild(n,GameModel.GradeToastZIndex),cc.tween(n).by(1.2,{y:120}).by(.3,{y:30,opacity:-255}).call(function(){i.put(n)}).start()},new o),cc._RF.pop()},{}],GraphicsDottedLine:[function(e,t,o){"use strict";cc._RF.push(t,"e976fLjsTdPk4hQS8EKd2y6","GraphicsDottedLine");var i,n,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});function l(){var e=null!==n&&n.apply(this,arguments)||this;return e.graphics=null,e.bStroke=!1,e.startPoint=cc.v2(),e.points=[],e.tempStart=cc.v2(),e.tempEnd=cc.v2(),e.direction=cc.v2(),e.startspace=0,e}Object.defineProperty(r,"__esModule",{value:!0}),a=cc._decorator.ccclass,s(l,n=cc.Component),l.prototype.onLoad=function(){this.graphics=this.node.getComponent(cc.Graphics)},l.prototype.update=function(e){if(this.bStroke&&0<this.points.length){this.startspace+=50*e,40<this.startspace&&(this.startspace-=40),this.graphics.clear(),this.graphics.moveTo(this.startPoint.x,this.startPoint.y),this.tempStart.set(this.startPoint);for(var t=this.startspace,o=0,i=0,n=this.points.length;i<n;i++){var a=this.points[i];a.sub(this.tempStart,this.direction);var r=this.direction.normalizeSelf();for(0<t&&(this.tempStart.addSelf(r.mul(t,ex.v2temp())),this.calDrawLine((o-1)%2,this.tempStart.x,this.tempStart.y));;){var s=a.sub(this.tempStart,ex.v2temp()).len(),l=r.mul(20<s?20:s,this.tempEnd).addSelf(this.tempStart);if(this.calDrawLine(o%2,l.x,l.y),this.tempStart.set(l),o++,s<20){t=20-s;break}}this.tempStart.set(a)}this.graphics.stroke()}},l.prototype.calDrawLine=function(e,t,o){1==e?this.graphics.circle(t,o,this.graphics.lineWidth/2):this.graphics.moveTo(t,o)},l.prototype.moveTo=function(e,t){this.startPoint.x=e,this.startPoint.y=t},l.prototype.lineTo=function(e){this.points.push(e)},l.prototype.stroke=function(){this.bStroke=!0},l.prototype.clear=function(){this.bStroke=!1,this.points.splice(0),this.graphics.clear(!0)},a=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],l),r.default=a,cc._RF.pop()},{}],GraphicsSpriteMesh_rope:[function(e,t,o){"use strict";cc._RF.push(t,"c189dpZMNJCCYFFZ/OwfSIR","GraphicsSpriteMesh_rope");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,c=(d=cc._decorator).ccclass,d=(n=d.property,d.requireComponent);function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.sprite=null,e.graphics=null,e._vertices={x:[],y:[],nu:[],nv:[],triangles:[]},e}r(h,l=cc.Component),h.prototype.onLoad=function(){this.graphics=this.node.getComponent(cc.Graphics),this.sprite.type=cc.Sprite.Type.MESH,this.sprite.node.anchorY=1,this.sprite.node.anchorX=0,this.sprite.node.scaleY=-1,this.sprite.node.x=this.node.y=0,this.sprite.spriteFrame.vertices=this._vertices},h.prototype.stroke=function(){if(cc.game.renderType===cc.game.RENDER_TYPE_WEBGL){var e=this._vertices;e.x.length=e.y.length=e.nu.length=e.nv.length=e.triangles.length=0;for(var t=this.graphics._impl,o=this.graphics.lineWidth,i=[],n=cc.v2(),a=0;a<t._paths.length;a++){var r=t._paths[a].points;if(!(r.length<2))for(var s=r.length-1;0<s;s--){var l=[],c=cc.v2(r[s].x,r[s].y),d=cc.v2(r[s-1].x,r[s-1].y),h=c.sub(d),u=(0==h.y?cc.v2(0,1):cc.v2(1,-h.x/h.y).normalize()).mulSelf(o/2),p=c.add(u),f=c.sub(u),m=d.add(u),g=(d=d.sub(u),u=h.len(),e.x.length);e.x.push(p.x,f.x,m.x,d.x),e.y.push(p.y,f.y,m.y,d.y),e.nu.push(.02*n.x,.02*n.x,.02*(n.x+u),.02*(n.x+u)),e.nv.push(1,0,1,0),l.push(g+0),l.push(g+1),l.push(g+2),l.push(g+1),l.push(g+2),l.push(g+3);var y=h.signAngle(cc.v2(-1,0));g=e.x.length,e.x.push(c.x),e.y.push(c.y),e.nu.push(.02*n.x),e.nv.push(.5);for(var v=0;v<12;v++){var b=2*Math.PI*v/12;b=cc.v2(o/2*Math.cos(b),o/2*Math.sin(b)),e.x.push(b.add(c).x),e.y.push(b.add(c).y),e.nu.push(.02*(b.rotate(y).x+n.x)),e.nv.push(b.rotate(y).y/o+.5),0===v?l.push(g,g+1+v,g+12):l.push(g,g+1+v,g+v)}i.push(l),n.addSelf(cc.v2(u,0))}}i.reverse(),i.forEach(function(t){var o;(o=e.triangles).push.apply(o,t)}),this.sprite.setVertsDirty()}else this.graphics.stroke()},h.prototype.clear=function(){var e;this.graphics.clear(!0),cc.game.renderType===cc.game.RENDER_TYPE_WEBGL&&((e=this._vertices).x.length=e.y.length=e.nu.length=e.nv.length=e.triangles.length=0,this.sprite.setVertsDirty())},s([n({type:cc.Sprite,displayName:"Sprite node"})],h.prototype,"sprite",void 0),d=s([c,d(cc.Graphics)],h),a.default=d,cc._RF.pop()},{}],GuideUtils:[function(e,t){"use strict";function o(){this.showStep=0,this.guideContainer=null,this.background=null,this.cover=null,this.hand=null,this.tipsbg=null,this.tipslbl=null,this.clickRect=null,this.clickCallback=null}cc._RF.push(t,"56432peVEJLBLVOSse5l4+x","GuideUtils"),window.GuideUtils=(Object.defineProperty(o.prototype,"isAttackGuide",{get:function(){return this.showStep<Model.GuideStep.StartClick},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isShow",{get:function(){return null!=this.guideContainer},enumerable:!1,configurable:!0}),o.prototype.initialize=function(){this.showStep=GameData.guideStep,G.isPreview&&(this.showStep=Model.GuideStep.End)},o.prototype.createGuide=function(e){console.log("createGuide");var t=new cc.Node("guideContainer");t.setContentSize(cc.winSize);var o=GameModel.GuideHaveCoverZIndex;(e=null!=e?e:cc.Canvas.instance.node).addChild(t,o),this.guideContainer=t},o.prototype.createCover=function(){var e=this.guideContainer,t=new cc.Node("background");t.setContentSize(cc.winSize),e.addChild(t),this.background=t,(e=new cc.Node("cover")).setContentSize(cc.winSize),e.color=cc.Color.BLACK,e.opacity=153,t.addChild(e),(e=(this.cover=e).addComponent(cc.Sprite)).sizeMode=cc.Sprite.SizeMode.CUSTOM,Utils.loadSubpackageImage("common/singleColor",e),this.cover.on(cc.Node.EventType.TOUCH_START,this.onTouchDown,this)},o.prototype.createTipsNode=function(){var e=new cc.Node("guide_tips");this.guideContainer.addChild(e);var t=(this.tipsbg=e).addComponent(cc.Sprite);Utils.loadSubpackageImage("common/guide_tips",t),(t=new cc.Node("labelnode")).setPosition(-30,-20),e.addChild(t),e=t.addComponent(cc.Label),t.color=ex.hexToColor("#2b1e1a"),e.fontSize=25,this.tipslbl=e},o.prototype.onTouchDown=function(e){var t=e.touch.getLocation();this.clickRect&&this.clickRect.contains(t)&&this.clickCallback&&this.clickCallback(),e.stopPropagation()},o.prototype.createRoundedBox=function(e,t){var o=this.background,i=this.cover;o.setContentSize(e.width+t,e.height+t),t=e.origin.x+e.width/2-cc.winSize.width/2,e=e.origin.y+e.height/2-cc.winSize.height/2,o.setPosition(t,e),i.setPosition(-t,-e),(e=(e=o.getComponent(cc.Mask))||o.addComponent(cc.Mask)).type=cc.Mask.Type.ELLIPSE,e.segements=64,e.inverted=!0},o.prototype.showRoundedBoxGuide=function(e,t){this.guideContainer||(this.createGuide(),this.createCover()),this.clickRect=e,this.createRoundedBox(e,t)},o.prototype.playHandAni=function(e){cc.tween(e).repeatForever(cc.tween().to(.3,{y:e.y+20}).to(.3,{y:e.y})).start()},o.prototype.showClickHand=function(e){var t=this.hand;t&&t.isValid?cc.Tween.stopAllByTarget(t):(t=new cc.Node,this.guideContainer.addChild(t),o=(this.hand=t).addComponent(cc.Sprite),Utils.loadSubpackageImage("common/guide_hand",o));var o=e.origin.x+e.size.width/2-cc.winSize.width/2;e=e.origin.y+e.size.height-cc.winSize.height/2,t.setPosition(o,e),this.playHandAni(t)},o.prototype.showTipsNode=function(e,t){this.tipsbg&&this.tipsbg.isValid||this.createTipsNode();var o=this.tipsbg,i=this.tipslbl;e=e.origin.y+e.size.height+150-cc.winSize.height/2,o.setPosition(0,e),i.string=t},o.prototype.showAttack=function(e,t){G.pushEvent("Boot-Attack"),this.clickCallback=t,t=this.showStep==Model.GuideStep.None?"Move the aim and let go":"Kill the monster with a lightning hammer",this.showRoundedBoxGuide(e,50),this.showTipsNode(e,t),this.showStep=Model.GuideStep.Attack},o.prototype.showStartGame=function(e,t){G.pushEvent("Boot - Show start game"),this.showStep=Model.GuideStep.StartGame,this.guideContainer||this.createGuide(t),this.showClickHand(e)},o.prototype.showGradeCoreArms=function(e,t){this.clickCallback=t,this.showRoundedBoxGuide(e,50),this.showClickHand(e),t="",this.showStep==Model.GuideStep.GradeCore?t="Click to view hero properties":this.showStep==Model.GuideStep.GradeAuxiliary?t="Acquired a new weapon":this.showStep==Model.GuideStep.GradeProfit&&(t="You can get more gold!"),this.showTipsNode(e,t)},o.prototype.showGradeCoreArmsButton=function(e,t){this.clickCallback=t,this.showRoundedBoxGuide(e,50),this.showClickHand(e),t="",this.showStep==Model.GuideStep.GradeCore?(t="Click to upgrade attack power",G.pushEvent("Guide - Primary weapon upgrade")):this.showStep==Model.GuideStep.GradeAuxiliary?(t="Click to upgrade attack power",G.pushEvent("Guide - Secondary weapon upgrade")):this.showStep==Model.GuideStep.GradeProfit&&(t="Click to upgrade gold revenue",G.pushEvent("Bootstrap - Revenue upgrade")),this.showTipsNode(e,t),this.showStep++},o.prototype.showNewArms=function(e){var t=this;this.guideContainer||this.createGuide(),this.showClickHand(e),this.showTipsNode(e,"Acquired a new and powerful weapon.\n Check it out"),this.guideContainer.on(cc.Node.EventType.TOUCH_START,function(){t.destroy()},this)},o.prototype.saveStep=function(){GameData.saveGuideStep(this.showStep)},o.prototype.destroy=function(){this.guideContainer&&(this.guideContainer.destroy(),this.guideContainer=null,this.showStep++)},new o),cc._RF.pop()},{}],Handler:[function(e,t){"use strict";cc._RF.push(t,"b3343IqL25ECbUWnvOUsN5z","Handler");var o=t;function i(e,t,o,i){void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null),void 0===i&&(i=!1),this.once=!1,this._id=0,this.setTo(e,t,o,i)}(o=i.prototype).setTo=function(e,t,o,n){return void 0===n&&(n=!1),this._id=i._gid++,this.caller=e,this.method=t,this.args=o,this.once=n,this},o.run=function(){if(null==this.method)return null;var e=this._id,t=this.method.apply(this.caller,this.args);return this._id===e&&this.once&&this.recover(),t},o.runWith=function(e){if(null==this.method)return null;var t=this._id;return e=null==e?this.method.apply(this.caller,this.args):this.args||e.unshift?this.args?this.method.apply(this.caller,this.args.concat(e)):this.method.apply(this.caller,e):this.method.call(this.caller,e),this._id===t&&this.once&&this.recover(),e},o.clear=function(){return this.caller=null,this.method=null,this.args=null,this},o.recover=function(){0<this._id&&(this._id=0,i._pool.push(this.clear()))},i.create=function(e,t,o,n){return void 0===o&&(o=null),void 0===n&&(n=!0),i._pool.length?i._pool.pop().setTo(e,t,o,n):new i(e,t,o,n)},(o=i)._pool=[],o._gid=1,cc._RF.pop()},{}],HitEffectAni:[function(e,t,o){"use strict";cc._RF.push(t,"97ea1boMT9BDJqqhZ3MGkEs","HitEffectAni");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var s,l=cc._decorator;function c(){var e=null!==s&&s.apply(this,arguments)||this;return e.direction=0,e}n=l.ccclass,l.property,r(c,s=cc.Component),c.prototype.onLoad=function(){this.node.active=!1,this.node.anchorY=0},c.prototype.start=function(){},c.prototype.initialize=function(e){e=e.info.size*GameModel.BlockWidth,this.node.setPosition(e/2,e-35)},c.prototype.update=function(e){0!=this.direction&&(e=this.node.scale+e*this.direction*3.5,0<this.direction&&1.3<=e?(this.node.scale=1.3,this.direction=-1):this.direction<0&&e<=1?(this.node.scale=1,this.direction=0,this.node.active=!1):this.node.scale=e)},c.prototype.showAni=function(){this.node.active=!0,this.node.scale=1,this.direction=1},c.prototype.clear=function(){this.node.destroy()},n=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([n],c),a.default=n,cc._RF.pop()},{}],HitHurtAni:[function(e,t,o){"use strict";cc._RF.push(t,"90d753RTS1GJqf6zBV8FaOH","HitHurtAni");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var s,l=cc._decorator;function c(){var e=null!==s&&s.apply(this,arguments)||this;return e.enemy=null,e.hurtAniState=GameModel.HurtAniState.None,e.hitHurtTotal=0,e.hitHurtShown=0,e.addSpeed=0,e.direction=0,e.label=null,e.sizeWidth=0,e}n=l.ccclass,l.property,r(c,s=cc.Component),c.prototype.onLoad=function(){this.label=this.node.getComponent(cc.Label)},c.prototype.start=function(){},c.prototype.initialize=function(e){this.enemy=e,this.sizeWidth=e.info.size*GameModel.BlockWidth,this.node.x=this.sizeWidth/2,this.resetData()},c.prototype.resetData=function(){this.node.active=!1,this.node.opacity=255,this.hurtAniState=GameModel.HurtAniState.None,this.hitHurtTotal=0,this.hitHurtShown=0,this.direction=0},c.prototype.update=function(e){this.hitHurtShown<this.hitHurtTotal&&(this.hitHurtShown+=this.addSpeed*e,this.hitHurtShown>this.hitHurtTotal&&(this.hitHurtShown=this.hitHurtTotal),this.label.string=GA.formatNumber(this.hitHurtShown)),this.hurtAniState==GameModel.HurtAniState.Scale&&0!=this.direction&&(e=this.node.scale+e*this.direction*.5,0<this.direction&&1.3<=e?(this.node.scale=1.3,this.direction=-1):this.direction<0&&e<=1?(this.node.scale=1,this.direction):this.node.scale=e)},c.prototype.showHurtAni=function(e){var t=this;this.hitHurtTotal+=e,this.addSpeed=(this.hitHurtTotal-this.hitHurtShown)/.7,this.hurtAniState==GameModel.HurtAniState.None?(this.node.active=!0,this.hurtAniState=GameModel.HurtAniState.Move,this.node.scale=0,this.node.y=this.sizeWidth-GameModel.BlockWidth/2,cc.tween(this.node).to(.3,{y:this.sizeWidth-10,scale:1.3}).call(function(){t.hurtAniState=GameModel.HurtAniState.Scale,t.direction=-1}).start()):this.hurtAniState==GameModel.HurtAniState.Scale&&(this.node.scale=1,this.direction=5)},c.prototype.hideHurtAni=function(){var e=this;cc.tween(this.node).to(.6,{scale:2,opacity:0}).call(function(){e.resetData()}).start()},n=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([n],c),a.default=n,cc._RF.pop()},{}],LevelNode:[function(e,t,o){"use strict";cc._RF.push(t,"67b88ml+odNLb8mrC/3FjLU","LevelNode");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.hardTips=null,e.levelLabel=null,e.levelList=[],e}r(d,l=cc.Component),d.prototype.onLoad=function(){this.hardTips.active=!1,this.refresh()},d.prototype.start=function(){},d.prototype.refresh=function(e){void 0===e&&(e=!1),this.levelLabel.string="Level"+GameData.currLevel,e&&GameData.currLevel%5==0&&(this.hardTips.active=!0)},s([c({type:cc.Node,tooltip:"Hard level tips"})],d.prototype,"hardTips",void 0),s([c({type:cc.Label,tooltip:"Lvlabel"})],d.prototype,"levelLabel",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],LevelUp:[function(e,t,o){"use strict";cc._RF.push(t,"0b899AjajZDv4t5E65lRiKL","LevelUp");var i,n,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0}),(d=n=n||{})[d.Normal=0]="Normal",d[d.Unfold=1]="Unfold",d[d.ZoomIn=2]="ZoomIn",d[d.ZoomOut=3]="ZoomOut",d[d.FadeIn=4]="FadeIn";var c,d=(a=cc._decorator).ccclass;function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.itemTemplate=null,e.levelUpSpine=null,e.levelLabel=null,e.powerLabel=null,e.nextPowerLabel=null,e.continueBtn=null,e.content=null,e.itemNodes=[],e.aniShownTime=0,e.aniList=null,e}a=a.property,s(h,c=cc.Component),h.prototype.onLoad=function(){console.log("LevelUp onLoad."),this.pageName="LevelUp",this.content=this.node.getChildByName("content");var e=this.itemTemplate.height+15;this.addItem(this.itemTemplate);for(var t=1;t<2;t++){var o=cc.instantiate(this.itemTemplate);o.y=this.itemTemplate.y-e*t,this.itemTemplate.parent.addChild(o),this.addItem(o)}this.aniList=[{node:this.levelLabel.node,aniMode:n.Normal},{name:"attr_tips_lbl",aniMode:n.FadeIn},{name:"power_node",aniMode:n.FadeIn},{node:this.itemNodes[0].item,aniMode:n.FadeIn},{node:this.itemNodes[1].item,aniMode:n.FadeIn},{node:this.continueBtn,aniMode:n.Normal}],this.initAniList(),this.initListener()},h.prototype.addItem=function(e){var t=this.itemNodes.length,o=e.getChildByName("icon").getComponent(cc.Sprite),i=e.getChildByName("level_label").getComponent(cc.Label),n=(s=e.getChildByName("HorLayout")).getChildByName("title").getComponent(cc.Sprite),a=s.getChildByName("atk_label").getComponent(cc.Label),r=s.getChildByName("next_label").getComponent(cc.Label),s=e.getChildByName("describe").getComponent(cc.Sprite);this.itemNodes.push({item:e,icon:o,level:i,title:n,describe:s,atkLabel:a,next:r}),t+=1,o.loadSubpackageImage("home/grade_icon_"+t),n.loadSubpackageImage("home/grade_title_"+t),s.loadSubpackageImage("home/grade_desc_0"+t)},h.prototype.initAniList=function(){for(var e=this.aniList,t=.1,o=0;o<e.length;o++){var i=e[o];i.beginTime=t;var n=i.interval;t+=n||0==n?n:.3,i.node||(i.node=this.content.getChildByName(i.name))}},h.prototype.initListener=function(){var e=this;this.levelUpSpine.setEventListener(function(t,o){o&&o.data&&"attr_show"==o.data.name&&e.schedule(e.onAniUpdate,.1)})},h.prototype.setAttackItem=function(){var e=GameData.getCoreArmsLevel(),t=GameConfig.getCoreArmsInfo(e),o=1+GameConfig.roleAttackAdded/100,i=GameConfig.calPlayerLevelAdded(t.atk*o,GameConfig.playerLevel-1);o=GameConfig.calPlayerLevelAdded(t.atk*o),this.setItem(0,i,o,e)},h.prototype.setLuckItem=function(){var e=GameData.getCoreLuckLevel(),t=GameConfig.getCoreArmsInfo(e),o=1+GameConfig.roleLuckAdded/100,i=GameConfig.calPlayerLevelAdded(t.luck*o,GameConfig.playerLevel-1);o=GameConfig.calPlayerLevelAdded(t.luck*o),this.setItem(1,i,o,e)},h.prototype.setItem=function(e,t,o,i){(e=this.itemNodes[e]).atkLabel.string=GA.formatNumber(t),e.next.string=GA.formatNumber(o),e.level.string="Lv."+i},h.prototype.refreshFightPowerLabel=function(){this.levelLabel.string=""+GameConfig.playerLevel;var e=GameConfig.getCurrentPower(GameConfig.playerLevel-1),t=GameConfig.getCurrentPower();this.powerLabel.string=GA.formatNumber(e),this.nextPowerLabel.string=GA.formatNumber(t)},h.prototype.show=function(e){var t=this;this.closeCallback=e,this.node.active=!0,this.refreshFightPowerLabel(),this.setAttackItem(),this.setLuckItem(),this.hideAllContent(),this.levelUpSpine.setAnimation(0,"1.donghua",!1),this.levelUpSpine.setCompleteListener(function(){t.levelUpSpine.setCompleteListener(null),t.levelUpSpine.setAnimation(0,"2.daiji",!0)}),G.enterPage({page:this.pageName,existBanner:!0}),AdManager.showBannerWithTimes()},h.prototype.hideAllContent=function(){this.aniShownTime=0,this.content.children.forEach(function(e){e.active=!1})},h.prototype.onAniUpdate=function(e){this.aniShownTime+=e;for(var t=this.aniList,o=0;o<t.length;o++){var i=t[o];i.node&&this.aniShownTime>=i.beginTime&&(i.node.active||(i.node.active=!0,i.aniMode==n.Unfold?this.playUnfoldAni(i):i.aniMode==n.FadeIn&&this.playFadeInAni(i)))}this.continueBtn.active&&(console.log("stop aimation update"),this.unschedule(this.onAniUpdate))},h.prototype.playUnfoldAni=function(e){var t=e.node;t.scaleY=0,e=null!==(e=e.duration)&&void 0!==e?e:.4,cc.tween(t).to(e,{scaleY:1},{easing:"elasticOut"}).start()},h.prototype.playFadeInAni=function(e){var t=e.node;t.opacity=0,e=null!==(e=e.duration)&&void 0!==e?e:.3,cc.tween(t).to(e,{opacity:255}).start()},h.prototype.close=function(){this.node.active=!1,this.unschedule(this.onAniUpdate),AdManager.hideBannerWithTimes(),G.closePage({page:this.pageName})},h.prototype.onContinueClick=function(){this.close(),this.closeCallback()},l([a({type:cc.Node,tooltip:"Listitem"})],h.prototype,"itemTemplate",void 0),l([a({type:sp.Skeleton,tooltip:"spine"})],h.prototype,"levelUpSpine",void 0),l([a({type:cc.Label,tooltip:"Player levellabel"})],h.prototype,"levelLabel",void 0),l([a({type:cc.Label,tooltip:"War force label"})],h.prototype,"powerLabel",void 0),l([a({type:cc.Label,tooltip:"nextPowerlabel"})],h.prototype,"nextPowerLabel",void 0),l([a({type:cc.Node,tooltip:"continue button"})],h.prototype,"continueBtn",void 0),d=l([d],h),r.default=d,cc._RF.pop()},{}],ListView:[function(e,t,o){"use strict";cc._RF.push(t,"6ceb25NJ5xOGY0/2xsZNr32","ListView");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var s,l=cc._decorator;function c(){var e=null!==s&&s.apply(this,arguments)||this;return e.mList=null,e.content=null,e.render=null,e.items=[],e.array=null,e.selectTarget=null,e._updateHander=null,e.itemHeight=0,e.totalCount=0,e.visibleCount=0,e.spacing=5,e.spawnCount=10,e.bufferTop=0,e.bufferBottom=0,e.offset=0,e.updateTimer=0,e.updateInterval=.2,e.lastContentPosY=0,e.outPos=cc.v3(),e}n=l.ccclass,l.property,r(c,s=cc.Component),c.prototype.onLoad=function(){this.mList=this.node.getComponent(cc.ScrollView),this.content=this.mList.content,this.render=this.content.getChildByName("render"),this.initialize(),this.refresh()},c.prototype.start=function(){},c.prototype.initialize=function(){this.itemHeight=this.render.height;var e=this.itemHeight+this.spacing;this.visibleCount=Math.ceil(this.node.height/e),this.spawnCount=this.visibleCount+3,this.offset=e*this.spawnCount,this.bufferTop=(1-this.node.anchorY)*this.node.height+e,this.bufferBottom=-(this.node.anchorY*this.node.height+e),cc.log("item height is "+this.itemHeight),cc.log("spacing is "+this.spacing),cc.log("offset is "+this.offset),cc.log("list height is "+this.node.height),cc.log("spawn count: "+this.spawnCount),this.addItem(this.render);for(var t=1;t<this.spawnCount;t++){var o=cc.instantiate(this.render);this.content.addChild(o);var i=-(this.itemHeight*(.5+t)+this.spacing*t);o.y=i,this.addItem(o)}},c.prototype.addItem=function(e){var t=this.items.length;this.items.push({index:t,node:e})},c.prototype.updateHander=function(e,t){this._updateHander=e,this.selectTarget=t},c.prototype.refresh=function(){if(this.array&&this.content){var e=this.totalCount,t=this.totalCount=this.array.length;this.lastContentPosY=this.content.y,this.content.height=t*(this.itemHeight+this.spacing)+this.spacing;var o=this.content.y;if(cc.log("item count is "+t),0<e){var i=this.itemHeight+this.spacing,n=.5*this.itemHeight,a=0,r=0;if(this.lastContentPosY>o?(a=t<this.visibleCount?-n:(o=Math.min(this.spawnCount,t),-this.content.height+this.spacing+n+(o-1)*i),r=Math.max(0,t-this.spawnCount)):e<this.spawnCount&&(a=this.items[0].node.y),a<0)for(var s=0;s<this.spawnCount;s++){var l=a-(this.itemHeight+this.spacing)*s;(c=this.items[s]).node.y=l,c.index=r+s}}for(s=0;s<this.spawnCount;s++){var c=this.items[s];s<t?(c.node.active=!0,this.updateItem(c.node,c.index)):(console.log("hide:",s),c.node.active=!1)}this.lastContentPosY=this.content.y}},c.prototype.updateItem=function(e,t){this._updateHander&&this._updateHander.apply(this.selectTarget,[e,t])},c.prototype.update=function(e){if(this.updateTimer+=e,!(this.updateTimer<this.updateInterval)&&this.content.y!=this.lastContentPosY){this.updateTimer=0;for(var t=this.items,o=this.bufferTop,i=this.bufferBottom,n=this.offset,a=this.content.y<this.lastContentPosY,r=0;r<t.length;r++){var s,l=t[r],c=this.getPositionInView(l.node);a?c.y<i&&l.node.y+n<0&&(l.node.y=l.node.y+n,s=l.index-t.length,l.index=s,this.updateItem(l.node,s)):c.y>o&&l.node.y-n>-this.content.height&&(l.node.y=l.node.y-n,s=l.index+t.length,l.index=s,this.updateItem(l.node,s))}this.lastContentPosY=this.content.y}},c.prototype.getPositionInView=function(e){return e=e.parent.convertToWorldSpaceAR(e.position,this.outPos),this.mList.node.convertToNodeSpaceAR(e,this.outPos)},n=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([n],c),a.default=n,cc._RF.pop()},{}],LoadUI:[function(e,t,o){"use strict";cc._RF.push(t,"5eabeaSYXhAzKo2ZNUK4+Mc","LoadUI");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.progressBar=null,e.subProgressBar=null,e.progressLabel=null,e.progressValue=0,e.subProgressValue=0,e}r(d,l=cc.Component),d.prototype.initGameConfig=function(){ProjectConfig.check(),GameData.check(),G.check()},d.prototype.onLoad=function(){var e=this;this.pageName="Load",console.log("LaunchScene onLoad");var t=cc.view.getCanvasSize();console.log(t.height,t.width,t.height/t.width),t.height/t.width<1.5?(cc.Canvas.instance.fitHeight=!0,cc.Canvas.instance.fitWidth=!1):(cc.Canvas.instance.fitHeight=!1,cc.Canvas.instance.fitWidth=!0),this.initGameConfig(),(t=this.node.getChildByName("watermark"))&&(t.width=187*(cc.winSize.width/187+2),t.height=184*(cc.winSize.height/184+2),cc.tween(t).repeatForever(cc.tween().to(15,{x:-187,y:-184}).to(0,{x:0,y:0})).start()),this.progressBar.progress=0,this.setSubProgressBar(0),this.setProgressBar(),this.startTimer(),G.initGA(function(){console.log("===>",111),e.wxlogin(function(){G.enterPage({page:e.pageName}),e.loadBundle("subpackage",function(){e.loadBundle("subremote",function(){e.loadGameConfig(function(){e.loadGameData(function(){e.loadLevelConfig(function(){e.progressValue=.99,e.setProgressBar(),GameConfig.initialize(),e.startGame()})})})})})})})},d.prototype.startTimer=function(){var e=this;this.schedule(function(){e.progressValue+=.004,.99<e.progressValue&&(e.progressValue=.99),e.setProgressBar(),e.subProgressValue+=.03,e.setSubProgressBar(e.subProgressValue),1<=e.subProgressValue&&(e.subProgressValue=0)},.03)},d.prototype.setSubProgressBar=function(e){this.subProgressBar.progress=e},d.prototype.setProgressBar=function(){var e=this.progressValue;this.progressBar.progress>e&&(e=this.progressBar.progress),this.progressBar.progress=e,this.progressLabel.string="Loading"+Math.floor(100*e)+"%",.99<=e&&this.setSubProgressBar(1)},d.prototype.startGame=function(){var e=this;this.unscheduleAllCallbacks(),cc.director.preloadScene("GameScene",function(){},function(){cc.director.loadScene("GameScene"),G.closePage({page:e.pageName})})},d.prototype.onDestroy=function(){console.log("LaunchScene onDestroy")},d.prototype.loadBundle=function(e,t){var o=this;GameInfo.isNewUser&&"subgame"==e?t&&t():cc.assetManager.loadBundle(e,function(i){i?(console.log("loadBundle fail.",JSON.stringify(i)),G.showModal({title:"Tips",content:"If the resource fails to be loaded, click Retry.",showCancel:!1,confirmText:"Retry",success:function(){o.loadBundle(e,t)}})):(console.log("loadBundle complete."),t())})},d.prototype.wxlogin=function(e){this.setOpenId(Date.now().toString()),e&&e()},d.prototype.setOpenId=function(e){console.log("openId: "+e),G.setOpenId(e)},d.prototype.loadGameConfig=function(e){cc.loader.loadRes("json/GameConfig.txt",cc.TextAsset,function(t,o){(function(t){GameConfig.initWithData(t.data),t.data.AutomatedTesting&&(G.isPreview||(GameConfig.AutomatedTesting=!0)),t.data.TestLevel&&(G.isPreview||(GameConfig.TestLevel=t.data.TestLevel)),t.data.TestAuxiliaryType&&(G.isPreview||(GameConfig.TestAuxiliaryType=t.data.TestAuxiliaryType)),console.log("AutomatedTesting="+GameConfig.AutomatedTesting),console.log("TestLevel="+GameConfig.TestLevel),console.log("TestAuxiliaryType="+GameConfig.TestAuxiliaryType),e()})(JSON.parse(o.text))})},d.prototype.loadLevelConfig=function(e){var t=this,o=Model.LevelConfigUrls,i=Date.now();API.loadLevelConfig(o,function(){console.log("load level configs time:",(Date.now()-i)/1e3),e&&e()},function(){t.showLoadGameConfigFail("Failed to obtain the game configuration (2), click retry",t.loadLevelConfig.bind(t),e)})},d.prototype.showLoadGameConfigFail=function(e,t,o){G.showModal({title:"Tips",content:e,showCancel:!1,confirmText:"Retry",success:function(){setTimeout(t,1e3,o)}})},d.prototype.loadGameData=function(e){var t=this;this.login(function(){e(),setTimeout(function(){console.error("showInterstitialAd"),AdManager.showInterstitialAd()},5)},function(){G.showModal({title:"Tips",content:"Failed to read archive data. Click Retry",showCancel:!1,confirmText:"Retry",success:function(){setTimeout(t.loadGameData.bind(t),1e3,e)}})})},d.prototype.login=function(e){var t=GA.PA.getStorageSync("GameData");return GA.setUserId("12345"),console.log("UID IS "+G.uid),this.initUserData(t),void(e&&e())},d.prototype.initUserData=function(e){""!=e||G.isPreview||(GameInfo.isNewUser=!0,G.pushEvent("New user"),console.log("current is new user.")),GameData.initWithData(e),GameData.initGMData()},s([c({type:cc.ProgressBar,tooltip:"Loading progress bar"})],d.prototype,"progressBar",void 0),s([c({type:cc.ProgressBar,tooltip:"Load the child progress bar"})],d.prototype,"subProgressBar",void 0),s([c({type:cc.Label,tooltip:"Loadinglabel"})],d.prototype,"progressLabel",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],LobbyNode:[function(e,t,o){"use strict";cc._RF.push(t,"80f78dA5blDO6OwBTdf5W9P","LobbyNode");var i,n,a=e,r=t,s=o,l=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),c=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(s,"__esModule",{value:!0});var d,h,u=a("GameUI"),p=a("CurrencyInfo"),f=a("ExpireNode"),m=a("FreeStamina"),g=a("FreeTrial"),y=a("LevelNode"),v=a("OnlineNode"),b=a("RewardGoldTips"),A=a("SignNode"),P=a("SmallScene"),C=a("TaskNode"),S=a("TabBarItem");function k(){var e=null!==d&&d.apply(this,arguments)||this;return e.currencyPrefab=null,e.levelPrefab=null,e.smallScenePrefab=null,e.watermark=null,e.tabBarItems=[],e.tabBarButtons=[],e.auxArmsIcon=null,e.onlineGoldLabel=null,e.onlineProgressBar=null,e.roleSpine=null,e.pigSpine=null,e.gradeSpine=null,e.leftArmsSpine=null,e.rightArmsSpine=null,e.leftArmsCountLabel=null,e.rightArmsCountLabel=null,e.iconStamina=null,e.startBtn=null,e.signBtn=null,e.giftBtn=null,e.giftGoldLabel=null,e.taskBannerBtn=null,e.taskReceiveTips=null,e.taskLeftTimeLabel=null,e.currencyInfo=null,e.selectedIndex=0,e.tabBarNodes=[],e.giftRewardGold=0,e.mShowType=0,e.refreshTime=0,e.refreshTaskTime=0,e.taskTimeInterval=0,e.flying=!1,e}a=(r=cc._decorator).ccclass,r=r.property,l(k,d=cc.Component),(h=k).show=function(e){e=null!=e?e:GameModel.LobbyShowType.None,cc.resources.load("prefab/LobbyNode",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).setPosition(0,0),o.setContentSize(cc.winSize),o.getComponent(h).setData(e),cc.Canvas.instance.node.addChild(o))})},k.prototype.setTimeoutAD=function(){console.log("setTimeoutAD"),n=setInterval(function(){console.log("try show"),window.adManager&&window.adManager.showInterstitial()},3e4)},k.prototype.setData=function(e){this.mShowType=e},k.prototype.onLoad=function(){var e=this;this.pageName=Model.PageName.Lobby,G.enterPage({page:this.pageName});var t=Utils.getSafeAreaTop();console.log("safeAreaTop=",t),this.setTimeoutAD();var o=cc.instantiate(this.currencyPrefab);o.setPosition(-20,cc.winSize.height/2-t-40),cc.Canvas.instance.node.addChild(o),this.currencyInfo=o.getComponent(p.default),this.watermark.width=187*(cc.winSize.width/187+2),this.watermark.height=184*(cc.winSize.height/184+2),cc.tween(this.watermark).repeatForever(cc.tween().to(15,{x:-187,y:-184}).to(0,{x:0,y:0})).start(),(t=cc.instantiate(this.levelPrefab)).setPosition(0,360),this.node.addChild(t),t.getComponent(y.default).refresh(!0),t.setSiblingIndex(2),this.initSmallScene(),this.taskBannerBtn.y=o.y-(o.height/2+this.taskBannerBtn.height/2+10),GameConfig.syncTaskData(),cc.tween(this.taskReceiveTips).repeatForever(cc.tween().by(.6,{y:20}).by(.6,{y:-20})).start(),this.refreshTaskReceiveTips(),this.signBtn.active=!1,this.initData(),this.refreshOnlineRewardGold(),this.selectedIndex=-1;var i=[GameModel.CoreArmsTabBarUnlockLevel,GameModel.AuxArmsTabBarUnlockLevel,0],n=[Model.GuideStep.GradeCore,Model.GuideStep.GradeAuxiliary,0],a=this.tabBarButtons[0].node.parent;if(a.zIndex=10,this.tabBarButtons.forEach(function(t,o){t.isChecked=!1;var r=e.tabBarItems[o];r.initialize(e,o,i[o],n[o]),r.hide(),e.tabBarNodes.push({icon:t.node.getChildByName("tab_icon"),lock:t.node.getChildByName("tab_lock"),redTips:t.node.getChildByName("icon_up")}),e.tabBarNodes[o].lock.active=GameData.currLevel<i[o],e.tabBarNodes[o].redTips.active=!1,e.tabBarNodes[o].redTips.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),r.node.zIndex=a.zIndex}),this.iconStamina.active=!1,this.roleSpine.setAnimation(0,"daiji",!0),this.leftArmsSpine.setAnimation(0,"animation",!0),this.rightArmsSpine.setAnimation(0,"animation",!0),this.refreshAuxArmsIcon(),this.checkShowCoreArmsRedTips(),this.checkShowAuxArmsRedTips(),0<this.mShowType&&(r=this.mShowType==GameModel.LobbyShowType.GradeArms?1:0,this.onTabItemClick(null,r)),GuideUtils.showStep==Model.GuideStep.AttackEnd){var r=this.startBtn.getBoundingBoxToWorld();GuideUtils.showStartGame(r,this.node)}else{GameData.currLevel>=GameModel.CoreArmsTabBarUnlockLevel&&GuideUtils.showStep==Model.GuideStep.StartClick&&(GuideUtils.showStep=Model.GuideStep.GradeCore,GameData.recordTaskStartTime());for(var s=this,l=0;l<2&&"break"!==function(t){var o=s.tabBarItems[t];if(GameData.currLevel>=o.unlockLevel&&GuideUtils.showStep==o.guideStep)return s.scheduleOnce(function(){var o=e.getTabBarButtonWorldRect(t);GuideUtils.showGradeCoreArms(o,function(){e.onTabItemClick(null,t)})}),"break"}(l);l++);GuideUtils.showStep>=Model.GuideStep.End&&GameInfo.newArms&&this.scheduleOnce(function(){var t=e.getTabBarButtonWorldRect(1);GuideUtils.showNewArms(t)}),GameInfo.newArms=!1}},k.prototype.initData=function(){GameConfig.trialAuxArms=0;var e=GameConfig.getCoinCostInfo(GameData.currLevel);this.giftRewardGold=360*e.online},k.prototype.start=function(){var e,t=this;this.initListener(),this.giftBtn.active=!1,this.pigSpine.setAnimation(0,"1.daiji",!0),this.scheduleOnce(function(){t.isValid&&t.checkShowGiftNode()},3),GameConfig.showGoldAni&&(GameConfig.showGoldAni=!1,Utils.showRewardGoldAnimation(null)),0<GameData.taskStartTime?(this.taskBannerBtn.active=!0,e=this.refreshTaskLeftTime(),console.log("task update interval:",this.taskTimeInterval),console.log("task left time:",e)):this.taskBannerBtn.active=!1,GameConfig.playTimes&&GameConfig.playTimes%3==0&&!GuideUtils.isShow&&GameConfig.taskShowTimes<2&&0<this.taskTimeInterval&&(GameConfig.taskShowTimes++,C.default.show()),Utils.showGameClubButton(),this.showCustomAd()},k.prototype.initSmallScene=function(){var e=P.default.create(this.smallScenePrefab);e.node.y=85,this.node.addChild(e.node),e.node.setSiblingIndex(3)},k.prototype.initListener=function(){var e=this;MSGEvent.on(this.pageName,MSGEvent.RECEIVE_ONLINE,function(){e.refreshOnlineRewardGold()}),MSGEvent.on(this.pageName,MSGEvent.CHANGE_AUXILIARY,function(){e.refreshAuxArmsIcon()}),MSGEvent.on(this.pageName,MSGEvent.RECEIVE_GIFT,function(){e.giftBtn.active=!1,e.pigSpine.setAnimation(0,"1.daiji",!0)}),MSGEvent.on(this.pageName,MSGEvent.DELAY_TASK,function(){e.refreshTaskLeftTime()}),MSGEvent.on(this.pageName,MSGEvent.RECEIVE_TASK,function(){e.refreshTaskReceiveTips()}),MSGEvent.on(this.pageName,MSGEvent.SHOW_SINGLECUSTOM,function(){e.showCustomAd()})},k.prototype.update=function(e){this.refreshTime+=e,10<=this.refreshTime&&(this.refreshTime=0,this.refreshOnlineRewardGold()),0<this.taskTimeInterval&&(this.refreshTaskTime+=e,this.refreshTaskTime>=this.taskTimeInterval&&(this.refreshTaskTime=0,this.refreshTaskLeftTime()))},k.prototype.getTabBarButtonWorldRect=function(e){var t=this.tabBarButtons[e].node;return e=t.parent.convertToWorldSpaceAR(t.getPosition()),cc.rect(e.x-t.width/2,e.y-t.height/2,t.width,t.height)},k.prototype.refreshOnlineRewardGold=function(){var e=GameConfig.getOnlineReward();this.onlineGoldLabel.string=GA.formatNumber(e),this.onlineProgressBar.progress=Math.min(e/GameConfig.onlineRewardMax,1),e=17+6*this.onlineProgressBar.progress,this.onlineGoldLabel.fontSize=e},k.prototype.refreshTaskLeftTime=function(){var e=GameModel.TaskValidTime-Math.floor((Date.now()-GameData.taskStartTime)/1e3);return this.taskLeftTimeLabel.string=ex.formatDateTime(e),this.taskTimeInterval=e<=0?-1:e<3600?1:50,e},k.prototype.refreshTaskReceiveTips=function(){this.taskReceiveTips.active=GameConfig.haveCanReceiveTask()},k.prototype.refreshAuxArmsIcon=function(){var e=GameData.currAuxArms;this.auxArmsIcon.loadSubpackageImage("home/tabbar_icon/"+e);var t,o,i=""+e;this.roleSpine.setAttachment("weapon",i),0<e?(t=(o=GameData.getAuxData(e)).level,o=o.capacitylevel,o=GameConfig.getAuxiliaryArmsInfo(e,o),t>=GameConfig.GameConf.auxiliaryunlock.left?(this.leftArmsSpine.setAttachment("weapon",i),this.leftArmsCountLabel.string=""+o.bulletcount,this.leftArmsCountLabel.node.active=!0):(this.leftArmsSpine.setAttachment("weapon","yincang"),this.leftArmsCountLabel.node.active=!1),t>=GameConfig.GameConf.auxiliaryunlock.right?(this.rightArmsSpine.setAttachment("weapon",i),this.rightArmsCountLabel.string=""+o.bulletcount,this.rightArmsCountLabel.node.active=!0):(this.rightArmsSpine.setAttachment("weapon","yincang"),this.rightArmsCountLabel.node.active=!1)):(this.leftArmsSpine.setAttachment("weapon","yincang"),this.rightArmsSpine.setAttachment("weapon","yincang"),this.leftArmsCountLabel.node.active=this.rightArmsCountLabel.node.active=!1)},k.prototype.checkShowGiftNode=function(){var e=this;this.giftBtn.active||GameConfig.haveRewardGoldValidTimes()&&(ex.rand(1,100)<=50?(console.log("gift show."),this.giftBtn.active=!0,this.giftGoldLabel.node.active=!1,this.pigSpine.setAnimation(0,"2.pen",!1),this.pigSpine.setCompleteListener(function(){e.pigSpine.setCompleteListener(null),e.giftBtn.active&&e.pigSpine.setAnimation(0,"3.pendaiji",!0)}),this.scheduleOnce(function(){e.giftGoldLabel.node.active=!0,e.giftGoldLabel.string=GA.formatNumber(e.giftRewardGold)},.5)):console.log("not displayed temporarily."))},k.prototype.checkShowCoreArmsRedTips=function(){this.tabBarNodes[0].redTips.active=GameConfig.checkShowCoreArmsRedTips()},k.prototype.checkShowAuxArmsRedTips=function(){this.tabBarNodes[1].redTips.active=GameConfig.checkShowAuxArmsRedTips()},k.prototype.showCustomAd=function(){var e=GA.PA.getSystemInfoSync();AdManager.showCustomAd({tag:Model.AdTag.SingleCustom,style:{top:e.screenHeight/2-220,left:e.screenWidth-80}})},k.prototype.hideCustomAd=function(){AdManager.hideCustomAd(Model.AdTag.SingleCustom)},k.prototype.close=function(){clearInterval(n),MSGEvent.offAll(this.pageName),this.currencyInfo.clear(),this.node.destroy(),this.destroy(),Utils.hideGameClubButton(),this.hideCustomAd(),G.closePage({page:this.pageName})},k.prototype.onStartClick=function(){var e,t;this.flying||(GameData.consumeStamina(GameConfig.GameConf.enduranceconsume)?(GameData.checkAndUpdateStaminaResumeTime(),this.currencyInfo.refreshStaminaLabel(),this.iconStamina.active=!0,this.flying=!0,cc.tween(this.iconStamina).to(.8,{x:this.iconStamina.x,y:this.iconStamina.y}).call(this.showTrial,this).start(),t=this.currencyInfo.node.convertToWorldSpaceAR(this.currencyInfo.staminaIcon.getPosition()),e=this.iconStamina.parent.convertToWorldSpaceAR(this.iconStamina.getPosition()),t=t.sub(e,t),this.iconStamina.setPosition(this.iconStamina.x+t.x,this.iconStamina.y+t.y),GuideUtils.destroy(),GuideUtils.saveStep()):m.default.show(),G.pushEvent(Model.LoginLogType.HomeStartGame),SoundManager.playSound(Model.AudioUrl.Click))},k.prototype.showTrial=function(){var e=this;g.default.show(function(){e.roleMove()})},k.prototype.roleMove=function(){var e=this;function t(){e.flying=!1,u.default.instance.onStartGame(),e.close()}this.roleSpine.setAnimation(0,"zoulu",!0),cc.tween(this.roleSpine.node).to(2,{y:300}).start(),(i=u.default.instance.cover).active=!0,i.opacity=0;var o,i=cc.tween(i).to(.8,{opacity:255}).call(function(){u.default.instance.showLoadTipsLabel()});GameConfig.bSubgameLoaded?i.delay(2).call(t):(o=Date.now(),this.loadBundle("subgame",function(){GameConfig.bSubgameLoaded=!0;var i=Date.now()-o;i<1900?e.scheduleOnce(t,(2e3-i)/1e3):t()})),i.start(),this.scheduleOnce(function(){var e=u.default.instance.doorSpine;e.node.active=!0,e.setAnimation(0,"guanmen",!1)},.7)},k.prototype.onSignClick=function(){clearInterval(n),this.setTimeoutAD(),A.default.show(),GA.clickEvent(this.pageName,this.pageName+"-Sign in","other"),SoundManager.playSound(Model.AudioUrl.Click)},k.prototype.onOnlineRewardClick=function(){v.default.show(),GA.clickEvent(this.pageName,this.pageName+"-Piggy bank","other"),SoundManager.playSound(Model.AudioUrl.Click)},k.prototype.onGiftClick=function(){clearInterval(n),this.setTimeoutAD();var e=this;G.rewardOperation(this.pageName,"Golden pig Fortune Bag",function(){var t=GameData.gold;GameData.addGold(e.giftRewardGold),GameData.receiveGift(),MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO,{before:t}),MSGEvent.sendEvent(MSGEvent.RECEIVE_GIFT),b.default.show(e.giftRewardGold)})},k.prototype.onTaskClick=function(){clearInterval(n),this.setTimeoutAD(),(this.taskTimeInterval<0?f:C).default.show(),GA.clickEvent(this.pageName,this.pageName+"-Task","other"),SoundManager.playSound(Model.AudioUrl.Click)},k.prototype.onAuxArmsClick=function(e,t){clearInterval(n),this.setTimeoutAD();var o,i=1==t;t=GameData.getAuxiliaryArmsLevel(GameData.currAuxArms),i?t<(o=GameConfig.GameConf.auxiliaryunlock.left)&&G.showToast({title:"Unlock after Special Weapon Attack Level "+o}):t<(o=GameConfig.GameConf.auxiliaryunlock.right)&&G.showToast({title:"Unlock after Special Weapon Attack Level "+o})},k.prototype.onTabItemClick=function(e,t){SoundManager.playSound(Model.AudioUrl.Click);var o=t;return 1==o&&0==GameData.currAuxArms?(G.showToast({title:"No special weapons were acquired"}),void(this.tabBarButtons[o].isChecked=!1)):0<(t=this.tabBarItems[o].unlockLevel)&&GameData.currLevel<t?(G.showToast({title:"Pass Level"+(t-1)+"to unlock"}),void(this.tabBarButtons[o].isChecked=!1)):void(this.selectedIndex!=o?(0<=this.selectedIndex&&(this.tabBarButtons[this.selectedIndex].isChecked=!1,this.tabBarNodes[this.selectedIndex].icon.active=!0,this.tabBarItems[this.selectedIndex].hide()),this.selectedIndex=o,this.tabBarButtons[o].isChecked=!0,this.tabBarNodes[o].icon.active=!1,window.adManager&&window.adManager.showInterstitial(),clearInterval(n),this.setTimeoutAD(),this.tabBarItems[o].show(),this.tabBarNodes[o].redTips.active=!1):(this.checkShowGiftNode(),this.tabBarNodes[this.selectedIndex].icon.active=!0,this.tabBarItems[this.selectedIndex].hide(),this.selectedIndex=-1))},k.prototype.onCloseTabBar=function(){this.checkShowGiftNode(),this.tabBarButtons[this.selectedIndex].isChecked=!1,this.tabBarNodes[this.selectedIndex].icon.active=!0,this.selectedIndex=-1},k.prototype.loadBundle=function(e,t){var o=this;cc.assetManager.loadBundle(e,function(i){i?(console.log("loadBundle fail.",JSON.stringify(i)),G.showModal({title:"Tips",content:"If the resource fails to be loaded, click Retry.",showCancel:!1,confirmText:"Retry",success:function(){o.loadBundle(e,t)}})):(console.log("loadBundle complete."),t())})},c([r({type:cc.Prefab,displayName:"currency Prefab"})],k.prototype,"currencyPrefab",void 0),c([r({type:cc.Prefab,displayName:"levelPrefab"})],k.prototype,"levelPrefab",void 0),c([r({type:cc.Prefab,displayName:"smallScenPrefab"})],k.prototype,"smallScenePrefab",void 0),c([r({type:cc.Node,tooltip:"Background watermarking"})],k.prototype,"watermark",void 0),c([r({type:S.default,tooltip:"tabBarItem"})],k.prototype,"tabBarItems",void 0),c([r({type:cc.Toggle,tooltip:"tabBarButton"})],k.prototype,"tabBarButtons",void 0),c([r({type:cc.Sprite,tooltip:"auxArmsicon"})],k.prototype,"auxArmsIcon",void 0),c([r({type:cc.Label,tooltip:"onlineGoldlabel"})],k.prototype,"onlineGoldLabel",void 0),c([r({type:cc.ProgressBar,tooltip:"online Progress Bar"})],k.prototype,"onlineProgressBar",void 0),c([r({type:sp.Skeleton,tooltip:"Hero spine"})],k.prototype,"roleSpine",void 0),c([r({type:sp.Skeleton,tooltip:"Pig Spine"})],k.prototype,"pigSpine",void 0),c([r({type:sp.Skeleton,tooltip:"grade spine"})],k.prototype,"gradeSpine",void 0),c([r({type:sp.Skeleton,tooltip:"Left Arms Spine"})],k.prototype,"leftArmsSpine",void 0),c([r({type:sp.Skeleton,tooltip:"Right Arms Spine"})],k.prototype,"rightArmsSpine",void 0),c([r({type:cc.Label,tooltip:"leftArmsCountLabel"})],k.prototype,"leftArmsCountLabel",void 0),c([r({type:cc.Label,tooltip:"Right Arms Count Label"})],k.prototype,"rightArmsCountLabel",void 0),c([r({type:cc.Node,tooltip:"iconStamina"})],k.prototype,"iconStamina",void 0),c([r({type:cc.Node,tooltip:"Start"})],k.prototype,"startBtn",void 0),c([r({type:cc.Node,tooltip:"Sign"})],k.prototype,"signBtn",void 0),c([r({type:cc.Node,tooltip:"Gift Btn"})],k.prototype,"giftBtn",void 0),c([r({type:cc.Label,tooltip:"Gift Gold Label"})],k.prototype,"giftGoldLabel",void 0),c([r({type:cc.Node,tooltip:"Task banner node"})],k.prototype,"taskBannerBtn",void 0),c([r({type:cc.Node,tooltip:"TaskReceiveTips node"})],k.prototype,"taskReceiveTips",void 0),c([r({type:cc.Label,tooltip:"TaskLeftTime label"})],k.prototype,"taskLeftTimeLabel",void 0),a=h=c([a],k),s.default=a,cc._RF.pop()},{}],MSGEvent:[function(e,t){"use strict";function o(){this.UPDATE_USERINFO="UPDATE_USERINFO",this.UPDATE_STAMINA="UPDATE_STAMINA",this.UPDATE_FIGHTPOWER="UPDATE_FIGHTPOWER",this.UPDATE_ROLEATK="UPDATE_ROLEATK",this.UPDATE_ROLELUCK="UPDATE_ROLELUCK",this.RECEIVE_ONLINE="RECEIVE_ONLINE",this.RECEIVE_GIFT="RECEIVE_GIFT",this.RECEIVE_TASK="RECEIVE_TASK",this.SHOW_SINGLECUSTOM="SHOW_SINGLECUSTOM",this.DELAY_TASK="DELAY_TASK",this.CHANGE_AUXILIARY="CHANGE_AUXILIARY",this.ITEM_CLICK="ITEM_CLICK",this.PROP_NOT_ENOUGH="PROP_NOT_ENOUGH",this.GEM_NOT_ENOUGH="GEM_NOT_ENOUGH",this.eventMap=new Map}cc._RF.push(t,"93402XvfjxHsKYPOKSglf/2","MSGEvent"),window.MSGEvent=(o.prototype.on=function(e,t,o,i){var n=this.eventMap.get(e);n?n.push({action:t,callback:o,target:i}):this.eventMap.set(e,n=[{action:t,callback:o,target:i}]),cc.Canvas.instance.node.on(t,o,i)},o.prototype.offAll=function(e){var t=this.eventMap.get(e);t&&(t.forEach(function(e){cc.Canvas.instance.node.off(e.action,e.callback,e.target)}),this.eventMap.delete(e))},o.prototype.sendEvent=function(e,t){(e=new cc.Event.EventCustom(e,!0)).setUserData(t),cc.Canvas.instance.node.dispatchEvent(e)},new o),cc._RF.pop()},{}],MatrixList:[function(e,t,o){"use strict";cc._RF.push(t,"035eeNRD99IfZR1wseaD5Hw","MatrixList");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c,d=a("BaseScript");function h(){return null!==l&&l.apply(this,arguments)||this}a=(n=cc._decorator).ccclass,n.property,s(h,l=d.default),(c=h).show=function(){GA.isWeChat()&&(l.isShown.call(this)||l.beginLoading.call(this)&&cc.resources.load("prefab/MatrixList",cc.Prefab,function(e,t){e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))}))},Object.defineProperty(h,"fileName",{get:function(){return"MatrixList"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"className",{get:function(){return c.fileName},enumerable:!1,configurable:!0}),h.prototype.onLoad=function(){this.pageName="Matrix lattice",l.prototype.onLoad.call(this),this.enterPage({existBanner:!1}),AdManager.showMatrixCustomAd()},h.prototype.start=function(){},h.prototype.close=function(e){l.prototype.close.call(this,e),AdManager.hideCustomAd(Model.AdTag.MatrixList)},a=c=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],h),r.default=a,cc._RF.pop()},{}],Model:[function(e,t){"use strict";cc._RF.push(t,"e2b4azj/kdCIqev39bJqwNr","Model");var o,i,n=t;(i=o=o||{}).check=function(){console.log("Model check.")},(n=i.LoginLogType||(i.LoginLogType={})).GetOpenId="GotOpenId",n.LaunchScene="LaunchScene",n.HomeStartGame="HomeStartGame",n.PlayGame="PlayGame",n.GameOver="GameEnd",n.VideoAdStart="TryPlayVideoAd",n.VideoAdSuccess="VideoAdSuccess",n.VideoAdFailure="VideoAdFailed",n.VideoAdMidClose="VideoAdClosed",n.VideoAdEndClose="VideoAdEnded",n.TryShareVideo="TryShareVideo",n.ShareVideoSuccess="ShareVideoSuccess",n.ShareVideoFailed="ShareVideoFailed",(n=i.EventType||(i.EventType={})).GameStart="GameStart",n.GameSuccess="GameSuccess",n.GameFailed="GameFailed",(i.PageName||(i.PageName={})).Lobby="Lobby",(n=i.AdTag||(i.AdTag={})).SingleCustom="SingleCustom",n.HorizontalList="HorizontalList",n.VerticalList="VerticalList",n.MatrixList="MatrixList",(n=i.GuideStep||(i.GuideStep={}))[n.None=0]="None",n[n.Attack=1]="Attack",n[n.AttackEnd=2]="AttackEnd",n[n.StartGame=3]="StartGame",n[n.StartClick=4]="StartClick",n[n.GradeCore=5]="GradeCore",n[n.GradeCoreClick=6]="GradeCoreClick",n[n.GradeAuxiliary=7]="GradeAuxiliary",n[n.GradeAuxiliaryClick=8]="GradeAuxiliaryClick",n[n.GradeProfit=9]="GradeProfit",n[n.GradeProfitClick=10]="GradeProfitClick",n[n.End=11]="End",(n=i.AudioUrl||(i.AudioUrl={})).BgmLobby="music/bgm_lobby",n.BgmGame="music/bgm_game",n.BgmBoss="music/bgm_boss",n.Win="music/win",n.Lose="music/lose",n.WinFlag="music/win_flag",n.Click="music/click",n.Grade="music/grade",n.Coin="music/coin",n.Round="music/round",n.Hit="music/hit",n.HitShield="music/hit_shield",n.HitBack="music/hit_back",n.HitLightningGrid="music/hit_lightning_grid",n.HitLightningX="music/hit_lightning_x",n.HitConnect="music/hit_connect",n.HitCursed="music/hit_cursed",n.Bomb="music/bomb",n.Appear="music/appear",n.LuckyAppear="music/lucky_appear",n.Recovery="music/recovery",n.Revive="music/revive",n.BuffPoisoning="music/buff_poisoning",n.BuffCount="music/buff_count",n.BuffElectric="music/buff_electric",n.BuffBurned="music/buff_burned",n.BuffFrozen="music/buff_frozen",n.FieryDragon="music/fiery_dragon",n.Die="music/die",n.IceBreak="music/ice_break",n.RockBreak="music/rock_break",n.Produce="music/produce",i.ExcelConfigUrls=[{key:"AdConfig",version:"1"},{key:"GameConfig",version:"1"},{key:"MainArms",version:"2"},{key:"Enemy",version:"1"},{key:"GameCoin",version:"2"},{key:"EnemyTips",version:"1"},{key:"TaskConfig",version:"1"},{key:"BuffConfig",version:"1"},{key:"AutomatedTesting",version:"1"},{key:"TestLevel",version:"1"},{key:"TestAuxiliaryType",version:"1"},{key:"AuxiliaryArms01",version:"2"},{key:"AuxiliaryArms02",version:"2"},{key:"AuxiliaryArms03",version:"2"}],i.LevelConfigUrls=[{key:"LevelConfig01",version:"2"}],i.FontAssets=[],i.GameResUrl="https://glyx.17tcw.com/GameRes/tanyitan/",window.Model=o,cc._RF.pop()},{}],OnlineNode:[function(e,t,o){"use strict";cc._RF.push(t,"54f06nZWCxOw4v2Csno1qxK","OnlineNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript"),u=n("RewardGoldTips");function p(){var e=null!==c&&c.apply(this,arguments)||this;return e.rewardLabel=null,e.leftLabel=null,e.rightLabel=null,e.progressBar=null,e.rewardGold=0,e.refreshTime=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(p,c=h.default),(d=p).show=function(){c.beginLoading.call(this)&&cc.resources.load("prefab/OnlineNode",cc.Prefab,function(e,t){e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))})},Object.defineProperty(p,"fileName",{get:function(){return"OnlineNode"},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),p.prototype.onLoad=function(){this.pageName="Piggy bank",c.prototype.onLoad.call(this),this.enterPage({existVideo:!0}),this.refreshRewardGold()},p.prototype.start=function(){},p.prototype.update=function(e){this.refreshTime+=e,10<=this.refreshTime&&(this.refreshTime=0,this.refreshRewardGold())},p.prototype.refreshRewardGold=function(){this.rewardGold=GameConfig.onlineRewardGold,this.rewardLabel.string=GA.formatNumber(this.rewardGold),this.progressBar.progress=this.rewardGold/GameConfig.onlineRewardMax},p.prototype.onReceiveClick=function(){var e=Date.now();6e4<e-d.lastReceiveTime?(d.lastReceiveTime=e,GA.clickEvent(this.pageName,this.pageName+"-Get","other"),this.requestReward(1)):G.showToast({title:"Too frequent. Please try again later."}),SoundManager.playSound(Model.AudioUrl.Click)},p.prototype.onDoubleClick=function(){var e=this;G.rewardOperation(this.pageName,this.pageName+"-Tenfold claim",function(){e.requestReward(10)})},p.prototype.requestReward=function(e){void 0===e&&(e=1);var t=GameData.gold;e=this.rewardGold*e,GameData.receiveOnlineReward(e),MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO,{before:t}),MSGEvent.sendEvent(MSGEvent.RECEIVE_ONLINE),u.default.show(e),GameData.completeTask(GameModel.TaskType.ReceiveOnline),this.close()},p.lastReceiveTime=0,l([a({type:cc.Label,tooltip:"Rewardlabel"})],p.prototype,"rewardLabel",void 0),l([a({type:cc.Label,tooltip:"left label"})],p.prototype,"leftLabel",void 0),l([a({type:cc.Label,tooltip:"right label"})],p.prototype,"rightLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"ProgressBar"})],p.prototype,"progressBar",void 0),n=d=l([n],p),r.default=n,cc._RF.pop()},{}],PauseNode:[function(e,t,o){"use strict";cc._RF.push(t,"681a1TvmfJPq73uwIpXXCl/","PauseNode");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c,d=a("BaseScript");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.closeCallback=null,e}a=(n=cc._decorator).ccclass,n.property,s(h,l=d.default),(c=h).show=function(e){c.instance?c.instance.showWithCallback(e):l.isShown.call(this)||l.beginLoading.call(this)&&cc.resources.load("prefab/PauseNode",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).getComponent(c).setData(e),cc.Canvas.instance.node.addChild(o))})},Object.defineProperty(h,"fileName",{get:function(){return"PauseNode"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"className",{get:function(){return c.fileName},enumerable:!1,configurable:!0}),h.prototype.setData=function(e){this.closeCallback=e},h.prototype.start=function(){},h.prototype.showWithCallback=function(e){this.closeCallback=e,this.node.active=!0},h.prototype.onContinueClick=function(){this.close(!1),this.closeCallback&&this.closeCallback(!1)},h.prototype.onHomeClick=function(){this.close(!1),this.closeCallback&&this.closeCallback(!0)},h.prototype.onMusicClick=function(){},h.instance=null,a=c=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],h),r.default=a,cc._RF.pop()},{}],PoolManager:[function(e,t,o){"use strict";cc._RF.push(t,"21279Pp0tJAdYTBvrD4IKdy","PoolManager");var i=e,n=o;Object.defineProperty(n,"__esModule",{value:!0});var a=i("Bullet");function r(){this.bulletPrefab=null,this.bulletPool=new cc.NodePool,this.spinePool=new cc.NodePool}Object.defineProperty(r,"instance",{get:function(){return r._instance=null==r._instance?new r:r._instance},enumerable:!1,configurable:!0}),r.prototype.initBulletPrefab=function(e){this.bulletPrefab=e},r.prototype.createBullet=function(){var e=null;return(e=0<this.bulletPool.size()?this.bulletPool.get().getComponent(a.default):a.default.create(this.bulletPrefab)).initialize(),e},r.prototype.recoveryBullet=function(e){this.bulletPool.put(e.node)},r.prototype.showEffect=function(e){var t=null;return e.delay&&0<e.delay?t=this.delayPlayEffectAni(e.parent,e.type,e.x,e.y,e.delay,e.aniName):(t=this.playEffectAni(e.parent,e.type,e.x,e.y,e.aniName,e.loop),e.size&&(t.scale=e.size)),e.type==GameModel.EffectType.Bomb&&SoundManager.playSoundSingle(Model.AudioUrl.Bomb),t&&(t.name=e.type),t},r.prototype.hideEffect=function(e){this.spinePool.put(e)},r.prototype.showEffectAni=function(e,t,o){var i,n=this,a=null;return 0<this.spinePool.size()?(a=this.spinePool.get(),cc.Tween.stopAllByTarget(a)):((i=(a=new cc.Node("node")).addComponent(sp.Skeleton)).setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.premultipliedAlpha=!1,i.setEndListener(function(){i.loop||n.hideEffect(i.node)})),a.setPosition(t,o),a.scale=1,a.angle=0,a.zIndex=0,e.addChild(a),a},r.prototype.loadAnimation=function(e,t,o,i){Utils.getSubgame().load(e,sp.SkeletonData,function(n,a){n?console.warn("not found ani:",e):(t.node.active=!0,t.skeletonData=a,t.setAnimation(0,o||"animation",i))})},r.prototype.delayPlayEffectAni=function(e,t,o,i,n,a){var r=this,s=(i=this.showEffectAni(e,o,i)).getComponent(sp.Skeleton);return s.loop=!1,s.skeletonData&&s.setAnimation(0,"animation",s.loop),i.active=!1,cc.Canvas.instance.scheduleOnce(function(){r.loadAnimation("effect/"+t+"/skeleton",s,a,s.loop)},n),i},r.prototype.playEffectAni=function(e,t,o,i,n,a){return(i=(o=this.showEffectAni(e,o,i)).getComponent(sp.Skeleton)).loop=null!=a&&a,i.skeletonData&&i.setAnimation(0,"animation",i.loop),o.active=!1,this.loadAnimation("effect/"+t+"/skeleton",i,n,i.loop),o},r.prototype.clear=function(){this.bulletPool.clear(),this.spinePool.clear()},r._instance=null,i=r,n.default=i,cc._RF.pop()},{}],PrivacyNode:[function(e,t,o){"use strict";cc._RF.push(t,"e2f8ekeXWNKgpabvldm9Pts","PrivacyNode");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(d=cc._decorator).ccclass;var l,c,d=d.property;function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.bShowWeb=!1,e.webNode=null,e}r(h,l=cc.Component),(c=h).show=function(e){void 0===e&&(e=!1),cc.resources.load("prefab/PrivacyNode",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).zIndex=GameModel.SceneTopZIndex,o.getComponent(c).setData(e),cc.Canvas.instance.node.addChild(o))})},h.prototype.setData=function(e){this.bShowWeb=e},h.prototype.onLoad=function(){this.bShowWeb||this.closeWeb()},h.prototype.start=function(){},h.prototype.close=function(){this.node.destroy()},h.prototype.onViewClick=function(){this.showWeb()},h.prototype.onRefuseClick=function(){try{GA.PA.exitApplication({})}catch(e){console.warn(JSON.stringify(e))}},h.prototype.onAgreeClick=function(){this.close()},h.prototype.showWeb=function(){this.webNode.active=!0},h.prototype.closeWeb=function(){this.webNode.active=!1,this.bShowWeb&&this.close()},h.prototype.onCloseWeb=function(){this.closeWeb()},s([d({type:cc.Node})],h.prototype,"webNode",void 0),n=c=s([n],h),a.default=n,cc._RF.pop()},{}],ProfitNode:[function(e,t,o){"use strict";cc._RF.push(t,"4a0a9Btt0ZMdI7Wb5tujx1V","ProfitNode");var i,n,a=e,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(r,"__esModule",{value:!0});var l,c=a("TabBarItem");function d(){return null!==l&&l.apply(this,arguments)||this}a=(n=cc._decorator).ccclass,n.property,s(d,l=c.default),d.prototype.onLoad=function(){l.prototype.onLoad.call(this),this.refreshWinRewardGradeInfo(),this.refreshOnlineGradeInfo()},d.prototype.onAtkGrade=function(){},d.prototype.onLuckGrade=function(){},d.prototype.refreshWinRewardGradeInfo=function(){},d.prototype.refreshOnlineGradeInfo=function(){},a=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r}([a],d),r.default=a,cc._RF.pop()},{}],ProjectConfig:[function(e,t){"use strict";function o(){this.Debug=!1,this.NoAd=!1,this.AppName="Pinball Legends",this.AppChannel="krq_tdd",this.AdConfig=null,this.AdConfig={},this.AdConfig.BannerUpdateTimes=3}cc._RF.push(t,"39f8cthx0xJ+5SjsB07tr9W","ProjectConfig"),window.ProjectConfig=(o.prototype.check=function(){console.log("ProjectConfig is ok."),GA.isPlatform([GA.Platform.OPPO,GA.Platform.Vivo])&&(this.AdConfig.BannerUpdateTimes=99999)},new o),cc._RF.pop()},{}],RecorderManager:[function(e,t){"use strict";function o(){this.videoRecorder=null,this.isRecording=!1,this.videoPath=null,this.videoClipList=null,this.startTime=0,this.videoTime=0,this.clipStartTime=0,this.pulishSuccess=null,this.mOnStopListener=null}cc._RF.push(t,"aa445apRElJ8LVQ6YOT5wZo","RecorderManager"),window.RecorderManager=(o.prototype.check=function(){console.log("RecorderManager is ok.")},Object.defineProperty(o.prototype,"isValid",{get:function(){return null!=this.videoRecorder},enumerable:!1,configurable:!0}),o.prototype.init=function(){var e=this;GA.isPlatform([GA.Platform.ByteDance,GA.Platform.Kwaigame,GA.Platform.WeChat])&&(G.isByteDance()?(this.videoRecorder=GA.PA.getGameRecorderManager(),this.videoRecorder.onStart(function(){console.log("Recorder onStart"),e.startTime=Date.now()}),this.videoRecorder.onStop(function(t){var o=Date.now()-e.startTime;console.log("Recorder onStop. duration="+o),o<3e3||e.clipVideo(t.videoPath)||(e.videoTime=o,console.log("Recorder Time:"+e.videoTime),e.videoPath=t.videoPath,e.mOnStopListener&&e.mOnStopListener({videoPath:t.videoPath,duration:e.videoTime}))}),this.videoRecorder.onError(function(e){console.log("Recorder Error: "+e.errMsg)})):(this.videoRecorder=GA.PA.getGameRecorder(),this.videoRecorder.on("start",function(){console.log("Recorder onStart"),e.startTime=Date.now()}),this.videoRecorder.on("stop",function(t){e.videoTime=Date.now()-e.startTime,console.log("Recorder Time:"+e.videoTime),e.isValidVideo()&&(e.videoPath=t.videoID,e.mOnStopListener&&e.mOnStopListener({videoPath:t.videoID,duration:e.videoTime}))}),this.videoRecorder.on("error",function(e){console.log("Recorder Error: "+e.message)})))},o.prototype.clipVideo=function(e){var t=this;if(0<this.clipStartTime){var o=Date.now(),i=Math.floor((o-this.clipStartTime)/1e3);if(3<=i)return(n=this.videoRecorder).clipVideo({path:e,timeRange:[i,0],clipRange:null,success:function(e){console.log("clip video success."),t.videoTime=1e3*i,console.log("Recorder Time:"+t.videoTime),t.videoPath=e.videoPath,t.mOnStopListener&&t.mOnStopListener({videoPath:e.videoPath,duration:t.videoTime})},fail:function(e){console.warn(e)}}),!0}else if(this.videoClipList&&0<this.videoClipList.length){var n=this.videoRecorder;return console.log("this.videoClipList",this.videoClipList),n.clipVideo({path:e,timeRange:null,clipRange:this.videoClipList,success:function(e){console.log("clip video success."),t.videoPath=e.videoPath,t.mOnStopListener&&t.mOnStopListener({videoPath:e.videoPath,duration:t.videoTime})},fail:function(e){console.warn(e)}}),!0}return!1},o.prototype.isValidVideo=function(){return 3e3<=this.videoTime},o.prototype.setVideoPath=function(e){e&&(this.videoPath=e)},o.prototype.setVideoList=function(e){var t=this;this.videoClipList?this.videoClipList.splice(0):this.videoClipList=[];var o=0;e.forEach(function(e){o<15&&(o+=e.duration,e.path?t.videoClipList.push(e.path):t.videoClipList.push(e.index))}),console.log("video time:",o)},o.prototype.start=function(){!this.isRecording&&GA.isPlatform([GA.Platform.ByteDance,GA.Platform.Kwaigame])&&(console.log("Recorder start"),this.isRecording=!0,this.videoTime=0,this.clipStartTime=0,this.videoRecorder?this.videoRecorder.start({duration:300}):console.log("RecorderManager has not been initialized."))},o.prototype.stop=function(e){if(this.isRecording)try{console.log("Recorder stop"),this.isRecording=!1,this.videoRecorder?this.videoRecorder.stop():console.log("RecorderManager has not been initialized."),this.mOnStopListener=e}catch(e){console.warn(e)}},o.prototype.pause=function(){this.videoRecorder&&(console.log("Recorder pause"),this.videoRecorder.pause())},o.prototype.resume=function(){this.videoRecorder&&(console.log("Recorder resume"),this.videoRecorder.resume())},o.prototype.interrupt=function(){console.log("Recorder interrupt"),this.stop()},o.prototype.recordClipTime=function(){this.videoRecorder&&0==this.clipStartTime&&(this.clipStartTime=Date.now()-5e3)},o.prototype.shareVideo=function(e){GA.isPlatform([GA.Platform.ByteDance,GA.Platform.Kwaigame])&&(G.pushEvent(Model.LoginLogType.TryShareVideo),this.pulishSuccess=function(){e&&e()},this.isValidVideo()?G.isByteDance()?this.sharePublishVideo():G.isKwaigame()&&this.publishVideo():(G.pushEvent(Model.LoginLogType.ShareVideoFailed,{errMsg:"Screen-recording failure"}),G.showModal({title:"Tips",content:"Sharing failed because the screen recording time is too short"})))},o.prototype.shareVideoList=function(e){GA.isPlatform([GA.Platform.ByteDance,GA.Platform.Kwaigame])&&(G.pushEvent(Model.LoginLogType.TryShareVideo),this.pulishSuccess=function(){e&&e()},this.videoClipList&&0<this.videoClipList.length?G.isByteDance()?this.sharePublishVideo():G.isKwaigame()&&(console.log("this.videoClipList",this.videoClipList),this.publishVideo(this.videoClipList.reverse())):(G.pushEvent(Model.LoginLogType.ShareVideoFailed,{errMsg:"Screen-recording failure"}),G.showModal({title:"Tips",content:"Sharing failed because the screen recording time is too short"})))},o.prototype.showPublishCancel=function(){G.pushEvent(Model.LoginLogType.ShareVideoFailed,{errMsg:"Failed to share the screen recording. Procedure"}),G.showToast({title:"Release and record the screen successfully will be rewarded."})},o.prototype.sharePublishVideo=function(){var e=this;G.showLoading("Share in preparation");var t=ProjectConfig.AppChannel+"=10002";t="openid="+G.openId+"&tm="+Date.now()+"&"+t,GA.PA.shareAppMessage({channel:"video",title:ProjectConfig.AppName,desc:"",templateId:"",query:t,extra:{withVideoId:!0,videoPath:this.videoPath,videoTopics:[ProjectConfig.AppName],hashtag_list:[ProjectConfig.AppName],createChallenge:!1},success:function(){G.hideLoading(),G.pushEvent(Model.LoginLogType.ShareVideoSuccess),e.pulishSuccess&&e.pulishSuccess()},fail:function(){G.hideLoading(),e.showPublishCancel()}})},o.prototype.publishVideo=function(e){var t=this;G.showLoading("Share in preparation"),this.videoRecorder.publishVideo({mouldId:"2300002291",video:null!=e?e:this.videoPath,callback:function(e){G.hideLoading(),e?(console.log("Recorder Error: "+JSON.stringify(e)),t.showPublishCancel()):(console.log("Sharing the screen succeeded"),G.pushEvent(Model.LoginLogType.ShareVideoSuccess),t.pulishSuccess&&t.pulishSuccess())}})},new o),cc._RF.pop()},{}],Recorder:[function(e,t,o){"use strict";cc._RF.push(t,"c0c60f8rsVK25sHhbUHA60O","Recorder");var i,n=t,a=o;function r(e){this.manager=null,this.state=i.Ready,this.recorderStartTime=0,this.recorderVideoList=[],this.manager=e}Object.defineProperty(a,"__esModule",{value:!0}),(n=i=i||{})[n.Ready=1]="Ready",n[n.Recording=2]="Recording",n[n.Pause=3]="Pause",n[n.Stop=4]="Stop",r.create=function(e){return new r(e)},r.prototype.initialize=function(){RecorderManager.isValid&&(this.state=i.Ready,this.recorderVideoList.splice(0))},r.prototype.isReady=function(){return this.state==i.Ready},r.prototype.isRecording=function(){return this.state==i.Recording},r.prototype.isPause=function(){return this.state==i.Pause},r.prototype.isStop=function(){return this.state==i.Stop},r.prototype.start=function(){RecorderManager.isValid&&(G.isKwaigame()?RecorderManager.start():(this.isPause()?RecorderManager.resume():RecorderManager.start(),this.recorderStartTime=Date.now()),this.state=i.Recording)},r.prototype.pause=function(){var e,t,o=this;RecorderManager.isValid&&(this.isRecording()?(this.state=i.Pause,G.isKwaigame()?RecorderManager.stop(function(e){var t=o.manager;t.hitCount>t.maxHitCount&&(t.maxHitCount=t.hitCount,o.recorderVideoList.unshift({path:e.videoPath,duration:e.duration/1e3}),3<o.recorderVideoList.length&&o.recorderVideoList.pop())}):(RecorderManager.pause(),(e=this.manager).hitCount>e.maxHitCount&&(e.maxHitCount=e.hitCount,e=Date.now(),t=Math.floor((e-this.recorderStartTime)/1e3),RecorderManager.videoRecorder.recordClip({timeRange:[t,0],success:function(e){o.recorderVideoList.unshift({index:e.index,duration:t}),3<o.recorderVideoList.length&&o.recorderVideoList.pop()}})))):console.log("The recording has stopped."))},r.prototype.stop=function(){RecorderManager.isValid&&(this.state=i.Stop,RecorderManager.setVideoList(this.recorderVideoList),RecorderManager.stop())},n=r,a.default=n,cc._RF.pop()},{}],Revive:[function(e,t,o){"use strict";cc._RF.push(t,"0c0421ayyRF8Lm96iefKDwi","Revive");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.timerLabel=null,e.giveUpBtn=null,e.validTime=0,e.paused=!1,e.reviveCallback=null,e}r(d,l=cc.Component),d.prototype.onLoad=function(){this.pageName="Revive",G.isByteDance()?this.giveUpBtn.active=!0:this.giveUpBtn.active=!1},d.prototype.start=function(){},d.prototype.hide=function(){this.node.active=!1},d.prototype.update=function(e){this.node.active&&0<=this.validTime&&!this.paused&&(this.validTime-=e,this.refreshProgressBar(),this.validTime<=0&&this.close(!1))},d.prototype.close=function(e){this.hide(),this.reviveCallback(e),G.closePage({page:this.pageName})},d.prototype.showWithCallback=function(e){this.reviveCallback=e,this.node.active=!0,this.paused=!1,this.validTime=6,this.refreshProgressBar(),G.enterPage({page:this.pageName,existBanner:!1,existVideo:!0})},d.prototype.onReviveClick=function(){var e=this;this.paused=!0,AdManager.showVideoAd(this.pageName,"Revive",function(){e.paused=!1,e.close(!0)},function(){e.paused=!1},function(){e.paused=!1,G.showToast({title:"Sorry, there are no video ads"})})},d.prototype.onGiveUpClick=function(){this.paused=!1,this.close(!1),GA.clickEvent(this.pageName,"Give up","other"),SoundManager.playSound(Model.AudioUrl.Click)},d.prototype.refreshProgressBar=function(){var e=Math.ceil(this.validTime);this.timerLabel.string=""+e},s([c({type:cc.Label,tooltip:"Timerlabel"})],d.prototype,"timerLabel",void 0),s([c({type:cc.Node,tooltip:"giveUpbutton"})],d.prototype,"giveUpBtn",void 0),n=s([n],d),a.default=n,cc._RF.pop()},{}],RewardBox:[function(e,t,o){"use strict";cc._RF.push(t,"fcb633dRLRCP4pUvn1sF4hd","RewardBox");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h,u=n("BaseScript"),p=n("RewardGoldTips");function f(){var e=null!==d&&d.apply(this,arguments)||this;return e.spineList=[],e.clickGetTips=null,e.btnGetAll=null,e.btnGetone=null,e.isOpened=!1,e.isAllOpened=!1,e.rewardType=0,e.clickIndex=0,e.rewardList=[],e.closeCallback=null,e}(a=c=c||{})[a.High=1]="High",a[a.Middle=2]="Middle",a[a.Low=3]="Low",a=(n=cc._decorator).ccclass,n=n.property,s(f,d=u.default),(h=f).show=function(e){h.instance?h.instance.showWithCallback(e):d.isShown.call(this)||d.beginLoading.call(this)&&cc.resources.load("prefab/RewardBox",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).zIndex=GameModel.SceneTopZIndex,cc.Canvas.instance.node.addChild(o),o.getComponent(h).showWithCallback(e))})},Object.defineProperty(f,"fileName",{get:function(){return"RewardBox"},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"className",{get:function(){return h.fileName},enumerable:!1,configurable:!0}),f.prototype.onLoad=function(){(h.instance=this).pageName="Mystery chest",d.prototype.onLoad.call(this);for(var e=1;e<=3;e++){var t=this.node.getChildByName("reward_gold_"+e),o=t.getChildByName("reward_label").getComponent(cc.Label),i=t.getChildByName("reward_got");this.rewardList.push({node:t,label:o,reward_got:i,posx:t.x,type:e})}GameInfo.isShowTextButton()||this.btnGetone.loadSubpackageImage("game/btn_getone")},f.prototype.start=function(){},f.prototype.showWithCallback=function(e){this.closeCallback=e,this.node.active=!0,this.isOpened=!1,this.isAllOpened=!1,this.rewardList.sort(function(e,t){return e.type<t.type?-1:e.type>t.type?1:0}),e=GameData.currLevel-1,e=15*GameConfig.getCoinCostInfo(e).winreward,this.rewardList[0].reward=Math.floor(.5*e),this.rewardList[1].reward=Math.floor(.3*e),this.rewardList[2].reward=Math.floor(.2*e),this.rewardList.forEach(function(e){e.label.string=GA.formatNumber(e.reward),e.reward_got.active=!1,e.node.active=!1,e.node.x=e.posx}),this.clickGetTips.active=!0,this.btnGetAll.active=this.btnGetone.node.active=!1,this.spineList.forEach(function(e){e.setAnimation(0,"chuxian",!1),e.setCompleteListener(function(){e.setCompleteListener(null),e.setAnimation(0,"daiji",!0)})}),this.enterPage({existBanner:!0,existVideo:!0})},f.prototype.close=function(){d.prototype.close.call(this,!1),this.closeCallback&&this.closeCallback()},f.prototype.onCloseClick=function(){GA.clickEvent(this.pageName,"Take only one","other"),this.close(),SoundManager.playSound(Model.AudioUrl.Click)},f.prototype.onRandomClick=function(){var e=ex.rand(0,2);this.playOpenAnimation(e),GA.clickEvent(this.pageName,"Click text","other")},f.prototype.onBoxClick=function(e,t){this.playOpenAnimation(t),GA.clickEvent(this.pageName,"Click treasure chest","other")},f.prototype.playOpenAnimation=function(e){var t,o=this;this.isOpened||(this.isOpened=!0,(t=this.spineList[e]).setCompleteListener(function(){t.setCompleteListener(null),o.randomReward(e)}),t.setAnimation(0,"dakai",!1))},f.prototype.randomReward=function(e){var t=this,o=ex.rand(1,100),i=o<=10?c.High:o<=20?c.Middle:c.Low;console.log("reward type:",i);var n=i-1;this.rewardType=i,this.clickIndex=e,o=this.rewardList[n],i=this.rewardList[e],this.rewardList[n]=i,(this.rewardList[e]=o).node.active=!0,o.node.x=i.posx,i.node.x=o.posx,this.scheduleOnce(function(){t.showGetAll()},1),GameData.addGold(o.reward),p.default.show(o.reward)},f.prototype.showGetAll=function(){var e=this;this.clickGetTips.active=!1,this.btnGetAll.active=this.btnGetone.node.active=!0,this.rewardList[this.clickIndex].reward_got.active=!0;var t=null;this.spineList.forEach(function(o,i){i!=e.clickIndex&&(o.setAnimation(0,"dakai",!1),t=t||o)}),t.setCompleteListener(function(){t.setCompleteListener(null),e.rewardList.forEach(function(e){e.node.active=!0})})},f.prototype.onGetAllClick=function(){var e=this;this.isAllOpened||G.rewardOperation(this.pageName,"Get All",function(){e.isAllOpened=!0,e.requestReward()})},f.prototype.requestReward=function(){var e=this,t=0;this.rewardList.forEach(function(o){o.type!=e.rewardType&&(t+=o.reward,o.reward_got.active=!0)}),GameData.addGold(t),p.default.show(t),this.scheduleOnce(function(){e.close()},2)},f.instance=null,l([n({type:sp.Skeleton,tooltip:"spineList"})],f.prototype,"spineList",void 0),l([n({type:cc.Node,tooltip:"ClickGetTips"})],f.prototype,"clickGetTips",void 0),l([n({type:cc.Node,tooltip:"GetAll"})],f.prototype,"btnGetAll",void 0),l([n({type:cc.Sprite,tooltip:"Close"})],f.prototype,"btnGetone",void 0),a=h=l([a],f),r.default=a,cc._RF.pop()},{}],RewardGoldTips:[function(e,t,o){"use strict";cc._RF.push(t,"010b2ElbB1Lk5gbq0i+PPvT","RewardGoldTips");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.rewardGold=0,e.goldLabel=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(e){var t;!c.isShown.call(this)&&c.beginLoading.call(this)&&(t="prefab",GameInfo.isShowNativedAd()&&(t="oppo"),cc.resources.load(t+"/RewardGoldTips",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).zIndex=GameModel.SceneTopZIndex,o.getComponent(d).setData(e),cc.Canvas.instance.node.addChild(o))}))},Object.defineProperty(u,"fileName",{get:function(){return"RewardGoldTips"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),u.prototype.setData=function(e){this.rewardGold=e},u.prototype.onLoad=function(){this.pageName="Get a reward",c.prototype.onLoad.call(this),this.enterPage(),this.goldLabel.string="x"+GA.formatNumber(this.rewardGold),this.initOPPO(!0)},u.prototype.start=function(){},l([a({type:cc.Label,tooltip:"Rewardlabel"})],u.prototype,"goldLabel",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],RewardTips:[function(e,t,o){"use strict";cc._RF.push(t,"96e36+SRCtHzJ3Op2cToUH4","RewardTips");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.spine=null,e.nameLabel=null,e.describe=null,e.currAuxArms=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(e){c.isShown.call(this)||c.beginLoading.call(this)&&cc.resources.load("prefab/RewardTips",cc.Prefab,function(t,o){t?cc.error(t):((o=cc.instantiate(o)).zIndex=GameModel.SceneTopZIndex,o.getComponent(d).setData(e),cc.Canvas.instance.node.addChild(o))})},Object.defineProperty(u,"fileName",{get:function(){return"RewardTips"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),u.prototype.setData=function(e){this.currAuxArms=e},u.prototype.onLoad=function(){this.pageName="Congratulations on winning",c.prototype.onLoad.call(this),this.enterPage();var e=""+this.currAuxArms;Utils.loadSubpackageImage("home/arms_desc/"+this.currAuxArms,this.describe),this.spine.setAttachment("weapon",e),e=GameConfig.getAuxiliaryArmsInfo(this.currAuxArms,1),this.nameLabel.string=e.name},u.prototype.start=function(){},u.prototype.onUseClick=function(){GameData.useAuxiliary(this.currAuxArms),MSGEvent.sendEvent(MSGEvent.CHANGE_AUXILIARY),G.showToast({title:"Successful switchover"}),this.close()},l([a({type:sp.Skeleton,tooltip:"Animation"})],u.prototype,"spine",void 0),l([a({type:cc.Label,tooltip:"Name"})],u.prototype,"nameLabel",void 0),l([a({type:cc.Sprite,tooltip:"Describe"})],u.prototype,"describe",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],RippleShaderTime:[function(e,t,o){"use strict";cc._RF.push(t,"671013Pg4FFapquIGTPPqt7","RippleShaderTime");var i,n=t,a=o,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),n=(c=cc._decorator).ccclass;var l,c=c.property;function d(){var e=null!==l&&l.apply(this,arguments)||this;return e._material=null,e._max=1,e._start=0,e}r(d,l=cc.Component),Object.defineProperty(d.prototype,"max",{get:function(){return this._max},set:function(e){this._max=e},enumerable:!1,configurable:!0}),d.prototype.update=function(e){this._material||(this._material=this.node.getComponent(cc.Sprite).getMaterial(0)),this.node.active&&this._material&&this._setShaderTime(e)},d.prototype._setShaderTime=function(){var e=this._start;e>this.max&&(e=0),this._material.setProperty("timeTest",e+=.015),this._start=e},s([c],d.prototype,"_max",void 0),s([c],d.prototype,"max",null),n=s([n],d),a.default=n,cc._RF.pop()},{}],SettingNode:[function(e,t,o){"use strict";cc._RF.push(t,"92c105CvjBFqKAWHuZgTp0i","SettingNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("PrivacyNode"),h=n("TabBarItem");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.itemTemplate=null,e.uidLabel=null,e.versionLabel=null,e.privacyBtn=null,e.itemNodes=[],e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),u.prototype.onLoad=function(){c.prototype.onLoad.call(this);for(var e=this.content.height/2+200,t=this.itemTemplate.height,o=1;o<3;o++){var i=cc.instantiate(this.itemTemplate);i.y=e-o*(t+20),this.content.addChild(i),this.addItem(i)}this.itemTemplate.active=!1,this.uidLabel.string="PlayerID:"+G.uid,this.versionLabel.string="1.0.3",G.isOPPOVivo()||this.privacyBtn.destroy()},u.prototype.addItem=function(e){var t=this.itemNodes.length,o=e.getChildByName("title").getComponent(cc.Sprite),i=e.getChildByName("switch_btn").getComponent(cc.Toggle);this.itemNodes.push({title:o,toggle:i}),e=t+1,o.loadSubpackageImage("home/setting/title_"+e),i.checkEvents[0].customEventData=""+t,i.isChecked=!this.switchOpened(e)},u.prototype.switchOpened=function(e){return e==GameModel.SettingType.Music?GameData.settingData.music==GameModel.SettingState.Opened:e==GameModel.SettingType.Effect?GameData.settingData.sound==GameModel.SettingState.Opened:e==GameModel.SettingType.KillVibrate&&GameData.settingData.kill_vibrate==GameModel.SettingState.Opened},u.prototype.onSwitchClick=function(e,t){t=parseInt(t)+1,GameData.changeSetting(t),GA.clickEvent(this.pageName,"Switch","other","index:"+t),SoundManager.playSound(Model.AudioUrl.Click)},u.prototype.onPrivacyClick=function(){d.default.show(!0)},l([a({type:cc.Node,displayName:"Listitem"})],u.prototype,"itemTemplate",void 0),l([a({type:cc.Label,tooltip:"uid label"})],u.prototype,"uidLabel",void 0),l([a({type:cc.Label,tooltip:"version label"})],u.prototype,"versionLabel",void 0),l([a({type:cc.Node,tooltip:"Privacy policy button"})],u.prototype,"privacyBtn",void 0),n=l([n],u),r.default=n,cc._RF.pop()},{}],ShareNode:[function(e,t,o){"use strict";cc._RF.push(t,"5354aJH7u5JUYBQzCDGmqJg","ShareNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("DoubleHit"),u=n("BaseScript"),p=n("SmallScene");function f(){var e=null!==c&&c.apply(this,arguments)||this;return e.hitCount=0,e.closeCallback=null,e.smallScenePrefab=null,e.goldLabel=null,e.doubleHit=null,e.rewardGold=0,e.currLevel=0,e}n=(a=cc._decorator).ccclass,a=a.property,s(f,c=u.default),(d=f).show=function(e,t){c.isShown.call(this)||c.beginLoading.call(this)&&cc.resources.load("prefab/ShareNode",cc.Prefab,function(o,i){o?cc.error(o):((i=cc.instantiate(i)).getComponent(d).setData(e,t),cc.Canvas.instance.node.addChild(i))})},Object.defineProperty(f,"fileName",{get:function(){return"ShareNode"},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),f.prototype.setData=function(e,t){this.hitCount=e,this.closeCallback=t},f.prototype.onLoad=function(){this.pageName="Hot on the Internet",c.prototype.onLoad.call(this),this.enterPage(),this.currLevel=GameData.currLevel-1,this.initSmallScene();var e=GameConfig.getCoinCostInfo(this.currLevel).online/300;this.rewardGold=Math.ceil(14400*e),this.goldLabel.string="+"+GA.formatNumber(this.rewardGold)},f.prototype.start=function(){this.doubleHit.refreshHitLabel(this.hitCount)},f.prototype.initSmallScene=function(){var e=p.default.create(this.smallScenePrefab,this.currLevel,!1);e.node.scale=1.5,this.content.addChild(e.node),e.node.setSiblingIndex(0)},f.prototype.close=function(e){c.prototype.close.call(this,e),this.closeCallback()},f.prototype.onShareClick=function(){var e=this;RecorderManager.shareVideoList(function(){e.close(),GameData.addGold(e.rewardGold),G.showToast({title:"Congratulations on winning"+e.rewardGold+"Gold coin"})})},l([a({type:cc.Prefab,displayName:"Small scene Prefab"})],f.prototype,"smallScenePrefab",void 0),l([a({type:cc.Label,tooltip:"Rewardlabel"})],f.prototype,"goldLabel",void 0),l([a({type:h.default,tooltip:"doubleHitlabel"})],f.prototype,"doubleHit",void 0),n=d=l([n],f),r.default=n,cc._RF.pop()},{}],SignNode:[function(e,t,o){"use strict";cc._RF.push(t,"478257j2HxEiamjUQo9GBjc","SignNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("BaseScript");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.itemTemplate=null,e.item7=null,e.btnSign=null,e.signItems=[],e.rewardList=[],e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=h.default),(d=u).show=function(){c.beginLoading.call(this)&&(G.showLoading(),cc.resources.load("prefab/SignNode",cc.Prefab,function(e,t){G.hideLoading(),e?cc.error(e):(t=cc.instantiate(t),cc.Canvas.instance.node.addChild(t))}))},Object.defineProperty(u,"fileName",{get:function(){return"SignNode"},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),u.prototype.onLoad=function(){var e=this;this.pageName="Sign in",c.prototype.onLoad.call(this),this.enterPage({existBanner:!1,existVideo:!0}),this.initData(),this.addItem(this.itemTemplate);for(var t=this.itemTemplate.width+8,o=this.itemTemplate.height+6,i=cc.v2(-t,o-15),n=1;n<6;n++){var a=n%3,r=Math.floor(n/3),s=cc.instantiate(this.itemTemplate);s.setPosition(i.x+t*a,i.y-o*r),this.content.addChild(s),this.addItem(s)}this.itemTemplate.setPosition(i.x,i.y),this.addItem(this.item7),this.signItems.forEach(function(t,o){var i=o+1;t.dayLabel.string="Day"+i,t.today.active=!1,o=e.rewardList[o],t.rewardLabel.string=GA.formatNumber(o.gold),i<7&&(0<o.arms?(t.rewardLabel.node.active=!1,t.rewardNameLabel.active=!0,Utils.loadSubpackageImage("prefab/sign_arms_"+o.arms,t.rewardIcon)):(t.rewardLabel.node.active=!0,t.rewardNameLabel.active=!1)),i<=GameData.signday?t.cover.active=t.signed.active=!0:t.cover.active=t.signed.active=!1});var l,d=this.rewardList[6];d&&0==d.arms&&((l=this.signItems[6]).rewardIcon.node.x=l.rewardLabel.node.x=0,l.addIcon.active=l.rightIcon.node.active=l.rightNameLabel.active=!1),GameConfig.signed||(l=GameData.signday+1,this.signItems[l-1].today.active=!0),this.btnSign.active=!GameConfig.signed},u.prototype.start=function(){},u.prototype.initData=function(){var e,t;t=1==GameData.signgroup?(e=Math.max(50,GameData.currLevel),e=50*Math.floor(e/50),GameConfig.getCoinCostInfo(e).winreward):GameConfig.getCoinCostInfo(50).winreward;for(var o=[8,12,20,24,28,32,40],i=0;i<7;i++)this.rewardList.push({gold:o[i]*t,arms:0})},u.prototype.addItem=function(e){var t=e.getChildByName("day_label").getComponent(cc.Label),o=e.getChildByName("reward_gold").getComponent(cc.Sprite),i=e.getChildByName("reward_label").getComponent(cc.Label),n=e.getChildByName("reward_name"),a=e.getChildByName("sign_item_today"),r=e.getChildByName("sign_cover"),s=e.getChildByName("signed"),l=e.getChildByName("icon_add"),c=null===(c=e.getChildByName("right_reward_arms"))||void 0===c?void 0:c.getComponent(cc.Sprite);e=e.getChildByName("right_reward_name"),this.signItems.push({dayLabel:t,rewardIcon:o,rewardLabel:i,rewardNameLabel:n,today:a,cover:r,signed:s,addIcon:l,rightIcon:c,rightNameLabel:e})},u.prototype.onSignClick=function(){var e=this;G.rewardOperation(this.pageName,this.pageName+"-Sign in",function(){e.requestReward(),e.requestSign()}),SoundManager.playSound(Model.AudioUrl.Click)},u.prototype.requestSign=function(){this.btnSign.active=!1;var e=GameData.signday;(e=this.signItems[e]).cover.active=e.signed.active=!0,GameConfig.signed=!0,GameData.signIn(),G.showToast({title:"Congratulations on getting the sign-in bonus"})},u.prototype.requestReward=function(e){void 0===e&&(e=1);var t=GameData.signday,o=this.rewardList[t];t=GameData.gold,e=o.gold*e,MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO,{before:t}),GameData.addGold(e),0<o.arms&&GameData.unlockAuxiliary(o.arms)},l([a({type:cc.Node,tooltip:"Listitem"})],u.prototype,"itemTemplate",void 0),l([a({type:cc.Node,tooltip:"Day 7"})],u.prototype,"item7",void 0),l([a({type:cc.Node,tooltip:"Signbtn"})],u.prototype,"btnSign",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],SmallScene:[function(e,t,o){"use strict";cc._RF.push(t,"afffbClovJETZ2JZIAFMZG3","SmallScene");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("RippleShaderTime");function u(){var e=null!==c&&c.apply(this,arguments)||this;return e.currLevel=0,e.isLobby=!1,e.sceneBg=null,e.rippleMaterial=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(u,c=cc.Component),(d=u).create=function(e,t,o){return void 0===o&&(o=!0),(e=cc.instantiate(e).getComponent(d)).setData(t,o),e},u.prototype.setData=function(e,t){this.currLevel=null!=e?e:GameData.currLevel,this.isLobby=t},u.prototype.onLoad=function(){this.isLobby&&(this.node.addComponent(h.default).max=10,this.sceneBg.setMaterial(0,this.rippleMaterial)),this.initLevel()},u.prototype.start=function(){},u.prototype.initLevel=function(){var e=this.currLevel,t=GameConfig.getCurrentScene(e);Utils.loadSubpackageImage("home/scene"+t+"_bg",this.sceneBg);for(var o=GameConfig.getLevelInfo(e).enemy[0],i=[],n=0;n<o.length;n++){var a=o[n];if(a==GameModel.EnemyID.F011||a==GameModel.EnemyID.F012?i.includes(a)||i.push(a):(a=a.substring(0,a.length-1)+"1",i.includes(a)||i.push(a)),6<=i.length)break}for(var r=[],s=i.length;0<s;){var l=ex.rand(0,11);r.includes(l)||(r.push(l),s--)}for(n=0;n<i.length;n++){l=r[n];var c=n%4,d=Math.floor(l/4),h=new cc.Node("node");h.scale=60/90,h.setPosition(60*c-90,35-60*d),this.sceneBg.node.addChild(h),(h=h.addComponent(cc.Sprite)).sizeMode=cc.Sprite.SizeMode.TRIMMED,Utils.loadSubpackageImage("game/enemy_image/"+i[n],h)}},l([a({type:cc.Sprite,tooltip:"Game scene background"})],u.prototype,"sceneBg",void 0),l([a({type:cc.Material,tooltip:"Bubble material sprite"})],u.prototype,"rippleMaterial",void 0),n=d=l([n],u),r.default=n,cc._RF.pop()},{}],SoundManager:[function(e,t){"use strict";function o(){this.soundMap=new Map}cc._RF.push(t,"afa8f39/s5NG4JNE4iIrZjS","SoundManager"),window.SoundManager=(Object.defineProperty(o.prototype,"isSoundValid",{get:function(){return GameData.settingData.sound==GameModel.SettingState.Opened},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isMusicValid",{get:function(){return GameData.settingData.music==GameModel.SettingState.Opened},enumerable:!1,configurable:!0}),o.prototype.playSound=function(e){this.isSoundValid&&Utils.getRemote().load(e,cc.AudioClip,function(t,o){t?console.warn("not found "+e):cc.audioEngine.playEffect(o,!1)})},o.prototype.playSoundSingle=function(e,t){var o=this;!this.soundMap.get(e)&&this.isSoundValid&&(this.soundMap.set(e,!0),Utils.getRemote().load(e,cc.AudioClip,function(i,n){i?(console.warn("not found "+e),o.soundMap.set(e,!1)):(n=cc.audioEngine.playEffect(n,!1),t=Math.max(null!=t?t:1,cc.audioEngine.getCurrentTime(n)),setTimeout(function(){o.soundMap.set(e,!1)},1e3*t))}))},o.prototype.playMusic=function(e,t){void 0===t&&(t=!0),this.isMusicValid&&Utils.getRemote().load(e,cc.AudioClip,function(o,i){o?console.warn("not found "+e):cc.audioEngine.playMusic(i,t)})},o.prototype.stopMusic=function(){this.isMusicValid&&cc.audioEngine.stopMusic()},Object.defineProperty(o.prototype,"isVibrateValid",{get:function(){return GameData.settingData.kill_vibrate==GameModel.SettingState.Opened},enumerable:!1,configurable:!0}),o.prototype.vibrateShort=function(){this.isVibrateValid&&G.vibrateShort()},new o),cc._RF.pop()},{}],TabBarItem:[function(e,t,o){"use strict";cc._RF.push(t,"60c70m1njlKsqS0eJlDr9Rn","TabBarItem");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("GradeInfo");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.lobby=null,e.tabIndex=0,e.guideStep=0,e.unlockLevel=0,e.gradePrefab=null,e.content=null,e.atkInfo=null,e.criticalInfo=null,e.capacityInfo=null,e.contentWorldPos=cc.v2(),e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=cc.Component),h.prototype.onLoad=function(){var e=this;this.content=this.node.getChildByName("content"),this.gradePrefab&&(this.atkInfo=this.createGradeItem(0),this.atkInfo.initSprite(this.tabIndex,0),this.atkInfo.setOnGradeListener(this.onAtkGrade,this),this.criticalInfo=this.createGradeItem(1),this.criticalInfo.initSprite(this.tabIndex,1),this.criticalInfo.setOnGradeListener(this.onLuckGrade,this),this.capacityInfo=this.createGradeItem(2),this.capacityInfo.initSprite(this.tabIndex,2),this.capacityInfo.setOnGradeListener(this.onCapacityGrade,this)),this.scheduleOnce(function(){e.node.convertToWorldSpaceAR(e.content.getPosition(),e.contentWorldPos),console.log("content world pos:",e.contentWorldPos.x,e.contentWorldPos.y)}),this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},h.prototype.createGradeItem=function(e){var t=cc.instantiate(this.gradePrefab),o=t.height+10,i=0==this.tabIndex?70:120;return t.y=o/2+i+(2-e)*o,this.content.addChild(t),t.getComponent(d.default)},h.prototype.close=function(){this.hide(),this.lobby.onCloseTabBar()},h.prototype.onClick=function(e){e=e.touch.getLocation(),console.log("tabBar click:",e.y,this.contentWorldPos.y+this.content.height),e.y>this.contentWorldPos.y+this.content.height&&this.close()},h.prototype.initialize=function(e,t,o,i){this.lobby=e,this.tabIndex=t,this.unlockLevel=o,this.guideStep=i},h.prototype.show=function(){var e=this;this.node.active=!0,GuideUtils.isShow&&GuideUtils.showStep>=Model.GuideStep.GradeCore&&this.scheduleOnce(function(){var t=e.atkInfo.btnGrade.node.getBoundingBoxToWorld();GuideUtils.showGradeCoreArmsButton(t,function(){e.onAtkGrade(),GuideUtils.destroy(),GuideUtils.saveStep()})})},h.prototype.hide=function(){this.node.active=!1},h.prototype.onAtkGrade=function(){},h.prototype.onLuckGrade=function(){},h.prototype.onCapacityGrade=function(){},h.prototype.showGradeAni=function(e){var t=this.lobby.gradeSpine;t.node.parent!=e&&(t.node.active=!0,t.node.removeFromParent(),t.node.setPosition(0,0),e.addChild(t.node),t.node.setSiblingIndex(0)),t.setAnimation(0,"animation",!1),SoundManager.playSound(Model.AudioUrl.Grade)},l([a({type:cc.Prefab,displayName:"Upgrade progress Prefab"})],h.prototype,"gradePrefab",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],TaskItem:[function(e,t,o){"use strict";cc._RF.push(t,"f6a73bDmHBEIr1LtbV9lmLx","TaskItem");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d=n("RewardGoldTips");function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.title=null,e.reward=null,e.starLabel=null,e.progressBar=null,e.progressLabel=null,e.state=null,e.stateSpriteFrames=[],e.info=null,e}n=(a=cc._decorator).ccclass,a=a.property,s(h,c=cc.Component),h.prototype.onLoad=function(){this.pageName="Task"},h.prototype.start=function(){},h.prototype.updateItem=function(e){this.info=e,this.title.string=e.describe,this.reward.string="x"+GA.formatNumber(e.gold),this.starLabel.string=""+e.star,this.progressBar.progress=e.completeNum/e.parameter,this.progressLabel.string=Math.min(e.completeNum,e.parameter)+"/"+e.parameter,this.state.spriteFrame=this.stateSpriteFrames[e.state]},h.prototype.onReceiveClick=function(){this.info.state==GameModel.TaskState.CanReceive&&(this.requestReward(),SoundManager.playSound(Model.AudioUrl.Click))},h.prototype.requestReward=function(){var e=this.info;GameData.addGold(e.gold),GameData.addStar(e.star),GameData.changeTaskReceiveState(e.id),e.state=GameModel.TaskState.Received,this.updateItem(e),MSGEvent.sendEvent(MSGEvent.RECEIVE_TASK),MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO),d.default.show(e.gold)},l([a({type:cc.Label,tooltip:"title"})],h.prototype,"title",void 0),l([a({type:cc.Label,tooltip:"Reward"})],h.prototype,"reward",void 0),l([a({type:cc.Label,tooltip:"Star reward"})],h.prototype,"starLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"Progress bar"})],h.prototype,"progressBar",void 0),l([a({type:cc.Label,tooltip:"Progress bar label"})],h.prototype,"progressLabel",void 0),l([a({type:cc.Sprite,tooltip:"state"})],h.prototype,"state",void 0),l([a({type:cc.SpriteFrame,tooltip:"stateSpriteFrames"})],h.prototype,"stateSpriteFrames",void 0),n=l([n],h),r.default=n,cc._RF.pop()},{}],TaskNode:[function(e,t,o){"use strict";cc._RF.push(t,"40969XDqRVGeLyqvXjDUGlO","TaskNode");var i,n=e,a=t,r=o,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==("undefined"==typeof Reflect?"undefined":w(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(r=(a<3?n(r):3<a?n(t,o,r):n(t,o))||r);return 3<a&&r&&Object.defineProperty(t,o,r),r};Object.defineProperty(r,"__esModule",{value:!0});var c,d,h=n("ListView"),u=n("BaseScript"),p=n("RewardGoldTips"),f=n("RewardTips"),m=n("TaskItem"),g=[{star:200,gold:1e4,arms:0},{star:500,gold:0,arms:7},{star:800,gold:5e4,arms:0},{star:1200,gold:0,arms:10},{star:2e3,gold:0,arms:11}];function y(){var e=null!==c&&c.apply(this,arguments)||this;return e.listView=null,e.lockNode=null,e.subscribeBtn=null,e.rewardItem=null,e.starTotalLabel=null,e.starProgressBar=null,e.pointSpine=null,e.receiveBtn=null,e.dayFlag=null,e.rewardNodes=[],e.selectedIndex=-1,e.dayNodes=[],e.taskList=[],e}n=(a=cc._decorator).ccclass,a=a.property,s(y,c=u.default),(d=y).show=function(){c.beginLoading.call(this)&&(G.showLoading(),cc.resources.load("prefab/TaskNode",cc.Prefab,function(e,t){G.hideLoading(),e?cc.error(e):((t=cc.instantiate(t)).zIndex=GameModel.SceneTopZIndex,cc.Canvas.instance.node.addChild(t))}))},Object.defineProperty(y,"fileName",{get:function(){return"TaskNode"},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"className",{get:function(){return d.fileName},enumerable:!1,configurable:!0}),y.prototype.onLoad=function(){this.pageName="Task",c.prototype.onLoad.call(this),this.enterPage({existBanner:!1,existVideo:!0}),this.initData(),this.initSprite()},y.prototype.start=function(){this.initListener(),Utils.hideGameClubButton()},y.prototype.initData=function(){GameConfig.syncTaskData();for(var e=GameConfig.TaskList,t=0;t<e.length;t++){var o=e[t],i=o.day-1;o.day<=GameConfig.taskContinuedDay&&(this.taskList[i]||(this.taskList[i]=[]),this.taskList[i].push(o),o.state==GameModel.TaskState.CanReceive&&-1==this.selectedIndex&&(this.selectedIndex=i))}for(t=0;t<this.taskList.length;t++)this.taskList[t].sort(function(e,t){if(e.state!=t.state){if(e.state==GameModel.TaskState.CanReceive)return-1;if(e.state==GameModel.TaskState.Received)return 1;if(t.state==GameModel.TaskState.Received)return-1}return 0})},y.prototype.initSprite=function(){this.addRewardItem(this.rewardItem);for(var e=1;e<5;e++){var t,o=cc.instantiate(this.rewardItem);4==e?o.setPosition(237,this.starProgressBar.node.y):(t=this.rewardItem.y,o.setPosition(this.rewardItem.x+85*e,t)),this.rewardItem.parent.addChild(o),this.addRewardItem(o)}for(this.refreshStarLabel(),this.pointSpine.node.zIndex=10,this.addDayItem(this.dayFlag),e=1;e<7;e++)(o=cc.instantiate(this.dayFlag)).setPosition(this.dayFlag.x+(o.width+5)*e,this.dayFlag.y),this.content.addChild(o),this.addDayItem(o);var i=GameConfig.taskContinuedDay-1;0<=this.selectedIndex&&(i=this.selectedIndex,this.selectedIndex=-1),this.onDayClick(null,Math.min(i,6)),this.listView.array=this.taskList[this.selectedIndex],this.listView.updateHander(this.updateItem,this),this.subscribeBtn.active=!1},y.prototype.addRewardItem=function(e){var t=this.rewardNodes.length;e.getComponent(cc.Button).clickEvents[0].customEventData=""+t;var o=e.getChildByName("star_label").getComponent(cc.Label),i=e.getChildByName("icon").getComponent(cc.Sprite),n=e.getChildByName("received");n.active=GameData.receiveStarTimes>t;var a=g[t];0<a.arms?Utils.loadSubpackageImage("prefab/task_reward_"+a.arms,i):n.active&&Utils.loadSubpackageImage("prefab/task_reward_box_open",i),o.string=""+a.star,4==t&&(o.fontSize=20,o.node.y=-35),this.rewardNodes.push({item:e,icon:i,received:n})},y.prototype.addDayItem=function(e){var t=this.dayNodes.length,o=e.getComponent(cc.Toggle),i=e.getChildByName("day_lock"),n=e.getChildByName("normal").getComponent(cc.Sprite),a=e.getChildByName("selected").getComponent(cc.Sprite);e=t+1,Utils.loadSubpackageImage("prefab/flag_"+e+"_n",n),Utils.loadSubpackageImage("prefab/flag_"+e+"_s",a),o.isChecked=!1,o.checkEvents[0].customEventData=""+t,i.active=GameConfig.taskContinuedDay<e,this.dayNodes.push({toggle:o,normal:n,selected:a,lock:i})},y.prototype.initListener=function(){var e=this;MSGEvent.on(this.pageName,MSGEvent.RECEIVE_TASK,function(){e.listView.refresh(),e.refreshStarLabel()})},y.prototype.refreshStarLabel=function(){var e=GameData.star;this.starTotalLabel.string=""+e;for(var t=0,o=n=g.length;o--;)if(e>g[o].star){t=o+1;break}var i=Math.min(t,n-1),n=g[i].star;i=0<i?g[i-1].star:0,this.starProgressBar.progress=.2*t+(e-i)/(5*(n-i)),n=t>GameData.receiveStarTimes,(this.pointSpine.node.active=n)&&(i=-1,4==(n=GameData.receiveStarTimes)&&(i=1,this.pointSpine.node.y=30),this.receiveBtn.node.y=i*Math.abs(this.receiveBtn.node.y),this.receiveBtn.clickEvents[0].customEventData=""+n,this.pointSpine.node.x=this.rewardNodes[n].item.x,1==i?this.pointSpine.setAnimation(0,"point_down",!0):this.pointSpine.setAnimation(0,"point_up",!0))},y.prototype.updateItem=function(e,t){var o=e.getComponent(m.default);(e=this.listView.array[t])&&o.updateItem(e,t)},y.prototype.changeTaskDay=function(){this.listView.array=this.taskList[this.selectedIndex],this.listView.refresh()},y.prototype.close=function(){c.prototype.close.call(this),Utils.showGameClubButton()},y.prototype.onDayClick=function(e,t){var o=t;this.selectedIndex!=o?(t=this.dayNodes[o],0<=this.selectedIndex&&(this.dayNodes[this.selectedIndex].toggle.isChecked=!1,this.dayNodes[this.selectedIndex].lock.y=-35),this.selectedIndex=o,t.toggle.isChecked=!0,t.lock.y=-45,this.lockNode.active=t.lock.active,this.listView.node.active=!t.lock.active,t.lock.active||this.changeTaskDay()):this.dayNodes[o].toggle.isChecked=!0},y.prototype.onReceiveClick=function(e,t){var o=g[t];GameData.star>=o.star?(t=this.rewardNodes[t]).received.active||(t.received.active=!0,GameData.receiveStarReward(),0<o.arms?(GameData.unlockAuxiliary(o.arms),f.default.show(o.arms)):(GameData.addGold(o.gold),MSGEvent.sendEvent(MSGEvent.UPDATE_USERINFO),p.default.show(o.gold)),this.refreshStarLabel()):G.showToast({title:"There are not enough stars. Go and finish the job"})},y.prototype.onSubscribeClick=function(){},l([a({type:h.default,tooltip:"list"})],y.prototype,"listView",void 0),l([a({type:cc.Node,tooltip:"Unlocked node"})],y.prototype,"lockNode",void 0),l([a({type:cc.Node,tooltip:"subscribe button"})],y.prototype,"subscribeBtn",void 0),l([a({type:cc.Node,tooltip:"Rewarditem"})],y.prototype,"rewardItem",void 0),l([a({type:cc.Label,tooltip:"starTotallabel"})],y.prototype,"starTotalLabel",void 0),l([a({type:cc.ProgressBar,tooltip:"starprogressbar"})],y.prototype,"starProgressBar",void 0),l([a({type:sp.Skeleton,tooltip:"PointSpine"})],y.prototype,"pointSpine",void 0),l([a({type:cc.Button,tooltip:"receivebutton"})],y.prototype,"receiveBtn",void 0),l([a({type:cc.Node,tooltip:"dayFlag"})],y.prototype,"dayFlag",void 0),n=d=l([n],y),r.default=n,cc._RF.pop()},{}],Utils:[function(e,t){"use strict";var o;cc._RF.push(t,"f3b55WyUSJHfpxUVY+ol/pX","Utils"),function(e){function t(){var e=GA.PA.getMenuButtonBoundingClientRect().top*GA.PA.getSystemInfoSync().designPixelRatio;return G.isLongScreen()&&0==e?e=90:0==e&&(e=20),e}e.getSafeAreaTop=t;var o=null;e.showGameClubButton=function(){var e,t;GA.isWeChat()&&(o||(e=GA.PA.getMenuButtonBoundingClientRect().bottom,t=GA.PA.getSystemInfoSync(),o=GA.PA.createGameClubButton({type:"image",icon:"light",style:{left:10,top:e+100,width:80/t.designPixelRatio,height:80/t.designPixelRatio}})),o.show())},e.hideGameClubButton=function(){o&&o.hide()};var i=null;function n(e,t){void 0===t&&(t=!1),i=i||new cc.NodePool;var o,n=null,a=null;0<i.size()?a=(n=i.get()).getComponent(cc.Label):((n=new cc.Node("node")).color=cc.Color.WHITE,a=n.addComponent(cc.Label),(o=n.addComponent(cc.LabelOutline)).color=cc.Color.BLACK,o.width=4),a.string=e,t?n.setPosition(0,0):n.setPosition(0,-cc.winSize.height/2+200),n.opacity=255,n.zIndex=9999,a.fontSize=30,cc.Canvas.instance.node.addChild(n),cc.tween(n).by(1.5,{y:100}).call(function(){i.put(n)}).start()}e.showToast=n;var a=null;e.showClickAni=function(e,t){var o;a?a.skeletonData&&a.setAnimation(0,"animation",!1):(o=new cc.Node,a=o.addComponent(sp.Skeleton),c().load("spine/click/skeleton",sp.SkeletonData,function(e,t){e?console.warn("not found click."):a&&a.isValid&&(a.skeletonData=t,a.setAnimation(0,"animation",!1))})),a.node.setPosition(e,t)},e.showTextTips=function(e){n(e,!0)};var r=null;e.showImageTips=function(t,o,i){r=r||new cc.NodePool;var n=null,a=0<r.size()?(n=r.get()).getComponent(cc.Sprite):(n=new cc.Node("node")).addComponent(cc.Sprite);n.setPosition(o,i),n.zIndex=999,e.loadSubpackageImage(t,a),cc.Canvas.instance.node.addChild(n),cc.tween(n).by(1.5,{y:100}).call(function(){r.put(n)}).start()};var s=null;e.showRewardGoldAnimation=function(o){s=s||new cc.NodePool;var i=0,n=0,a=t(),r=cc.winSize.height/2-a-40;a=function t(){var a,l,c;20<++i?cc.Canvas.instance.unschedule(t):(a=null,0<s.size()?a=s.get():(c=(a=new cc.Node("node")).addComponent(cc.Sprite),e.loadSubpackageImage("home/ic_gold",c)),l=ex.rand(1,100)-50,c=ex.rand(1,100)-50,a.setPosition(l,c),cc.Canvas.instance.node.addChild(a),cc.tween(a).delay(.3).to(.5,{x:-80,y:r}).call(function(){s.put(a),o&&o({isEnd:20<=++n})}).start())},cc.Canvas.instance.schedule(a,.03)},e.createSprite=function(e){return new cc.Node(e).addComponent(cc.Sprite)};var l=!(e.createLabel=function(e){return new cc.Node(e).addComponent(cc.Label)});function c(){return cc.assetManager.getBundle("subpackage")}e.shake=function(e){var t,o,i;l||(t=e.x,o=e.y,i=cc.tween(e).repeatForever(cc.tween().by(.018,{x:15,y:17}).by(.018,{x:-16,y:17}).by(.018,{x:-23,y:13}).by(.018,{x:13,y:-16}).by(.018,{x:-15,y:15}).by(.018,{x:12,y:-18}).by(.018,{x:-18,y:-20}).by(.018,{x:13,y:20}).by(.018,{x:10,y:10})).start(),l=!0,setTimeout(function(){i.stop(),e.x=t,e.y=o,l=!1},300))},e.getSubpackage=c,e.getSubgame=function(){return cc.assetManager.getBundle("subgame")},e.getRemote=function(){return cc.assetManager.getBundle("subremote")},e.loadSubpackageImage=function(t,o){e.getSubpackage().load(t,cc.SpriteFrame,function(e,i){e?console.warn("not found "+t):o&&o.isValid&&(o.spriteFrame=i)})},e.loadResourcesImage=function(e,t){cc.resources.load(e,cc.SpriteFrame,function(o,i){o?console.warn("not found "+e):t&&t.isValid&&(t.spriteFrame=i)})},e.loadRemoteImage=function(e,t){cc.assetManager.loadRemote(e,{ext:".jpg"},function(e,o){e?console.warn(e):t&&t.isValid&&(t.spriteFrame=new cc.SpriteFrame(o))})}}(o=o||{}),window.Utils=o,cc._RF.pop()},{}],gameassistant2:[function(e,t){"use strict";function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}cc._RF.push(t,"ce56ewfpo1IGajR/lErQvJe","gameassistant2");var i,n,a,r,s,l,c=["124070lxNlFj","833091yBXnaG","45MZvIoD","288767zvqTVI","1084801AUTnuG","1lgdOmA","312835QzYcvx","271INnHjq","3420ItbtDS","5387yzvcDn","3MEqPUU"],d=function(e){return c[e-=168]};(function(e){for(var t=d;;)try{if(569383===-parseInt(t(174))*-parseInt(t(175))+parseInt(t(178))*parseInt(t(171))+parseInt(t(170))+-parseInt(t(173))+parseInt(t(177))*parseInt(t(176))+-parseInt(t(172))+-parseInt(t(168))*parseInt(t(169)))break;e.push(e.shift())}catch(d){e.push(e.shift())}})(c),window.kariqu_android_proxy=new(function(){function e(){var e=this;this.compatibleMethods=["onShareMessageToFriend","showShareMenu","onShareTimeline","onShareAppMessage","getUpdateManager","onTouchEnd","onTouchStart","offTouchStart","offTouchEnd","triggerGC"],this.bridge=null,this.isSplashAdEnd=!1,this.splashAdEndCallback=null,this.callbacks=new Map,this.times=0,console.log("AndroidProxy ts is constructed."),this.compatibleMethods.forEach(function(t){e[t]=function(){console.log("Android \u6682\u4e0d\u652f\u6301"+t)}});try{this.bridge=PlatformClass.createClass("com.kariqu.game.Proxy")}catch(c){}}var t=e.prototype;return t.setUserId=function(e){this.native("setUserId","(Ljava/lang/String;)V",e)},t.setSplashAdEnd=function(){this.isSplashAdEnd=!0,this.splashAdEndCallback&&this.splashAdEndCallback(),this.splashAdEndCallback=null},t.afterSplashAd=function(e){this.isSplashAdEnd?e():this.splashAdEndCallback=e},t.native=function(e,t){for(var o=arguments.length,i=new Array(o>2?o-2:0),n=2;n<o;n++)i[n-2]=arguments[n];console.log("call android native "+e+" "+t+" "+i.join(","));try{var a;if(this.bridge)return i.forEach(function(e){"number"==typeof e&&(e*=1)}),(a=this.bridge).call.apply(a,[e].concat(i));var r,l="com/kariqu/game/Proxy";return s.ENABLE_NEXT_VERSION&&(l="com/kariqu/sdkmanager/Proxy"),(r=jsb.reflection).callStaticMethod.apply(r,[l,e,t].concat(i))}catch(e){}},t.callCallback=function(e){if(this.callbacks.has(e))try{for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.callbacks.get(e).apply(void 0,o)}catch(e){console.error(e)}finally{this.callbacks.delete(e)}},t.uuid=function(){return this.times++,Date.now()+"-"+this.times},t.onShow=function(){},t.offShow=function(){},t.onHide=function(){},t.offHide=function(){},t.getSystemInfoSync=function(){return JSON.parse(this.native("getSystemInfoSync","()Ljava/lang/String;"))},t.getLaunchOptionsSync=function(){var e=null,t=this.native("getLaunchOptionsSync","()Ljava/lang/String;");if(t&&""!=t)try{e=JSON.parse(t)}catch(e){console.error(JSON.stringify(e))}else s.log("Android getLaunchOptionsSync error('').");return e},t.exitMiniProgram=function(){this.native("exitMiniProgram","()V")},t.showRewardVideoAd=function(e){var t="showRewardVideoAd:"+this.uuid();this.callbacks.set(t,e);var o="showRewardVideoAd:show:"+this.uuid();this.callbacks.set(o,e),this.native("showRewardVideoAd","(Ljava/lang/String;Ljava/lang/String;)V",o,t)},t.showFullScreenVideoAd=function(){this.native("showFullScreenVideoAd","()V")},t.showInterstitialAd=function(){this.native("showInterstitialAd","()V")},t.showBanner=function(e,t,o,i){var n={};n.offsetX=null!=e?e:0,n.offsetY=null!=t?t:0,n.width=null!=o?o:0,n.height=null!=i?i:0,this.native("showBanner","(Ljava/lang/String;)V",JSON.stringify(n))},t.hideBanner=function(){this.native("hideBanner","()V")},t.hideAllBanner=function(){this.native("hideAllBanner","()V")},t.resumeShowBanner=function(){this.native("resumeShowBanner","()V")},t.clearAllBanner=function(){this.native("clearAllBanner","()V")},t.showNativeAd=function(e){var t,o,i,n,a={};a.offsetX=null!=(t=e.offsetX)?t:0,a.offsetY=null!=(o=e.offsetY)?o:0,a.width=null!=(i=e.width)?i:0,a.height=null!=(n=e.height)?n:0,this.native("showNativeAd","(Ljava/lang/String;)V",JSON.stringify(a))},t.hideNativeAd=function(){this.native("hideNativeAd","()V")},t.loadOppoNativeAd=function(e){var t=this,o="loadNativeAd:"+this.uuid();this.callbacks.set(o,function(i){e&&e(i),t.callbacks.delete(o)}),this.native("loadOppoNative","(Ljava/lang/String;)V",o)},t.reportOppoNativeAdShow=function(e){this.native("reportOppoNativeAdShow","(Ljava/lang/String;)V",e)},t.reportOppoNativeAdClick=function(e){this.native("reportOppoNativeAdClick","(Ljava/lang/String;)V",e)},t.destroyOppoNativeAd=function(e){this.native("closeOppoNativeAd","(Ljava/lang/String;)V",e)},t.createInterstitialAd=function(){return{}},t.showToast=function(e){this.native("showToast","(Ljava/lang/String;)V",JSON.stringify(e))},t.getLanguage=function(){return this.native("getLanguage","()Ljava/lang/String;")},t.showModal=function(e){var t,o,i="showModal:"+this.uuid();this.native("showModal","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",e.title,e.content,null!=(t=e.confirmText)?t:"OK",e.showCancel?null!=(o=e.cancelText)?o:"NO":"",i),this.callbacks.set(i,e.success)},t.showLoading=function(e){this.native("showLoading","(Ljava/lang/String;)V",e.title)},t.hideLoading=function(){this.native("hideLoading","()V")},t.showShareMenu=function(){this.native("showShareMenu","()V")},t.shareAppMessage=function(e){this.native("shareAppMessage","(Ljava/lang/String;)V",JSON.stringify(e))},t.getUserInfo=function(){},t.getWeChatOpenId=function(e){var t=this,o="getWeChatOpenId:"+this.uuid();this.callbacks.set(o,function(i){var n;e(null!=(n=i.openid)?n:""),t.callbacks.delete(o)}),this.native("getWeChatOpenId","(Ljava/lang/String;)V",o)},t.login=function(e){var t=this,o="login:success:"+this.uuid();this.callbacks.set(o,e.success);var i="login:fail:"+this.uuid();this.callbacks.set(i,e.fail);var n="login:complete:"+this.uuid();this.callbacks.set(n,function(){t.callbacks.delete(o),t.callbacks.delete(i),t.callbacks.delete(n)}),this.native("login","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",o,i,n)},t.setKeepScreenOn=function(){},t.vibrateShort=function(){this.native("vibrateShort","()V")},t.vibrateLong=function(){this.native("vibrateLong","()V")},t.setClipboardData=function(e){this.native("setClipboardData","(Ljava/lang/String;)V",e.data)},t.getClipboardData=function(e){try{var t={};t.data=this.native("getClipboardData","()Ljava/lang/String;"),e.success(t)}catch(e){}},t.getBatteryInfo=function(){},t.getBatteryInfoSync=function(){return{level:0,isCharging:!1}},t.onOceanEngineInit=function(){this.native("onOceanEngineInit","()V")},t.reportKeyAction=function(e){e?this.native("reportKeyAction","(Ljava/lang/String;)V",e):this.native("reportKeyAction","()V")},t.onOceanEngineRegister=function(e,t){this.native("onOceanEngineRegister","(Ljava/lang/String;Z)V",e,t)},t.onOceanEnginePurchase=function(e,t){this.native("onOceanEnginePurchase","(Ljava/lang/String;Z)V",e,t)},t.jumpLeisureSubject=function(){this.native("jumpLeisureSubject","()V")},t.exitApplication=function(){this.native("exitApplication","()V")},t.isRewardVideoAdReady=function(){return this.native("isRewardVideoAdReady","()Z")},t.sendEvent=function(e,t){this.native("sendEvent","(Ljava/lang/String;Ljava/lang/String;)V",e,t)},e}()),function(e){var t,o,i,n;(t=e.Urls||(e.Urls={})).GameConfig="https://game.17tcw.com/default/extra/getNewConfigs",t.GameUrl="https://game.17tcw.com",(o=e.EngineType||(e.EngineType={})).Default="Default",o.CocosCreator="CocosCreator",o.LayaAir="LayaAir",(i=e.Platform||(e.Platform={})).Default="Default",i.Kuaidianwan="Kuaidianwan",i.WeChat="WeChat",i.QQ="QQ",i.OPPO="OPPO",i.Vivo="Vivo",i.QuTouTiao="QuTouTiao",i.QuTouTiaoAndroid="QuTouTiaoAndroid",i.ByteDance="ByteDance",i.YueYou="YueYou",i.KuaiKan="KuaiKan",i.BaoQu="BaoQu",i.Android="Android",i.iOS="iOS",i.UCMiniGame="UCMiniGame",i.LianShangMiniGame="LianShangMiniGame",i.Kwaigame="Kwaigame",i.M4399MiniGame="M4399MiniGame",i.Hago="Hago",(n=e.DistributionChannel||(e.DistributionChannel={})).None="",n.AppStore="AppStore",n.AndroidOfficial="AndroidOfficial",n.OPPO="OPPO",n.M4399="M4399",n.M233="M233",n.HaoYouKuaiBao="HaoYouKuaiBao",n.BaMenShenQi="BaMenShenQi",n.YingYongBao="YingYongBao",n.XiaoMi="XiaoMi",n.GooglePlay="GooglePlay"}(s||(s={})),(i=s||(s={})).Info=new(function(){return function(){this.debugLog=!1,this.isPreview=!1,this.appId="",this.platform=i.Platform.Default,this.engine=i.EngineType.Default,this.distributionChannel=i.DistributionChannel.None,this.channelId="",this.channelKey="",this.UUID="",this.underCheck=!1,this.resolution={width:0,height:0},this.sharePath="",this.nickname="",this.avatar="",this.scene="",this.sceneWithSourceAppId="",this.gameInBackground=!1,this.pageList=[],this.shareOption=null,this.shareTimes=0,this.shareTime=0,this.withoutRewardVideoAd=!1,this.version="1.0.0",this.videoTopics=[],this.rewardConfigOriginData=new Map;var e={time:0};e.data=new Map,this.rewardUserData=e,this.shareData=[{id:"",templateId:"",title:"",url:""}],this.shareFailTips=["Share failed, please share to group"]}}()),function(e){function t(){var t,o,i;try{var n=e.PA.getLaunchOptionsSync();n.scene?(e.Info.scene=n.scene+"",e.Info.sceneWithSourceAppId=n.scene+""):n.from&&e.isPlatform([e.Platform.Kwaigame])&&(e.Info.scene=n.from+"",e.Info.sceneWithSourceAppId=n.from+""),(null===(t=n)||void 0===t?void 0:t.query)&&n.query[e.Info.channelKey]&&(e.Info.channelId=e.Info.channelKey+"="+n.query[e.Info.channelKey]),(null===(o=n)||void 0===o?void 0:o.referrerInfo)&&(e.Info.sourceAppid=null!=(i=n.referrerInfo.appId)?i:"",e.Info.sourceAppid.length>0&&(e.Info.sceneWithSourceAppId=e.Info.scene+"_"+e.Info.sourceAppid))}catch(e){console.error(e)}}function o(){console.log("--------------* GA \u57fa\u7840\u914d\u7f6e\u548c\u4fe1\u606f *--------------"),console.log('Appid is "'+e.Info.appId+'"'),console.log('Platform is "'+e.Info.platform+'"'),console.log('ChannelKey is "'+e.Info.channelKey+'"'),console.log('ChannelID is "'+e.Info.channelId+'"'),console.log("SharePath is "+e.Info.sharePath),console.log('UUID is "'+e.Info.UUID+'"'),console.log("GameEngine is "+e.Info.engine),console.log("Design resolution is "+JSON.stringify(e.Info.resolution)),console.log("--------------* GA \u4f7f\u7528\u57df\u540d\u6e05\u5355 *---------------");var t=new Set;for(var o in e.Urls){var i=e.Urls[o].split("/"),n=i[0]+"//"+i[2];!t.has(n)&&(t.add(n),console.log(n))}console.log("----------------------------------------------")}function i(t){var o,i,n,a,r,s,l;e.Info.shareOption=t,e.Info.shareTime=Date.now();var c=null;if(e.Info.shareData.length>0&&(c=e.Info.shareData[e.rand(0,e.Info.shareData.length-1)]),e.Info.isPreview)null===(o=e.Info.shareOption)||void 0===o||o.result({reward:!0}),e.Info.shareOption=null;else{e.PA.shareAppMessage({templateId:(i=c.templateId,null!=i?i:""),title:(n=c.title,null!=n?n:""),imageUrl:(a=c.url,null!=a?a:""),query:"shareid="+(r=c.id,null!=r?r:0)+"&openid="+e.Info.openId+"&tm="+Date.now().toFixed()+"&"+e.Info.sharePath+(t.query?"&":"")+(s=t.query,null!=s?s:""),success:function(){console.log("\u5206\u4eab\u63a5\u53e3\u6210\u529f\u56de\u8c03\uff0c\u6682\u4e0d\u5f00\u653e")},fail:function(){var t;null===(t=e.Info.shareOption)||void 0===t||t.result({reward:!1})}});var d={};d["\u89e6\u53d1\u70b9"]=null!=(l=t.tag)?l:"\u672a\u77e5",e.sentLog("\u5206\u4eab",null,d)}}function n(){var t,o,i="";return(null===(o=null===(t=e.Info)||void 0===t?void 0:t.shareFailTips)||void 0===o?void 0:o.length)>0?(i=e.Info.shareFailTips.shift(),e.Info.shareFailTips.push(i)):i="Share failed, please share to a new group",i}function a(){if(!e.isPlatform(e.Platform.Android)||e.Info.distributionChannel!=e.DistributionChannel.GooglePlay){var t=Math.round((Date.now()-e.Info.lastGameTimeUploadTimestamp)/1e3);e.sentLog("onlinetime",t,{scene:e.Info.sceneWithSourceAppId}),e.Info.lastGameTimeUploadTimestamp=Date.now()}}function r(){try{e.Info.rewardUserData.time=Date.now();var t={time:0,data:[]};t.time=e.Info.rewardUserData.time,e.Info.rewardUserData.data.forEach(function(e,o){var i={};i.tag=o,i.currIndex=e.currIndex,i.currCount=e.currCount,t.data.push(i)}),e.PA.setStorageSync("RewardUserData",JSON.stringify(t))}catch(e){console.error(e)}}function s(t){for(var o=0;o<e.Info.pageList.length;o++)if(e.Info.pageList[o].page==t){var i=e.Info.pageList[o];return e.Info.pageList.splice(o,1),i}return null}window.GA=e,e.PA=null,e.init=function(s){if(console.log("GA Version:"+e.version+" buildTime:"+e.buildTime),""==e.Info.appId){var l=new Promise(function(l){var c,d,h,u,p,f,m,g,y,v,b,A,w,P,G,C,S,k,T,L,M,I,R,E,O,x;e.log("init ",s),e.Info.debugLog=null!=(c=s.debugLog)&&c,e.Info.isPreview=s.isPreview,e.Info.appId=s.appId,e.Info.platform=s.platform,e.Info.engine=s.engine,e.Info.channelKey=s.channelKey,e.Info.UUID=s.uuid,e.Info.resolution.width=s.resolution.width?s.resolution.width:0,e.Info.resolution.height=s.resolution.height?s.resolution.height:0,e.Info.sharePath=s.sharePath,e.Info.withoutRewardVideoAd=!!s.withoutRewardVideoAd,e.Info.version=s.version?s.version:"1.0.0";var _=null;switch(e.Info.platform){case e.Platform.Android:_=kariqu_android_proxy;break;case e.Platform.WeChat:_=null!=(d=window.wx)?d:{};break;case e.Platform.QQ:_=null!=(h=window.qq)?h:{};break;case e.Platform.iOS:_=kariqu_ios_proxy;break;case e.Platform.OPPO:case e.Platform.Vivo:_=null!=(u=window.qg)?u:{};break;case e.Platform.ByteDance:_=null!=(p=window.tt)?p:{};break;case e.Platform.Kwaigame:_=null!=(f=window.ks)?f:{};break;case e.Platform.Kuaidianwan:_={},window.GameAssistantWeb?(console.log("GameAssistantWeb is ok."),GameAssistantWeb.onGameLoaded()):console.log("GameAssistantWeb is not ok.");break;case e.Platform.Hago:_=null!=(m=window.hg)?m:{}}if(e.PA=new e.PAClass,e.PA.init(_),e.isPlatform(e.Platform.M4399MiniGame));else{e.isPlatform([e.Platform.Android,e.Platform.iOS])&&(e.Info.appId=null!=(v=null===(y=null===(g=e.PA.getLaunchOptionsSync())||void 0===g?void 0:g.query)||void 0===y?void 0:y.appId)?v:e.Info.appId,e.Info.distributionChannel=null!=(w=null===(A=null===(b=e.PA.getLaunchOptionsSync())||void 0===b?void 0:b.query)||void 0===A?void 0:A.distributionChannel)?w:e.Info.distributionChannel);try{var B=null===(G=(P=e.PA).getSystemInfoSync)||void 0===G?void 0:G.call(P);B.windowWidth/B.windowHeight>e.Info.resolution.width/e.Info.resolution.height?e.Info.resolution.width=Math.round(B.windowWidth*e.Info.resolution.height/B.windowHeight):e.Info.resolution.height=Math.round(B.windowHeight*e.Info.resolution.width/B.windowWidth)}catch(e){console.error(e)}t();try{null===(S=(C=e.PA).setKeepScreenOn)||void 0===S||S.call(C,{keepScreenOn:!0}),e.PA.onShow(function(){var t,o,a,r,s,l,c,d,h,u,p,f,m,g,y,v,b;if(e.Info.gameInBackground=!1,e.Info.lastGameTimeUploadTimestamp=Date.now(),null===(o=(t=e.PA).setKeepScreenOn)||void 0===o||o.call(t,{keepScreenOn:!0}),null===(a=e.Info.shareOption)||void 0===a?void 0:a.result){e.Info.shareTimes++;var A=null!=(l=null===(r=e.Info.rewardConfigOriginData)||void 0===r?void 0:r.get(null===(s=e.Info.shareOption)||void 0===s?void 0:s.tag))?l:null===(c=e.Info.rewardConfigOriginData)||void 0===c?void 0:c.get("SCORE_STRATEGY");try{var w=null!=(p=null===(d=A)||void 0===d?void 0:d.shareSuccessRate[Math.min(e.Info.shareTimes-1,(null===(u=null===(h=A)||void 0===h?void 0:h.shareSuccessRate)||void 0===u?void 0:u.length)-1)])?p:0,P=Math.random()<w/100;if(!P){var G=null!=(y=1e3*(null===(f=A)||void 0===f?void 0:f.shareSuccessTime[Math.min(e.Info.shareTimes-1,(null===(g=null===(m=A)||void 0===m?void 0:m.shareSuccessTime)||void 0===g?void 0:g.length)-1)]))?y:5e3;Date.now()-e.Info.shareTime>=G&&G>=0&&(P=!0)}try{var C={};C.reward=P,e.Info.shareOption.result(C)}catch(e){}P?(e.Info.shareTimes=0,e.Info.shareOption=null):(null==(b=null===(v=e.Info.shareOption)||void 0===v?void 0:v.showFailTip)||b)&&e.PA.showModal({title:"Tips",content:n(),showCancel:!0,cancelText:"Return to play",confirmText:"To share",success:function(t){t.cancel?e.Info.shareOption=null:i(e.Info.shareOption)}})}catch(e){}}}),e.PA.onHide(function(){e.Info.gameInBackground=!0,e.Info.openId&&a(),r()}),setInterval(function(){!e.Info.gameInBackground&&a()},1e3*Math.max(null!=(k=s.uploadGameTimeIntervals)?k:10,10)),setInterval(function(){e.Info.pageList.length>0&&(e.Info.pageList[e.Info.pageList.length-1].time+=1)},1e3),null===(L=(T=e.PA).showShareMenu)||void 0===L||L.call(T,{menus:["shareAppMessage","shareTimeline"]}),null===(I=(M=e.PA).onShareMessageToFriend)||void 0===I||I.call(M,function(e){console.log("onShareMessageToFriend:",e.success,e.errMsg)});var N=function(t,o){var i;try{var n="",a={id:"",title:"",url:""},r={};if("video"==(t=null!=t?t:{channel:""}).channel){n="openid="+e.Info.openId+"&tm="+Date.now().toFixed()+"&"+e.Info.channelKey+"=10001";var s={};s.videoTopics=e.Info.videoTopics,r=s;var c={};c["\u89e6\u53d1\u70b9"]=o,e.sentLog("\u62cd\u6296\u97f3",null,c)}else{n="shareid="+(a=e.Info.shareData[e.rand(0,e.Info.shareData.length-1)]).id+"&openid="+e.Info.openId+"&tm="+Date.now().toFixed()+"&"+e.Info.sharePath;var d={};d["\u89e6\u53d1\u70b9"]=o,e.sentLog("\u5206\u4eab",null,d)}var h={};return h.title=a.title,h.imageUrl=a.url,h.query=n,h.extra=r,h}catch(l){console.error(l);var u={};u["\u89e6\u53d1\u70b9"]=o,e.sentLog("\u5206\u4eab",null,u);var p={title:"",imageUrl:""};return p.query="openid="+e.Info.openId+"&tm="+Date.now().toFixed()+"&"+("video"==(null===(i=t)||void 0===i?void 0:i.channel)?e.Info.channelKey+"=10001":e.Info.sharePath),p}};null===(E=(R=e.PA).onShareAppMessage)||void 0===E||E.call(R,function(e){return N(e,"\u9876\u90e8\u5206\u4eab")}),null===(x=(O=e.PA).onShareTimeline)||void 0===x||x.call(O,function(){return N(null,"\u5206\u4eab\u670b\u53cb\u5708")})}catch(e){console.error(e)}o()}l()});return e.isPlatform([e.Platform.iOS,e.Platform.Android])?new Promise(function(t){l.then(function(){e.PA.afterSplashAd(function(){var o,i,n,a,r,s;e.Info.appId=null!=(n=null===(i=null===(o=e.PA.getLaunchOptionsSync())||void 0===o?void 0:o.query)||void 0===i?void 0:i.appId)?n:e.Info.appId,e.Info.distributionChannel=null!=(s=null===(r=null===(a=e.PA.getLaunchOptionsSync())||void 0===a?void 0:a.query)||void 0===r?void 0:r.distributionChannel)?s:e.Info.distributionChannel,t(null)})})}):l}return new Promise(function(e,t){t("GA has been initialization already.")})},e.ENABLE_NEXT_VERSION=!1,e.setUserId=function(){},e.setOpenId=function(t){e.Info.openId=t,e.PA.setStorageSync("LocalOpenId",e.Info.openId)},e.exit=function(){e.PA.exitMiniProgram()},e.rewardOperation=function(t){if(t.byVideo)e.Info.withoutRewardVideoAd?t.result({reward:!0}):e.showVideoAd(t);else{var o={};o.tag=t.tag,o.page=t.page,o.result=function(o){var i;(null===(i=o)||void 0===i?void 0:i.reward)?(e.Info.rewardUserData.data.has(t.tag)&&e.Info.rewardUserData.data.get(t.tag).currCount++,t.result({reward:!0})):t.result({reward:!1})},i(o)}},e.randomShare=i,e.getOpenId=function t(o,i,n){var a,r=function(t,i){e.Info.openId=t,e.Info.session_key=i,e.Info.openId&&""!=e.Info.openId&&e.sentLogs([{eventId:"GotOpenId",extraNum:0,detail:JSON.stringify({channel:e.Info.channelId,version:e.Info.version})},{eventId:"LaunchScene",extraNum:0,detail:JSON.stringify({scene:e.Info.sceneWithSourceAppId})}]),o(t,i)};if(e.Info.isPreview)try{e.Info.openId=localStorage.getItem("user_id"),!e.Info.openId&&(e.Info.openId="Test"+Date.now()+(1e8*Math.random()).toFixed(),localStorage.setItem("user_id",e.Info.openId)),r(e.Info.openId,"TestSessionKey")}catch(e){console.error(e)}else if(e.isPlatform(e.Platform.Kuaidianwan))GameAssistantWeb.login(function(t,o){e.Info.openId=o,r(o,"")});else{var s=null!=(a=e.PA.getStorageSync("LocalOpenId"))?a:"";s&&!n&&e.isPlatform([e.Platform.WeChat])?r(s,""):e.isPlatform(e.Platform.M4399MiniGame)?window.h5api.isLogin()?window.h5api.login(function(t){e.Info.uid=parseInt(t.uId),e.Info.nickname=t.userName,r(t.uId,"")}):r("LocalOpenId",""):e.PA.login({force:!1,success:function(t){console.log("Platform "+e.Info.platform+" login:"+JSON.stringify(t));var o=e.PA.getSystemInfoSync();if(e.isPlatform(e.Platform.Kwaigame))r(t.gameUserId,t.gameToken);else if(e.isPlatform([e.Platform.ByteDance])){var i={};i.code=t.code,i.anonymous_code=t.anonymousCode}else if(e.isPlatform([e.Platform.LianShangMiniGame,e.Platform.Android,e.Platform.iOS])){var n={};n.code=t.code}else if(e.isPlatform(e.Platform.OPPO)){e.Info.nickname=t.nickName,e.Info.avatar=t.avatar,e.Info.token=t.token;var a={};a.code=t.uid}else if(e.isPlatform(e.Platform.Vivo)){e.Info.token=t.code;var s={};s.token=t.code}else if(e.isPlatform(e.Platform.Hago)){var l={};l.js_code=t.code,l.countryCode=o.countryCode}else{var c={};c.js_code=t.code}},fail:function(i){console.log(i);var n={title:"Tips",content:"Failed to obtain login data (platform authorization failed). Click Retry",showCancel:!1,confirmText:"Retry",success:function(){t(o)}};e.PA.showModal(n)}})}},e.isNextRewardVideo=function(t){var o=!0;try{if(!e.Info.underCheck){var i=e.Info.rewardConfigOriginData.get(t);(null==i||i.rule.length<=0)&&(i=e.Info.rewardConfigOriginData.get("SCORE_STRATEGY"));var n=e.Info.rewardUserData.data.get(t);for(null==n&&(n=e.Info.rewardUserData.data.get("SCORE_STRATEGY"));n.currCount>=i.rule[n.currIndex].count;)if(n.currIndex+=1,n.currCount=0,n.currIndex>=i.rule.length){n.currIndex=0,n.currCount=0;break}o="video"==i.rule[n.currIndex].type}}catch(e){o=!0}return o},e.loadRewardUserLocalData=function(){try{var t=e.PA.getStorageSync("RewardUserData");if(!t||""==t)throw"loadRewardUserData:\u672c\u5730RewardUserData\u4e0d\u5b58\u5728";try{var o=JSON.parse(t);if(!(o.time>e.Info.rewardUserData.time&&e.isToday(o.time)))throw"\u6570\u636e\u5df2\u8fc7\u671f";if(e.Info.rewardUserData.time=o.time,e.Info.rewardUserData.data.clear(),o.data.length<=0)throw"\u6570\u636e\u4e3a\u7a7a";o.data.forEach(function(t){e.Info.rewardUserData.data.set(t.tag,{currIndex:t.currIndex,currCount:t.currCount})}),e.Info.rewardConfigOriginData.forEach(function(t,o){e.Info.rewardUserData.data.has(o)||e.Info.rewardUserData.data.set(o,{currIndex:0,currCount:0})})}catch(e){throw"loadRewardUserData:\u672c\u5730RewardUserData\u6570\u636e\u89e3\u6790\u5931\u8d25"}}catch(d){e.log(d),e.Info.rewardUserData.time=Date.now(),e.Info.rewardUserData.data.clear(),e.Info.rewardConfigOriginData.forEach(function(t,o){t.rule.length>0&&e.Info.rewardUserData.data.set(o,{currIndex:0,currCount:0})})}e.log("RewardUserData",e.Info.rewardUserData)},e.getNavigationList=function(){},e.enterPage=function(t){var o,i={};i.page=t.page,i.time=0,e.Info.pageList.push(i);var n,a={};a.page=t.page,a.existRedirect=t.existRedirect?1:0,a.existVideo=t.existVideo?1:0,a.existBanner=t.existBanner?1:0,a.openType=null!=(o=t.openType)?o:0,n=a,e.sentLog("EnterPage",void 0,n)},e.closePage=function(t){var o=s(t.page);if(o){var i={};i.page=t.page,e.sentLog("ClosePage",o.time,i)}},e.videoRequestEvent=function(t,o){t||console.error("pageName is empty!");var i,n=[];o.forEach(function(e){var o={};o.page=t,o.type=e;var i={eventId:"VideoRequest"};i.detail=JSON.stringify(o),n.push(i)}),i=n,e.sentLogs(i)},e.clickEvent=function(t,o,i,n){if(e.Info.pageList&&e.Info.pageList.length>0){t||console.error("pageName is empty!");var a=o,r=e.Info.pageList[e.Info.pageList.length-1],s=!1;r.map?!r.map.get(i)&&(r.map.set(i,1),s=!0):(r.map=new Map,r.map.set(i,1),s=!0);var l="video"==i?a:null,c="other"!=i?r.time:0,d={};d.page=t,d.eventType="click",d.posType=i,d.pos=l,d.isFirstClick=s?1:0;var h=d;n&&(h.classify=n),e.sentLog(o,c,h)}},e.isDefault=function(){return e.isPlatform(e.Platform.Default)},e.isWeChat=function(){return e.isPlatform(e.Platform.WeChat)},e.isQQ=function(){return e.isPlatform(e.Platform.QQ)},e.isOPPO=function(){return e.isPlatform(e.Platform.OPPO)},e.isVivo=function(){return e.isPlatform(e.Platform.Vivo)},e.isKuaiDianWan=function(){return e.isPlatform(e.Platform.Kuaidianwan)},e.isQuTouTiao=function(){return e.isPlatform(e.Platform.QuTouTiao)},e.isQuTouTiaoAndroid=function(){return e.isPlatform(e.Platform.QuTouTiaoAndroid)},e.isByteDance=function(){return e.isPlatform(e.Platform.ByteDance)},e.isYueYou=function(){return e.isPlatform(e.Platform.YueYou)},e.isKuaiKan=function(){return e.isPlatform(e.Platform.KuaiKan)},e.isBaoQu=function(){return e.isPlatform(e.Platform.BaoQu)},e.isAndroid=function(){return e.isPlatform(e.Platform.Android)},e.isiOS=function(){return e.isPlatform(e.Platform.iOS)},e.isUCMiniGame=function(){return e.isPlatform(e.Platform.UCMiniGame)},e.isLianShangMiniGame=function(){return e.isPlatform(e.Platform.LianShangMiniGame)},e.isKwaigame=function(){return e.isPlatform(e.Platform.Kwaigame)},e.isM4399MiniGame=function(){return e.isPlatform(e.Platform.M4399MiniGame)},e.isNative=function(){return e.isPlatform(e.Platform.iOS)||e.isPlatform(e.Platform.Android)},e.isOppoAndroid=function(){return e.isPlatform(e.Platform.Android)&&e.Info.distributionChannel==e.DistributionChannel.OPPO}}(s||(s={})),function(e){window.GoogleService=e;var t,o,i=new Map;function n(e,t){for(var o=arguments.length,i=new Array(o>2?o-2:0),n=2;n<o;n++)i[n-2]=arguments[n];console.log("call android native "+e+" "+t+" "+i.join(","));try{var a;return(a=jsb.reflection).callStaticMethod.apply(a,["com/kariqu/googleservice/GSSDK",e,t].concat(i))}catch(e){return console.error(JSON.stringify(e)),null}}(o=t=e.ListenerKey||(e.ListenerKey={})).SIGN_IN="SIGN_IN",o.SIGN_IN_FAILED="SIGN_IN_FAILED",o.SIGN_OUT="SIGN_OUT",o.SAVE_FILE="SAVE_FILE",o.LOAD_SAVE_FILE="LOAD_SAVE_FILE",o.REMOTE_CONFIG_SYNC="REMOTE_CONFIG_SYNC",o.GOT_SKU_DETAIL="GOT_SKU_DETAIL",o.PENDING_ORDER="PENDING_ORDER",o.RECOVER_ACKNOWLEDGED_SKUS="RECOVER_ACKNOWLEDGED_SKUS",o.PURCHASE_RESULT="PURCHASE_RESULT",e.registListener=function(e,t){i.set(e,t)},e.unregistListener=function(e){i.delete(e)},e.onSignIn=function(){if(i.has(t.SIGN_IN))try{i.get(t.SIGN_IN)()}catch(e){}},e.onSignInFailed=function(e){if(i.has(t.SIGN_IN_FAILED))try{i.get(t.SIGN_IN_FAILED)(e)}catch(e){}},e.onSignOut=function(){if(i.has(t.SIGN_OUT))try{i.get(t.SIGN_OUT)()}catch(e){}},e.onSaveFile=function(e){if(i.has(t.SAVE_FILE))try{i.get(t.SAVE_FILE)(e)}catch(e){}},e.onLoadSavefile=function(e,o){if(i.has(t.LOAD_SAVE_FILE))try{i.get(t.LOAD_SAVE_FILE)(e,o)}catch(e){}},e.onRemoteConfigSynced=function(e){if(i.has(t.REMOTE_CONFIG_SYNC))try{i.get(t.REMOTE_CONFIG_SYNC)(e)}catch(e){}},e.onPendingOrder=function(e){if(i.has(t.PENDING_ORDER))try{i.get(t.PENDING_ORDER)(JSON.parse(e))}catch(e){}},e.onPurchaseResult=function(e,o){if(i.has(t.PURCHASE_RESULT))try{i.get(t.PURCHASE_RESULT)(e,o)}catch(e){}},e.onGotSkuDetail=function(e,o){if(i.has(t.GOT_SKU_DETAIL))try{i.get(t.GOT_SKU_DETAIL)(e,o)}catch(e){}},e.onRecoverAcknowledgedPurchase=function(e){if(i.has(t.RECOVER_ACKNOWLEDGED_SKUS))try{i.get(t.RECOVER_ACKNOWLEDGED_SKUS)(JSON.parse(e))}catch(e){}},e.signIn=function(){n("signIn","()V")},e.signInSilently=function(){n("signInSilently","()V")},e.signOut=function(){n("signOut","()V")},e.saveFile=function(e){n("saveFile","(Ljava/lang/String;)V",e)},e.loadSavefile=function(){n("loadSavefile","()V")},e.setAcknowledgedSku=function(e){n("setAcknowledgedSku","(Ljava/lang/String;)V",JSON.stringify(e))},e.loadSkuDetail=function(e,t){n("loadSkuDetail","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),JSON.stringify(t))},e.purchaseSku=function(e){n("purchaseSku","(Ljava/lang/String;)V",e)},e.checkPurchase=function(){n("checkPurchase","()V")},e.syncRemoteConfig=function(){n("syncRemoteConfig","()V")},e.confirmPurchase=function(e){n("confirmPurchase","(Ljava/lang/String;)V",e)},e.getRemoteConfig=function(){var e=n("getRemoteConfig","()Ljava/lang/String;");s.log("Google RemoteConfig is "+e);for(var t=JSON.parse(e),o=new Map,i=0,a=Object.keys(t);i<a.length;i++){var r=a[i];o.set(r,t[r])}return o},e.getOrderInfo=function(e){return n("getOrderInfo","(Ljava/lang/String;)Ljava/lang/String;",e)},e.recoverAcknowledgedPurchase=function(){return n("recoverAcknowledgedPurchase","()V")}}(n||(n={})),window.kariqu_ios_proxy=new(function(){function e(){var e=this;this.compatibleMethods=["onShareMessageToFriend","showShareMenu","onShareTimeline","onShareAppMessage","getUpdateManager","onTouchEnd","onTouchStart","offTouchStart","offTouchEnd","triggerGC"],this.bridge=null,this.isSplashAdEnd=!1,this.splashAdEndCallback=null,this.callbacks=new Map,this.callbackValidTimes=new Map,this.times=0,console.log("IOSProxy ts is constructed."),this.compatibleMethods.forEach(function(t){e[t]=function(){console.log("iOS \u6682\u4e0d\u652f\u6301"+t)}});try{this.bridge=PlatformClass.createClass("GameAssistantProxy")}catch(c){}}var t=e.prototype;return t.setSplashAdEnd=function(){this.isSplashAdEnd=!0,this.splashAdEndCallback&&this.splashAdEndCallback(),this.splashAdEndCallback=null},t.showSplashAd=function(){this.native("showSplashAd")},t.afterSplashAd=function(e){this.isSplashAdEnd?e():this.splashAdEndCallback=e},t.native=function(e){for(var t,o=arguments.length,i=new Array(o>1?o-1:0),n=1;n<o;n++)i[n-1]=arguments[n];(t=console).log.apply(t,["call ios native ",e].concat(i));try{var a,r;if(s.isEngine(s.EngineType.CocosCreator))return(a=jsb.reflection).callStaticMethod.apply(a,["GameAssistantProxy",e].concat(i));if(s.isEngine(s.EngineType.LayaAir))return(r=this.bridge).call.apply(r,[e].concat(i))}catch(e){}},t.callCallback=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];if(this.callbacks.has(e)){console.log("ios call jscallback : ",e,JSON.stringify(o));try{this.callbacks.get(e).apply(void 0,o)}catch(e){console.error(e)}finally{var n=this.callbackValidTimes.get(e);n>1?this.callbackValidTimes.set(e,n-1):(this.callbacks.delete(e),this.callbackValidTimes.delete(e))}}else console.log("ios call jscallback(not exist): ",e,JSON.stringify(o))},t.addCallback=function(e,t,o){this.callbacks.set(e,t),this.callbackValidTimes.set(e,o)},t.uuid=function(){return this.times++,Date.now()+"-"+this.times},t.onShow=function(){},t.offShow=function(){},t.onHide=function(){},t.offHide=function(){},t.getSystemInfoSync=function(){var e;return JSON.parse(null!=(e=this.native("getSystemInfoSync"))?e:"{}")},t.getLaunchOptionsSync=function(){var e;return JSON.parse(null!=(e=this.native("getLaunchOptionsSync"))?e:"{}")},t.exitMiniProgram=function(){this.native("exitMiniProgram")},t.showRewardVideoAd=function(e){var t="showRewardVideoAd:show:"+this.uuid();this.addCallback(t,e,2),this.native("showRewardVideoAdWithCallbackKey:",t)},t.showFullScreenVideoAd=function(){this.native("showFullScreenVideoAd")},t.showInterstitialAd=function(){this.native("showInterstitial")},t.showBanner=function(e,t,o,i){this.native("showBannerAdWithOffsetX:offsetY:width:height:",e,t,o,i)},t.hideBanner=function(){this.native("hideBannerAd")},t.showNativeAd=function(e){var t,o,i,n;this.native("showNativeAdWithOffsetX:offsetY:width:height:",null!=(t=e.offsetX)?t:0,null!=(o=e.offsetY)?o:0,null!=(i=e.width)?i:0,null!=(n=e.height)?n:0)},t.hideNativeAd=function(){this.native("hideNativeAd")},t.showToast=function(e){var t;e.duration&&e.duration>100&&(e.duration=e.duration/1e3),this.native("showToast:duration:",e.title,null!=(t=e.duration)?t:1.5)},t.showModal=function(e){var t,o,i="showModal:"+this.uuid();this.native("showModal:content:showCancel:cancelText:confirmText:callbackKey:",e.title,e.content,!!e.showCancel,null!=(t=e.cancelText)?t:"\u53d6\u6d88",null!=(o=e.confirmText)?o:"\u786e\u8ba4",i),this.addCallback(i,e.success,1)},t.showLoading=function(e){var t;this.native("showLoading:mask:",null!=(t=e.title)?t:"",!!e.mask)},t.hideLoading=function(){this.native("hideLoading")},t.showShareMenu=function(){this.native("showShareMenu")},t.shareAppMessage=function(){},t.login=function(e){var t,o,i,n=this.native("login"),a={};a.code=n,null===(i=null===(t=e)||void 0===t?void 0:(o=t).success)||void 0===i||i.call(o,a)},t.setUserId=function(e){this.native("setUserId:",e)},t.setKeepScreenOn=function(){},t.vibrateShort=function(){this.native("vibrate:",15)},t.vibrateLong=function(){this.native("vibrate:",400)},t.setClipboardData=function(e){var t;this.native("setClipboardData:",null!=(t=e.data)?t:"")},t.getClipboardData=function(e){try{var t={};t.data=this.native("getClipboardData"),e.success(t)}catch(e){}},t.getBatteryInfo=function(){},t.getBatteryInfoSync=function(){return{level:0,isCharging:!1}},t.onOceanEngineInit=function(){this.native("onOceanEngineInit")},t.reportKeyAction=function(e){e?this.native("reportKeyAction:",e):this.native("reportKeyAction")},t.onOceanEngineRegister=function(e,t){this.native("onOceanEngineRegister:success:",e,t)},t.onOceanEnginePurchase=function(e,t){this.native("onOceanEnginePurchase:success:",e,t)},t.getMenuButtonBoundingClientRect=function(){var e={};return e.top=this.native("getTopUnsafeArea"),e.left=0,e.right=0,e.bottom=0,e.width=0,e.height=0,e},t.exitApplication=function(){this.native("exitApplication")},t.isRewardVideoAdReady=function(){return this.native("isRewardVideoAdReady")},e}()),(a=s||(s={})).PAClass=function(){function e(){this.platformObject=null,this.launchOptions=null,this.selfShowToast=null}var t=e.prototype;return t.init=function(e){var t=this,o=[];if(a.Info.isPreview||a.isPlatform(a.Platform.Kuaidianwan)||a.isPlatform(a.Platform.M4399MiniGame))o.push("getSetting","showLoading","hideLoading","createUserInfoButton","getUpdateManager","onTouchEnd","onTouchStart","offTouchStart","offTouchEnd","setKeepScreenOn","showShareMenu","loadSubpackage","onShareMessageToFriend","onShareAppMessage","saveAppToDesktop","initGameBannerAd","addColorSign","addRecentColorSign","subscribeAppMsg","onShareTimeline","vibrateShort","vibrateLong");else{if(a.isPlatform([a.Platform.Android,a.Platform.iOS]))Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(function(o){null==t[o]&&(t[o]=function(){return e[o].apply(e,arguments)})}),Object.getOwnPropertyNames(e).forEach(function(o){null==t[o]&&"function"==typeof e[o]&&(t[o]=function(){return e[o].apply(e,arguments)})});else if(e)for(var i in o.push("showNativeAd","hideNativeAd"),e)null==this[i]&&(this[i]=e[i]);this.platformObject=e}o.forEach(function(e){t[e]=function(){console.log("Preview \u6682\u4e0d\u652f\u6301"+e)}})},t.addUnsupportMethods=function(e,t){var o=this;a.isPlatform(e)&&t.forEach(function(t){o[t]=function(){console.log(e+" \u6682\u4e0d\u652f\u6301"+t)}})},t.afterSplashAd=function(e){var t,o,i,n,a;(null===(t=this.platformObject)||void 0===t?void 0:t.afterSplashAd)?null===(n=null===(o=this.platformObject)||void 0===o?void 0:(i=o).afterSplashAd)||void 0===n||n.call(i,e):null===(a=e)||void 0===a||a()},t.onShow=function(e){a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.game.on(cc.game.EVENT_SHOW,e):a.log("laya onShow \u6682\u672a\u5b9e\u73b0"):a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.onShow(e):this.platformObject.onShow(e)},t.offShow=function(e){a.isPlatform([a.Platform.Android,a.Platform.iOS])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.game.off(cc.game.EVENT_SHOW,e):a.log("laya offShow \u6682\u672a\u5b9e\u73b0"):a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.offShow(e):this.platformObject.offShow(e)},t.onHide=function(e){a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.game.on(cc.game.EVENT_HIDE,e):a.log("laya onhide \u6682\u672a\u5b9e\u73b0"):a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.onHide(e):this.platformObject.onHide(e)},t.offHide=function(e){a.isPlatform([a.Platform.Android,a.Platform.iOS])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.game.off(cc.game.EVENT_HIDE,e):a.log("laya offHide \u6682\u672a\u5b9e\u73b0"):a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.offHide(e):this.platformObject.offHide(e)},t.getLaunchOptionsSync=function(){if(a.Info.isPreview||a.isPlatform([a.Platform.M4399MiniGame,a.Platform.Kuaidianwan])){return{path:"",query:{},referrerInfo:{appId:"",extraData:{}},scene:0,shareTicket:""}}return this.launchOptions&&0!=Object.keys(this.launchOptions).length?this.launchOptions:this.launchOptions=this.platformObject.getLaunchOptionsSync()},t.getSystemInfoSync=function(){return null==a.Info.systemInfo&&(a.Info.isPreview||a.isPlatform([a.Platform.M4399MiniGame,a.Platform.Kuaidianwan])?a.Info.systemInfo={SDKVersion:"",albumAuthorized:!1,benchmarkLevel:100,bluetoothEnabled:!1,brand:"Browser",cameraAuthorized:!1,fontSizeSetting:0,language:"zh-cn",locationAuthorized:!1,locationEnabled:!1,microphoneAuthorized:!1,model:"Browser",notificationAlertAuthorized:!1,notificationAuthorized:!1,notificationBadgeAuthorized:!1,notificationSoundAuthorized:!1,pixelRatio:1,platform:"Browser",screenHeight:a.Info.resolution.height,screenWidth:a.Info.resolution.width,statusBarHeight:0,system:"iOS",version:"",wifiEnabled:!1,windowHeight:a.Info.resolution.height,windowWidth:a.Info.resolution.width,designPixelRatio:1,appName:"",safeArea:{left:0,right:0,top:0,bottom:0,width:a.Info.resolution.width,height:a.Info.resolution.height}}:a.Info.systemInfo=this.platformObject.getSystemInfoSync(),a.Info.systemInfo.windowHeight/a.Info.systemInfo.windowWidth<1.5?a.Info.systemInfo.designPixelRatio=a.Info.resolution.height/a.Info.systemInfo.windowHeight:a.Info.systemInfo.designPixelRatio=a.Info.resolution.width/a.Info.systemInfo.windowWidth),a.Info.systemInfo},t.exitMiniProgram=function(){var e;try{(null!=(e=this.platformObject.exitMiniProgram)?e:this.platformObject.exitApplication)()}catch(e){a.error(e)}},t.loadSubpackage=function(e){return this.platformObject&&this.platformObject.loadSubpackage?this.platformObject.loadSubpackage(e):(a.UnsupportLog("loadSubpackage"),null)},t.createRewardedVideoAd=function(e){return a.isPlatform(a.Platform.Vivo)&&(e.posId=e.adUnitId),this.platformObject.createRewardedVideoAd(e)},t.createInterstitialAd=function(e){return a.isPlatform(a.Platform.OPPO)?this.platformObject.createInsertAd(e):a.isPlatform(a.Platform.Vivo)?(e.posId=e.adUnitId,this.platformObject.createInterstitialAd(e)):this.platformObject.createInterstitialAd(e)},t.saveAppToDesktop=function(e){a.isPlatform(a.Platform.QQ)&&this.platformObject.saveAppToDesktop(e)},t.addColorSign=function(e){a.isPlatform(a.Platform.QQ)&&this.platformObject.addColorSign(e)},t.addRecentColorSign=function(e){a.isPlatform(a.Platform.QQ)&&this.platformObject.addRecentColorSign(e)},t.isColorSignExistSync=function(){return!!a.isPlatform(a.Platform.QQ)&&this.platformObject.isColorSignExistSync()},t.getLanguage=function(){return this.platformObject.getLanguage?this.platformObject.getLanguage():"zh-CN"},t.initGameBannerAd=function(e,t,o,i){if(void 0===o&&(o=!0),a.isPlatform(a.Platform.OPPO)){var n,r=this.platformObject.getSystemInfoSync().platformVersionCode;if(!i){var s={};s.left=100/this.getSystemInfoSync().designPixelRatio,s.top=(a.Info.resolution.height-200)/this.getSystemInfoSync().designPixelRatio,s.orientation="horizontal",i=s}if(r>=1090&&!o&&t){var l={};l.adUnitId=t,l.style=i,n=this.platformObject.createGameBannerAd(l)}else if(r>=1076){var c={};c.adUnitId=e,n=this.platformObject.createGameBannerAd(c)}return n}},t.showInterstitialAd=function(){a.isPlatform(a.Platform.Android)?this.platformObject.showInterstitialAd():a.isPlatform(a.Platform.iOS)&&this.platformObject.showInterstitialAd()},t.setShowToast=function(e){this.selfShowToast=e},t.showToast=function(e){if(a.Info.isPreview||a.isPlatform(a.Platform.M4399MiniGame))a.log("showToast:",e.title);else if(this.selfShowToast)this.selfShowToast(e);else if(a.isPlatform(a.Platform.Vivo)){var t={};t.message=e.title,t.duration=e.duration,this.platformObject.showToast(t)}else a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.showToast(e.title):this.platformObject.showToast(e)},t.showModal=function(e){var t,o;if(a.Info.isPreview||a.isPlatform(a.Platform.M4399MiniGame))a.log("showModal:"+e.content),e.success({confirm:!1===e.showCancel,cancel:0!=e.showCancel});else{if(a.isPlatform(a.Platform.Vivo)){var i=[],n={};if(n.text=null!=(t=e.confirmText)?t:"OK",n.color=e.confirmColor,i.push(n),e.showCancel){var r={};r.text=null!=(o=e.cancelText)?o:"NO",r.color=e.cancelColor,i.push(r)}var s={};return s.title=e.title,s.message=e.content,s.buttons=i,s.success=function(t){0==t.index?e.success({confirm:!0,cancel:!1}):1==t.index?e.success({confirm:!1,cancel:!0}):e.success({confirm:!1,cancel:!1})},s.cancel=e.fail,s.complete=e.complete,this.platformObject.showDialog(s)}if(!a.isPlatform(a.Platform.Kuaidianwan))return this.platformObject.showModal(e);GameAssistantWeb.showModal(e.title,e.content,e.confirmText,e.cancelText,function(t,o){var i={};i.confirm=t,i.cancel=o,e.success(i)})}},t.showLoading=function(e){if(!a.isPlatform(a.Platform.Vivo))return this.platformObject.showLoading(e);var t={};t.message=e.title,t.success=e.success,t.cancel=e.fail,t.complete=e.complete,this.platformObject.showLoading(t)},t.getMenuButtonBoundingClientRect=function(){var e;if(a.isPlatform(a.Platform.OPPO)){var t={};return t.top=this.getSystemInfoSync().statusBarHeight,t.left=0,t.right=0,t.bottom=0,t.width=0,t.height=0,t}return(null===(e=this.platformObject)||void 0===e?void 0:e.getMenuButtonBoundingClientRect)?this.platformObject.getMenuButtonBoundingClientRect():{top:0,left:0,right:0,bottom:0,width:0,height:0}},t.shareAppMessage=function(e){if(a.isPlatform(a.Platform.Vivo)){var t={};return t.success=e.success,t.fail=e.fail,t.cancel=e.fail,this.platformObject.share(t)}return e.extra&&(e.extra.hashtag_list&&null==e.extra.videoTopics?e.extra.videoTopics=e.extra.hashtag_list:e.extra.videoTopics&&null==e.extra.hashtag_list&&(e.extra.hashtag_list=e.extra.videoTopics)),this.platformObject.shareAppMessage(e)},t.setStorageSync=function(e,t){if(a.isPlatform(a.Platform.Vivo)){var o={};o.key=e,o.value=t,this.platformObject.setStorageSync(o)}else a.isPlatform(a.Platform.OPPO)?localStorage.setItem(e,t):a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.sys.localStorage.setItem(e,t):a.isEngine(a.EngineType.LayaAir)&&localStorage.setItem(e,t):a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.setStorage(e,t):this.platformObject.setStorageSync(e,t)},t.setStorage=function(e){var t,o;if(a.isPlatform(a.Platform.Vivo)){var i={};return i.key=e.key,i.value=e.data,i.success=e.success,i.fail=e.fail,i.complete=e.complete,this.platformObject.setStorage(i)}if(a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview){if(a.isEngine(a.EngineType.CocosCreator)){cc.sys.localStorage.setItem(e.key,e.data);try{e.success()}catch(e){}}else if(a.isEngine(a.EngineType.LayaAir)){localStorage.setItem(e.key,e.data);try{e.success()}catch(e){}}}else{if(!a.isPlatform(a.Platform.Kuaidianwan))return this.platformObject.setStorage(e);GameAssistantWeb.setStorage(e.key,e.data),null===(o=(t=e).success)||void 0===o||o.call(t)}},t.removeStorageSync=function(e){if(a.isPlatform(a.Platform.Vivo)){var t={};return t.key=e,this.platformObject.deleteStorageSync(t)}if(a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview)a.isEngine(a.EngineType.CocosCreator)?cc.sys.localStorage.removeItem(e):a.isEngine(a.EngineType.LayaAir)&&localStorage.removeItem(e);else{if(!a.isPlatform(a.Platform.Kuaidianwan))return this.platformObject.removeStorageSync(e);GameAssistantWeb.removeStorage(e)}},t.removeStorage=function(e){var t,o;if(a.isPlatform(a.Platform.Vivo))return this.platformObject.deleteStorage(e);if(a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview){if(a.isEngine(a.EngineType.CocosCreator)){cc.sys.localStorage.removeItem(e.key);try{e.success()}catch(e){}}else if(a.isEngine(a.EngineType.LayaAir)){localStorage.removeItem(e.key);try{e.success()}catch(e){}}}else{if(!a.isPlatform(a.Platform.Kuaidianwan))return this.platformObject.removeStorage(e);GameAssistantWeb.removeStorage(e.key),null===(o=(t=e).success)||void 0===o||o.call(t)}},t.getStorageSync=function(e){if(a.isPlatform(a.Platform.Vivo)){var t={};return t.key=e,this.platformObject.getStorageSync(t)}return a.isPlatform(a.Platform.OPPO)?localStorage.getItem(e):a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview?a.isEngine(a.EngineType.CocosCreator)?cc.sys.localStorage.getItem(e):a.isEngine(a.EngineType.LayaAir)?localStorage.getItem(e):void 0:a.isPlatform(a.Platform.Kuaidianwan)?GameAssistantWeb.getStorage(e):this.platformObject.getStorageSync(e)},t.getStorage=function(e){var t,o;if(this.platformObject.getStorage)return this.platformObject.getStorage(e);if(a.isPlatform([a.Platform.Android,a.Platform.iOS,a.Platform.M4399MiniGame])||a.Info.isPreview){if(a.isEngine(a.EngineType.CocosCreator))try{e.success(cc.sys.localStorage.getItem(e.key))}catch(e){}else if(a.isEngine(a.EngineType.LayaAir))try{e.success(localStorage.getItem(e.key))}catch(e){}}else if(a.isPlatform(a.Platform.Kuaidianwan))null===(o=(t=e).success)||void 0===o||o.call(t,GameAssistantWeb.getStorage(e.key));else try{e.success("")}catch(e){}},t.navigateToMiniProgram=function(e){var t,o;e.pkgName=null!=(t=e.pkgName)?t:e.appId,(null!=(o=this.platformObject.navigateToMiniGame)?o:this.platformObject.navigateToMiniProgram)(e)},t.getUserInfo=function(e){if(a.isPlatform(a.Platform.Vivo)){var t={success:function(t){try{var o={};o.nickName=t.data.nickName,o.avatarUrl=t.data.biggerAvatar,o.gender=1==t.data.gender?"1":2==t.data.gender?"2":"0",o.country="",o.province="",o.city="",o.language="zh_CN";var i={};i.userInfo=o,i.rawData="",i.signature="",i.encryptedData="",i.iv="",i.cloudID="",e.success(i)}catch(e){console.error(e)}}};return t.fail=e.fail,this.platformObject.getUserInfo(t)}return this.platformObject.getUserInfo(e)},t.login=function(e){if(a.isPlatform(a.Platform.Vivo)){var t={success:function(t){try{var o={};o.code=t.data.token,e.success(o)}catch(e){console.error(e)}}};return t.fail=e.fail,this.platformObject.login(t)}return a.isPlatform(a.Platform.QuTouTiao)?this.platformObject.qttlogin(e):this.platformObject.login(e)},t.checkIsUserAdvisedToRest=function(){a.isPlatform(a.Platform.WeChat)},t.setOrientation=function(e){a.isPlatform(a.Platform.YueYou)&&Yzsdk.setOrientation(e)},t.setFullScreen=function(e){a.isPlatform(a.Platform.YueYou)&&Yzsdk.setFullScreen(e)},t.initYueYou=function(){a.isPlatform(a.Platform.YueYou)&&Yzsdk.init()},t.getAuthCode=function(e,t,o){a.isPlatform(a.Platform.YueYou)&&Yzsdk.getAuthCode(e,t,o)},t.openGameAd=function(e,t,o,i,n,r){a.isPlatform(a.Platform.YueYou)&&Yzsdk.openGameAd(e,t,o,i,n,r)},t.addViewStateListener=function(e){a.isPlatform(a.Platform.YueYou)&&Yzsdk.addViewStateListener(e)},t.removeViewStateListener=function(){a.isPlatform(a.Platform.YueYou)&&Yzsdk.removeViewStateListener()},t.screenWidth=function(){return a.isPlatform(a.Platform.YueYou)?Yzsdk.screenWidth():0},t.screenHeight=function(){return a.isPlatform(a.Platform.YueYou)?Yzsdk.screenHeight():0},t.joinVoIPChat=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.joinVoIPChat)?wx.joinVoIPChat(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.joinVoIPChat)&&qg.joinVoIPChat(e)},t.exitVoIPChat=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.exitVoIPChat)?wx.exitVoIPChat(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.exitVoIPChat)&&qg.exitVoIPChat(e)},t.updateVoIPChatMuteConfig=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.updateVoIPChatMuteConfig)?wx.updateVoIPChatMuteConfig(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.updateVoIPChatMuteConfig)&&qg.updateVoIPChatMuteConfig(e)},t.onVoIPChatSpeakersChanged=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.onVoIPChatSpeakersChanged)?wx.onVoIPChatSpeakersChanged(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.onVoIPChatSpeakersChanged)&&qg.onVoIPChatSpeakersChanged(e)},t.onVoIPChatMembersChanged=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.onVoIPChatMembersChanged)?wx.onVoIPChatMembersChanged(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.onVoIPChatMembersChanged)&&qg.onVoIPChatMembersChanged(e)},t.onVoIPChatInterrupted=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.onVoIPChatInterrupted)?wx.onVoIPChatInterrupted(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.onVoIPChatInterrupted)&&qg.onVoIPChatInterrupted(e)},t.offVoIPChatSpeakersChanged=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.offVoIPChatSpeakersChanged)?wx.offVoIPChatSpeakersChanged(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.offVoIPChatSpeakersChanged)&&qg.offVoIPChatSpeakersChanged(e)},t.offVoIPChatMembersChanged=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.offVoIPChatMembersChanged)?wx.offVoIPChatMembersChanged(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.offVoIPChatMembersChanged)&&qg.offVoIPChatMembersChanged(e)},t.offVoIPChatInterrupted=function(e){var t,o;a.isPlatform(a.Platform.WeChat)&&(null===(t=wx)||void 0===t?void 0:t.offVoIPChatInterrupted)?wx.offVoIPChatInterrupted(e):a.isPlatform(a.Platform.OPPO)&&(null===(o=qg)||void 0===o?void 0:o.offVoIPChatInterrupted)&&qg.offVoIPChatInterrupted(e)},t.isRewardVideoAdReady=function(){return!!a.isPlatform([a.Platform.iOS,a.Platform.Android])&&this.platformObject.isRewardVideoAdReady()},e}(),function(e){var t=function(){function e(e){this.seed=e,!this.seed&&0!=this.seed&&(this.seed=(new Date).getTime())}var t,i,n,a=e.prototype;return a.range=function(e,t){return!this.seed&&0!=this.seed&&(this.seed=(new Date).getTime()),t=t||1,e=e||0,this.seed=(9301*this.seed+49297)%233280,e+this.seed/233280*(t-e)},a.rangeInt=function(e,t){return t-e>=233280?0:(!this.seed&&0!=this.seed&&(this.seed=(new Date).getTime()),t=t||1,e=e||0,this.seed=(9301*this.seed+49297)%233280,e+this.seed%(t-e+1))},e.range=function(e,t){return this.internalInstance.range(e,t)},e.rangeInt=function(e,t){return this.internalInstance.rangeInt(e,t)},t=e,n=[{key:"internalInstance",get:function(){return null==this._internalInstance&&(this._internalInstance=new e),this._internalInstance}},{key:"value",get:function(){return this.internalInstance.range(0,1)}}],(i=[{key:"value",get:function(){return this.range(0,1)}}])&&o(t.prototype,i),n&&o(t,n),e}();t._internalInstance=null,e.Random=t}(s||(s={})),function(e){function t(t){return t instanceof Array?t.indexOf(e.Info.platform)>=0:e.Info.platform==t}function o(t){return t instanceof Array?t.indexOf(e.Info.engine)>=0:e.Info.engine==t}function i(){for(var i,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];o(e.EngineType.LayaAir)&&t([e.Platform.iOS,e.Platform.Android])?console.warn("GA:"+a.join(",")):(i=console).warn.apply(i,["GA:"].concat(a))}e.isPlatform=t,e.isEngine=o,e.log=function(){for(var i,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];e.Info.debugLog&&(o(e.EngineType.LayaAir)&&t([e.Platform.iOS,e.Platform.Android])?console.log("GA:"+a.join(",")):(i=console).log.apply(i,["GA:"].concat(a)))},e.warn=i,e.error=function(){for(var i,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];o(e.EngineType.LayaAir)&&t([e.Platform.iOS,e.Platform.Android])?console.error("GA:"+a.join(",")):(i=console).error.apply(i,["GA:"].concat(a))},e.UnsupportLog=function(t){i("\u5f53\u524d\u5e73\u53f0 "+e.Info.platform+" \u6682\u4e0d\u652f\u6301 "+t)},e.request=function(o){if(!t(e.Platform.M4399MiniGame)){if(e.PA&&e.PA.request&&!t(e.Platform.Vivo)){var n={};return n.appid=e.Info.appId,o.header=n,e.PA.request(o)}var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState){var t=a.responseText,n={data:""};n.statusCode=a.status,n.header={},n.errMsg=a.getAllResponseHeaders();var r=n;try{var s=JSON.parse(t);r.data=s}catch(e){r.data=a.responseText}a.status>=200&&a.status<400?"function"==typeof o.success&&o.success(r):(i('request fail with url : "'+o.url+'"'),"function"==typeof o.fail&&o.fail(r))}},a.onerror=function(){o.fail&&o.fail({errMsg:"request onerror"})},a.onabort=function(){o.fail&&o.fail({errMsg:"request onabort"})},void 0===o.method&&(o.method="GET"),a.open(o.method,o.url,!0),a.setRequestHeader("Content-type","application/json;charset=utf-8"),a.setRequestHeader("appid",e.Info.appId),void 0===o.data?a.send():a.send(JSON.stringify(o.data))}},e.sentLogs=function(){},e.sentLog=function(e,t,o){var i={};i.eventId=e,i.detail=o?JSON.stringify(o):"",i.extraNum=t||0},e.betweenNum=function(e,t,o){return Math.min(o,Math.max(t,e))},e.isiPhoneX=function(){var t=e.PA.getSystemInfoSync().model;return-1!=t.indexOf("iPhone X")||-1!=t.indexOf("iPhone12")||-1!=t.indexOf("iPhone13")},e.isLongScreen=function(){var t=e.PA.getSystemInfoSync();return t.windowHeight>t.windowWidth?t.windowHeight/t.windowWidth>1.8:t.windowWidth/t.windowHeight>1.8},e.isPad=function(){var t=e.PA.getSystemInfoSync();return t.windowHeight>t.windowWidth?t.windowHeight/t.windowWidth<1.55:t.windowWidth/t.windowHeight<1.55},e.isiPad=function(){return-1!=e.PA.getSystemInfoSync().model.indexOf("iPad")},e.isToday=function(e){return Math.floor(e/864e5)==Math.floor(Date.now()/864e5)},e.formatNumber=function(e){if(e<1e4)return e.toFixed();if(e<1e6)return(e/1e3).toFixed(1)+"K";if(e<1e9)return(e/1e3/1e3).toFixed(1)+"M";if(e<1e12)return(e/1e3/1e3/1e3).toFixed(1)+"B";if(e<1e15)return(e/1e3/1e3/1e3/1e3).toFixed(1)+"T";var t=Math.round(e).toString(),o=t.indexOf("e+");if(o>0){var i=t.substr(o+2);return t.substr(0,4)+"E"+i}var n=Math.round(e).toString().length-1;return(e/Math.pow(10,n)).toFixed(1)+"E"+n},e.formatTime=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),i=Math.floor(e%60),n="";return t>0&&(n=(t<10?"0":"")+t.toFixed()+":"),n+(o<10?"0":"")+o.toFixed()+":"+(i<10?"0":"")+i.toFixed()},e.rand=function(e,t){var o=Math.floor(e+Math.random()*(t-e+1));return o=Math.min(o,t),Math.max(o,e)},e.randFloat=function(e,t){return e+Math.random()*(t-e)},e.saveRedirect=function(){},e.loadServerConfig=function(){return new Promise(function(t,o){e.request({url:e.Urls.GameConfig+"?userId="+e.Info.uid,method:"POST",data:[],success:function(e){var i,n;0==(null===(n=null===(i=e)||void 0===i?void 0:i.data)||void 0===n?void 0:n.code)?t(e.data.data):o(e.data)},fail:function(e){o(e)}})})}}(s||(s={})),(r=s||(s={})).version="1.0.328",r.buildTime="2021-12-75:52:58 PM",function(e){var t,o;(o=t||(t={}))[o.Invalid=0]="Invalid",o[o.Loaded=1]="Loaded",o[o.Error=2]="Error",o[o.Shown=3]="Shown",o[o.Hidden=4]="Hidden";var i=new(function(){function o(){this.initOptions=new Map,this.showOptions=new Map,this.ads=new Map,this.status=new Map,this.showCount=new Map,this.sizes=new Map,this.tryShowCount=0}var i=o.prototype;return i.initBannerAd=function(o){var i,n,a,r,s,l=this,c=null!=(n=null===(i=s=Array.isArray(o)?o[0]:o)||void 0===i?void 0:i.adTag)?n:"Banner";this.initOptions.set(c,s),this.status.set(c,t.Invalid);var d,h,u=e.PA.getSystemInfoSync();if(h=e.isPlatform([e.Platform.WeChat])?u.screenWidth>u.screenHeight?300/u.designPixelRatio:u.screenWidth:Math.min(u.screenWidth,u.screenHeight),e.isPlatform([e.Platform.Vivo])){var p={left:0};p.top=(e.Info.resolution.height-100)/e.PA.getSystemInfoSync().designPixelRatio;var f={};f.posId=s.adId,f.adIntervals=null===(a=s)||void 0===a?void 0:a.adIntervals,f.style=p,d=f}else{var m={left:0,top:0};m.width=h;var g={};g.adUnitId=s.adId,g.adIntervals=null===(r=s)||void 0===r?void 0:r.adIntervals,g.style=m,d=g}var y=e.PA.createBannerAd(d);this.ads.set(c,y),y.onLoad(function(){l.status.set(c,t.Loaded)}),y.onError(function(o){l.status.set(c,t.Error),e.warn("banner onError:",o)}),e.isPlatform([e.Platform.Vivo])||y.onResize(function(e){var t={};t.width=e.width,t.height=e.height,l.sizes.set(c,t),l.updateBannerPosition(c)})},i.tryInitBannerAd=function(o){var i,n,a,r=this,s=null!=(i=o.initOption.adTag)?i:"Banner";this.status.set(s,t.Invalid);var l,c,d=e.PA.getSystemInfoSync();if(c=e.isPlatform([e.Platform.WeChat])?d.screenWidth>d.screenHeight?300/d.designPixelRatio:d.screenWidth:Math.min(d.screenWidth,d.screenHeight),e.isPlatform([e.Platform.Vivo])){var h={left:0};h.top=(e.Info.resolution.height-100)/e.PA.getSystemInfoSync().designPixelRatio;var u={};u.posId=o.initOption.adId,u.adIntervals=null===(n=o.initOption)||void 0===n?void 0:n.adIntervals,u.style=h,l=u}else{var p={left:0,top:0};p.width=c;var f={};f.adUnitId=o.initOption.adId,f.adIntervals=null===(a=o.initOption)||void 0===a?void 0:a.adIntervals,f.style=p,l=f}var m=e.PA.createBannerAd(l);this.ads.set(s,m),m.onLoad(function(){r.status.set(s,t.Loaded),o.success()}),m.onError(function(o){r.status.set(s,t.Error),e.warn("banner onError:",o)}),e.isPlatform([e.Platform.Vivo])||m.onResize(function(e){var t={};t.width=e.width,t.height=e.height,r.sizes.set(s,t),r.updateBannerPosition(s)})},i.updateBannerPosition=function(t){var o,i,n,a;if(!e.isPlatform([e.Platform.Vivo])){var r=this.showOptions.get(t),s=this.ads.get(t),l=this.sizes.get(t);if(s&&l){var c,d,h=e.PA.getSystemInfoSync();c=null!=(null===(i=null===(o=r)||void 0===o?void 0:o.style)||void 0===i?void 0:i.offsetX)?r.style.offsetX:(h.windowWidth-l.width)/2,d=null!=(null===(a=null===(n=r)||void 0===n?void 0:n.style)||void 0===a?void 0:a.offsetY)?h.windowHeight-l.height-r.style.offsetY:h.windowHeight-l.height,s.style.left=c,s.style.top=d,e.log("update banner position left:"+c+" top:"+d)}}},i.showBanner=function(o){var i,n,a,r,s,l=this;this.tryShowCount++;var c=null!=(n=null===(i=o)||void 0===i?void 0:i.adTag)?n:"Banner",d=this.sizes.get(c),h=e.PA.getSystemInfoSync();if(this.showOptions.set(c,o),this.ads.has(c)){var u,p=this.ads.get(c);if(u=(null===(r=null===(a=o)||void 0===a?void 0:a.style)||void 0===r?void 0:r.width)?o.style.width:e.isPlatform([e.Platform.WeChat])?h.screenWidth>h.screenHeight?300/h.designPixelRatio:h.screenWidth:Math.min(h.screenWidth,h.screenHeight),!e.isPlatform([e.Platform.Vivo])&&(p.style.width=u),(null===(s=d)||void 0===s?void 0:s.width)==u&&this.updateBannerPosition(c),this.status.get(c)==t.Shown)return void(this.tryShowCount=0);p.show().then(function(){l.tryShowCount=0,l.status.set(c,t.Shown)}).catch(function(){var e;try{if(l.tryShowCount>1)l.tryShowCount=0,null===(e=o)||void 0===e||e.fail();else{var t={};t.initOption=l.initOptions.get(c),t.success=function(){l.showBanner(o)},l.tryInitBannerAd(t)}}catch(e){}})}else this.tryShowCount=0,e.warn("Failed to display banner, advertisement label"+c+"nonexistence")},i.hideBanner=function(e){var o,i=null!=e?e:"Banner";try{if(this.ads.has(i)){this.showCount.has(i)?this.showCount.set(i,this.showCount.get(i)+1):this.showCount.set(i,1);var n=this.showCount.get(i),a=this.ads.get(i),r=null===(o=this.initOptions.get(i))||void 0===o?void 0:o.validTimes;a&&(n&&r&&n>=r?a.destroy&&(this.showCount.delete(i),a.destroy(),this.status.set(i,t.Invalid),this.initBannerAd(this.initOptions.get(i))):a.hide&&(a.hide(),this.status.set(i,t.Hidden)))}}catch(e){e(e)}},i.hideAllBanner=function(){},i.resumeShowBanner=function(){},i.clearAllBanner=function(){},i.isExistBanner=function(e){return!(!this.ads.has(e)||this.status.get(e)!=t.Loaded&&this.status.get(e)!=t.Shown&&this.status.get(e)!=t.Hidden)},o}());e.initBannerAd=function(t){var o;!e.isPlatform([e.Platform.Android])&&(null===(o=i)||void 0===o||o.initBannerAd(t))},e.showBanner=function(t){var o,n,a,r,s,l,c,d,h,u,p,f,m;if(e.isPlatform([e.Platform.Android,e.Platform.iOS])){var g=null!=(a=null===(n=null===(o=t)||void 0===o?void 0:o.style)||void 0===n?void 0:n.offsetX)?a:0,y=null!=(l=null===(s=null===(r=t)||void 0===r?void 0:r.style)||void 0===s?void 0:s.offsetY)?l:0,v=null!=(h=null===(d=null===(c=t)||void 0===c?void 0:c.style)||void 0===d?void 0:d.width)?h:0,b=null!=(f=null===(p=null===(u=t)||void 0===u?void 0:u.style)||void 0===p?void 0:p.height)?f:0;e.PA.showBanner(g,y,v,b)}else e.isPlatform(e.Platform.Kuaidianwan)?GameAssistantWeb.showBanner():null===(m=i)||void 0===m||m.showBanner(t)},e.hideBanner=function(t){var o;e.isPlatform([e.Platform.Android,e.Platform.iOS])?e.PA.hideBanner():e.isPlatform(e.Platform.Kuaidianwan)?GameAssistantWeb.hideBanner():null===(o=i)||void 0===o||o.hideBanner(t)},e.hideAllBanner=function(){var t;e.isPlatform([e.Platform.Android])?e.PA.hideAllBanner():e.isPlatform(e.Platform.iOS)||null===(t=i)||void 0===t||t.hideAllBanner()},e.resumeShowBanner=function(){var t;e.isPlatform([e.Platform.Android])?e.PA.resumeShowBanner():e.isPlatform(e.Platform.iOS)||null===(t=i)||void 0===t||t.resumeShowBanner()},e.clearAllBanner=function(){var t;e.isPlatform([e.Platform.Android])?e.PA.clearAllBanner():e.isPlatform(e.Platform.iOS)||null===(t=i)||void 0===t||t.clearAllBanner()},e.isExistBanner=function(e){var t;return null===(t=i)||void 0===t?void 0:t.isExistBanner(e)}}(s||(s={})),s||(s={}),function(e){var t=new(function(){return function(){}}());e.showFullScreenVideoAd=function(){e.Info.isPreview||(e.isPlatform(e.Platform.Kuaidianwan)?GameAssistantWeb.showFullScreenVideoAd():e.PA.showFullScreenVideoAd())},e.setFullScreenVideoAdPlayCallback=function(e){t.playCallback=e},e.invokeFullScreenVideoAdPlayCallback=function(e){var o,i,n;null===(n=null===(o=t)||void 0===o?void 0:(i=o).playCallback)||void 0===n||n.call(i,e)}}(s||(s={})),function(e){var t=new(function(){function t(){}var o=t.prototype;return o.initGameBannerAd=function(t,o){if(e.isPlatform([e.Platform.Vivo,e.Platform.OPPO])&&!e.Info.isPreview){if(!o){var i={};i.left=100/e.PA.getSystemInfoSync().designPixelRatio,i.top=(e.Info.resolution.height-200)/e.PA.getSystemInfoSync().designPixelRatio,i.orientation="horizontal",o=i}if(e.isOPPO()){var n={};n.adUnitId=t,n.style=o,this.gameBannerAd=e.PA.createGameBannerAd(n)}else if(e.isVivo()){var a={};a.posId=t,this.gameBannerAd=e.PA.createBoxBannerAd(a)}this.gameBannerAd.onError(function(t){e.log("GameBannerAd error:",t)}),this.gameBannerAd.onLoad(function(){e.log("GameBannerAd loaded")})}else!e.Info.isPreview&&e.log("Current platform\uff1a"+e.Info.platform+"Banner ads are not supported for the time being")},o.showGameBannerAd=function(){e.log("try show GameBannerAd"),this.gameBannerAd?this.gameBannerAd.show().then(function(){console.log("GameBannerAd show success")}).catch(function(e){console.log("GameBannerAd show fail with:"+e)}):e.log("GameBannerAd not init")},o.hideGameBannerAd=function(){this.gameBannerAd?(e.log("GameBannerAd hide"),this.gameBannerAd.hide()):e.log("GameBannerAd not init")},t}());e.initGameBannerAd=function(e,o){t.initGameBannerAd(e,o)},e.showGameBannerAd=function(){t.showGameBannerAd()},e.hideGameBannerAd=function(){t.hideGameBannerAd()}}(s||(s={})),function(e){var t=new(function(){function t(){this.adUnitId=""}var o=t.prototype;return o.initInterstitialAd=function(e){this.adUnitId=e},o.showInterstitialAd=function(){var t={};t.adUnitId=this.adUnitId;var o=e.PA.createInterstitialAd(t);e.isPlatform([e.Platform.Vivo,e.Platform.Kwaigame])?o.show().then(function(){e.log("InterstitialAd show")}).catch(function(t){e.log("InterstitialAd fail",JSON.stringify(t))}):e.isPlatform([e.Platform.ByteDance])?o.load().then(function(){o.show().then(function(){e.log("InterstitialAd show")})}).catch(function(t){e.log(t)}):(o.onError(function(t){e.log("InterstitialAd error",t)}),o.onLoad(function(){e.log("InterstitialAd onLoad"),o.show().catch(function(t){e.error("show",t)})}),o.load().catch(function(t){e.error("InterstitialAd err",t)}))},t}());e.initInterstitialAd=function(e){t.initInterstitialAd(e)},e.showInterstitialAd=function(){e.Info.isPreview||(e.isPlatform([e.Platform.iOS,e.Platform.Android])?e.PA.showInterstitialAd():e.isPlatform(e.Platform.Kuaidianwan)?GameAssistantWeb.showInterstitialAd():t.showInterstitialAd())}}(s||(s={})),function(e){e.showNativeAd=function(t){e.Info.isPreview||e.isPlatform([e.Platform.iOS,e.Platform.Android])&&e.PA.showNativeAd(t)},e.hideNativeAd=function(){e.Info.isPreview||e.isPlatform([e.Platform.iOS,e.Platform.Android])&&e.PA.hideNativeAd()}}(s||(s={})),function(e){var t;(o=t||(t={}))[o.Default=0]="Default",o[o.Loading=1]="Loading",o[o.Loaded=2]="Loaded",o[o.Showing=3]="Showing",o[o.End=4]="End",o[o.Error=5]="Error";var o,i=new(function(){function o(){this.adIds=[],this.currAdIdIdx=-1,this.ad=null,this.showOption=null,this.videoPlayTimeStamp=0,this.status=t.Default,this.closeTip="Watch the video to get the reward",this.videoPlayCallbacks=[],this.videoPlayEndCallbacks=[],this.videoCloseCallbacks=[]}var i=o.prototype;return i.init=function(e){this.adIds=e,this.currAdIdIdx=-1,this.initNextAd()},i.setCloseTip=function(e){this.closeTip=e},i.haveRewardVideo=function(){return e.isPlatform([e.Platform.iOS,e.Platform.Android])?e.PA.isRewardVideoAdReady():this.status==t.Loaded},i.onLoad=function(){this.status=t.Loaded},i.onError=function(o){var i,n;if(this.status=t.Error,this.showOption){if(!e.Info.isPreview){var a={};a.type=this.showOption.tag,a.page=null!=(i=this.showOption.page)?i:"",e.sentLog("VideoAdFailed",null,a)}e.PA.showToast({title:"Sorry, I didn't find the video",icon:"none",mask:!1});var r={};r.errorMsg=JSON.stringify(o),r.reward=!1,r.shown=!1,null===(n=this.showOption)||void 0===n||n.result(r)}e.isPlatform([e.Platform.OPPO,e.Platform.Vivo])&&this.ad.load(),this.showOption=null},i.onClose=function(o){var i,n,a,r,s,l;o.isEnded?(e.Info.rewardUserData.data.has(this.showOption.tag)&&e.Info.rewardUserData.data.get(this.showOption.tag).currCount++,this.videoPlayEndCallbacks.forEach(function(e){try{e()}catch(e){}})):this.videoCloseCallbacks.forEach(function(e){try{e()}catch(e){}}),this.status=t.End;var c={};if(c.reward=null===(n=o)||void 0===n?void 0:n.isEnded,c.shown=!0,c.ecpm=null!=(a=o.ecpm)?a:0,null===(i=this.showOption)||void 0===i||i.result(c),!e.Info.isPreview){var d={};d.type=this.showOption.tag,d.page=null!=(s=this.showOption.page)?s:"",e.sentLog((null===(r=o)||void 0===r?void 0:r.isEnded)?"VideoAdEnded":"VideoAdClosed",Math.round((Date.now()-this.videoPlayTimeStamp)/1e3),d)}if(e.isPlatform([e.Platform.OPPO,e.Platform.Vivo])&&!e.Info.isPreview&&this.ad.load(),this.showOption=null,this.status=t.End,!(null===(l=o)||void 0===l?void 0:l.isEnded)&&this.closeTip&&""!=this.closeTip){var h={};h.title=this.closeTip,h.mask=!0,h.icon="none",e.PA.showToast(h)}},i.initNextAd=function(){var o=this;if(this.adIds.length>0&&!e.isPlatform(e.Platform.Android)){this.currAdIdIdx=(this.currAdIdIdx+1)%this.adIds.length;var i={};i.adUnitId=this.adIds[this.currAdIdIdx],i.multiton=!1,this.ad=e.PA.createRewardedVideoAd(i),this.status=t.Loading,this.ad.onLoad(function(){o.onLoad()}),this.ad.onError(function(e){o.onError(e)}),this.ad.onClose(function(e){o.onClose(e)}),e.isPlatform([e.Platform.OPPO,e.Platform.Vivo])&&this.ad.load()}},i.showVideoAd=function(t){var o,i=this;if(this.showOption)e.log("reward video is showing with "+this.showOption.page+" - "+this.showOption.tag);else{if(this.showOption=t,!e.Info.isPreview){var n={};n.type=this.showOption.tag,n.page=null!=(o=this.showOption.page)?o:"",e.sentLog("TryPlayVideoAd",null,n)}e.Info.isPreview?this.onClose({isEnded:!0}):e.isPlatform(e.Platform.QuTouTiao)?qttGame.showVideo(function(e){var t={};t.isEnded=1==e,i.onClose(t)}):e.isPlatform(e.Platform.Kuaidianwan)?GameAssistantWeb.showRewardVideo(function(e){var t={};t.isEnded=e,i.onClose(t)}):e.isPlatform(e.Platform.Android)?e.PA.showRewardVideoAd(function(t){var o;if(e.log("reward video Android show callback:"+JSON.stringify(t)),t.shown){var n={};n.isEnded=t.reward,n.ecpm=t.ecpm,i.onClose(n)}else{if(i.showOption){var a={};a.errorMsg=JSON.stringify(t),a.reward=!1,a.shown=!1,null===(o=i.showOption)||void 0===o||o.result(a)}i.showOption=null}}):e.isPlatform(e.Platform.iOS)?e.PA.showRewardVideoAd(function(t){var o;if(e.log("reward video ios show callback:"+JSON.stringify(t)),t.shown){var n={};n.isEnded=t.reward,n.ecpm=t.ecpm,i.onClose(n)}else{if(i.showOption){var a={};a.errorMsg=JSON.stringify(t),a.reward=!1,a.shown=!1,null===(o=i.showOption)||void 0===o||o.result(a)}i.showOption=null}}):e.isPlatform(e.Platform.M4399MiniGame)?window.h5api.playAd(function(t){e.log("code:"+t.code+",message:"+t.message),1e4===t.code?i.videoPlayCallbacks.forEach(function(e){try{e()}catch(e){}}):10001===t.code?i.onClose({isEnded:!0}):(i.showOption=null,i.videoCloseCallbacks.forEach(function(e){try{e()}catch(e){}}))}):(null==this.ad&&this.initNextAd(),this.ad.show().then(function(){i.videoPlayTimeStamp=Date.now(),i.showAdResult(!0,"")}).catch(function(e){i.showAdResult(!1,JSON.stringify(e))}))}},i.showAdResult=function(t,o){var i;if(this.showOption&&!e.Info.isPreview){var n={};n.type=this.showOption.tag,n.page=null!=(i=this.showOption.page)?i:"",e.sentLog(t?"VideoAdSuccess":"VideoAdFailed",null,n)}if(t)this.videoPlayCallbacks.forEach(function(e){try{e()}catch(e){}});else{e.isPlatform([e.Platform.OPPO,e.Platform.Vivo])&&this.ad.load();var a={errCode:1};a.errMsg=o,this.onError(a)}},i.addPlayCallback=function(e){this.videoPlayCallbacks.push(e)},i.addPlayEndCallback=function(e){this.videoPlayEndCallbacks.push(e)},i.addCloseCallback=function(e){this.videoCloseCallbacks.push(e)},i.removePlayCallback=function(e){var t=this.videoPlayCallbacks.indexOf(e);t>=0&&this.videoPlayCallbacks.splice(t,1)},i.removePlayEndCallback=function(e){var t=this.videoPlayEndCallbacks.indexOf(e);t>=0&&this.videoPlayEndCallbacks.splice(t,1)},i.removeCloseCallback=function(e){var t=this.videoCloseCallbacks.indexOf(e);t>=0&&this.videoCloseCallbacks.splice(t,1)},o}());e.haveRewardVideo=function(){return i.haveRewardVideo()},e.showVideoAd=function(e){i.showVideoAd(e)},e.initRewardVideoAd=function(t){!e.Info.isPreview&&i.init(t)},e.addVideoPlayCallback=function(e){i.addPlayCallback(e)},e.addVideoEndCallback=function(e){i.addPlayEndCallback(e)},e.addVideoCloseCallback=function(e){i.addCloseCallback(e)},e.removeVideoPlayCallback=function(e){i.removePlayCallback(e)},e.removeVideoEndCallback=function(e){i.removePlayEndCallback(e)},e.removeVideoCloseCallback=function(e){i.removeCloseCallback(e)},e.setInterruptPlayTip=function(e){i.setCloseTip(e)}}(s||(s={})),(l=s||(s={})).showSplashAd=function(){var e,t;l.Info.isPreview||l.isPlatform(l.Platform.Kuaidianwan)||null===(t=(e=l.PA).showSplashAd)||void 0===t||t.call(e)},cc._RF.pop()},{}],papaparse:[function(e,t,o){"use strict";cc._RF.push(t,"baf83W8ny5M46sG/aMsG7N0","papaparse");var i,n=t,a=o;i=function e(){var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},o=!t.document&&!!t.postMessage,i=o&&/blob:/i.test((t.location||{}).protocol),n={},a=0,r={parse:function(o,i){var s=(i=i||{}).dynamicTyping||!1;if(w(s)&&(i.dynamicTypingFunction=s,s={}),i.dynamicTyping=s,i.transform=!!w(i.transform)&&i.transform,i.worker&&r.WORKERS_SUPPORTED){var l=function(){if(!r.WORKERS_SUPPORTED)return!1;var o,i,s=(o=t.URL||t.webkitURL||null,i=e.toString(),r.BLOB_URL||(r.BLOB_URL=o.createObjectURL(new Blob(["(",i,")();"],{type:"text/javascript"})))),l=new t.Worker(s);return l.onmessage=g,l.id=a++,n[l.id]=l}();return l.userStep=i.step,l.userChunk=i.chunk,l.userComplete=i.complete,l.userError=i.error,i.step=w(i.step),i.chunk=w(i.chunk),i.complete=w(i.complete),i.error=w(i.error),delete i.worker,void l.postMessage({input:o,config:i,workerId:l.id})}var p=null;return r.NODE_STREAM_INPUT,"string"==typeof o?p=i.download?new c(i):new h(i):!0===o.readable&&w(o.read)&&w(o.on)?p=new u(i):(t.File&&o instanceof File||o instanceof Object)&&(p=new d(i)),p.stream(o)},unparse:function(e,t){var o=!1,i=!0,n=",",a="\r\n",s='"',l=s+s,c=!1,d=null,h=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||r.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(n=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(o=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(i=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");d=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+s),"boolean"==typeof t.escapeFormulae&&(h=t.escapeFormulae)}}();var u=new RegExp(f(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,c);if("object"==typeof e[0])return p(d||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function p(e,t,o){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,l=!Array.isArray(t[0]);if(s&&i){for(var c=0;c<e.length;c++)0<c&&(r+=n),r+=m(e[c],c);0<t.length&&(r+=a)}for(var d=0;d<t.length;d++){var h=s?e.length:t[d].length,u=!1,p=s?0===Object.keys(t[d]).length:0===t[d].length;if(o&&!s&&(u="greedy"===o?""===t[d].join("").trim():1===t[d].length&&0===t[d][0].length),"greedy"===o&&s){for(var f=[],g=0;g<h;g++){var y=l?e[g]:g;f.push(t[d][y])}u=""===f.join("").trim()}if(!u){for(var v=0;v<h;v++){0<v&&!p&&(r+=n);var b=s&&l?e[v]:v;r+=m(t[d][b],v)}d<t.length-1&&(!o||0<h&&!p)&&(r+=a)}}return r}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===h&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var i=e.toString().replace(u,l);return"boolean"==typeof o&&o||"function"==typeof o&&o(e,t)||Array.isArray(o)&&o[t]||function(e,t){for(var o=0;o<t.length;o++)if(-1<e.indexOf(t[o]))return!0;return!1}(i,r.BAD_DELIMITERS)||-1<i.indexOf(n)||" "===i.charAt(0)||" "===i.charAt(i.length-1)?s+i+s:i}}};if(r.RECORD_SEP=String.fromCharCode(30),r.UNIT_SEP=String.fromCharCode(31),r.BYTE_ORDER_MARK="\ufeff",r.BAD_DELIMITERS=["\r","\n",'"',r.BYTE_ORDER_MARK],r.WORKERS_SUPPORTED=!o&&!!t.Worker,r.NODE_STREAM_INPUT=1,r.LocalChunkSize=10485760,r.RemoteChunkSize=5242880,r.DefaultDelimiter=",",r.Parser=m,r.ParserHandle=p,r.NetworkStreamer=c,r.FileStreamer=d,r.StringStreamer=h,r.ReadableStreamStreamer=u,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var o=e.config||{},i=[];return this.each(function(){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var e=0;e<this.files.length;e++)i.push({file:this.files[e],inputElem:this,instanceConfig:s.extend({},o)})}),n(),this;function n(){if(0!==i.length){var t,o,n,l=i[0];if(w(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return t=l.file,o=l.inputElem,n=c.reason,void(w(e.error)&&e.error({name:"AbortError"},t,o,n));if("skip"===c.action)return void a();"object"==typeof c.config&&(l.instanceConfig=s.extend(l.instanceConfig,c.config))}else if("skip"===c)return void a()}var d=l.instanceConfig.complete;l.instanceConfig.complete=function(e){w(d)&&d(e,l.file,l.inputElem),a()},r.parse(l.file,l.instanceConfig)}else w(e.complete)&&e.complete()}function a(){i.splice(0,1),n()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new p(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,o){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+e;this._partialLine="";var s=this._handle.parse(a,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=s.meta.cursor;this._finished||(this._partialLine=a.substring(l-this._baseIndex),this._baseIndex=l),s&&s.data&&(this._rowCount+=s.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)t.postMessage({results:s,workerId:r.WORKER_ID,finished:c});else if(w(this._config.chunk)&&!o){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!c||!w(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):i&&this._config.error&&t.postMessage({workerId:r.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=r.RemoteChunkSize),l.call(this,e),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),o||(t.onload=A(this._chunkLoaded,this),t.onerror=A(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var i in e)t.setRequestHeader(i,e[i])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+n)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}o&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){var e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(e=t.getResponseHeader("Content-Range"))?-1:parseInt(e.substring(e.lastIndexOf("/")+1))),this.parseChunk(t.responseText)))},this._chunkError=function(e){var o=t.statusText||e;this._sendError(new Error(o))}}function d(e){var t,o;(e=e||{}).chunkSize||(e.chunkSize=r.LocalChunkSize),l.call(this,e);var i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,o=e.slice||e.webkitSlice||e.mozSlice,i?((t=new FileReader).onload=A(this._chunkLoaded,this),t.onerror=A(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);e=o.call(e,this._start,n)}var a=t.readAsText(e,this._config.encoding);i||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function h(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,o=this._config.chunkSize;return o?(e=t.substring(0,o),t=t.substring(o)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function u(e){l.call(this,e=e||{});var t=[],o=!0,i=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):o=!0},this._streamData=A(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),o&&(o=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=A(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=A(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=A(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(e){var t,o,i,n=Math.pow(2,53),a=-n,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,l=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,c=this,d=0,h=0,u=!1,p=!1,g=[],y={data:[],errors:[],meta:{}};if(w(e.step)){var v=e.step;e.step=function(t){if(y=t,G())P();else{if(P(),0===y.data.length)return;d+=t.data.length,e.preview&&d>e.preview?o.abort():(y.data=y.data[0],v(y,c))}}}function A(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function P(){if(y&&i&&(S("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+r.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines)for(var t=0;t<y.data.length;t++)A(y.data[t])&&y.data.splice(t--,1);return G()&&function(){if(y)if(Array.isArray(y.data[0])){for(var t=0;G()&&t<y.data.length;t++)y.data[t].forEach(o);y.data.splice(0,1)}else y.data.forEach(o);function o(t,o){w(e.transformHeader)&&(t=e.transformHeader(t,o)),g.push(t)}}(),function(){if(!y||!e.header&&!e.dynamicTyping&&!e.transform)return y;function t(t,o){var i,n=e.header?{}:[];for(i=0;i<t.length;i++){var a=i,r=t[i];e.header&&(a=i>=g.length?"__parsed_extra":g[i]),e.transform&&(r=e.transform(r,a)),r=C(a,r),"__parsed_extra"===a?(n[a]=n[a]||[],n[a].push(r)):n[a]=r}return e.header&&(i>g.length?S("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+i,h+o):i<g.length&&S("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+i,h+o)),n}var o=1;return!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(t),o=y.data.length):y.data=t(y.data,0),e.header&&y.meta&&(y.meta.fields=g),h+=o,y}()}function G(){return e.header&&0===g.length}function C(t,o){return i=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[i]&&(e.dynamicTyping[i]=e.dynamicTypingFunction(i)),!0===(e.dynamicTyping[i]||e.dynamicTyping)?"true"===o||"TRUE"===o||"false"!==o&&"FALSE"!==o&&(function(e){if(s.test(e)){var t=parseFloat(e);if(a<t&&t<n)return!0}return!1}(o)?parseFloat(o):l.test(o)?new Date(o):""===o?null:o):o;var i}function S(e,t,o,i){var n={type:e,code:t,message:o};void 0!==i&&(n.row=i),y.errors.push(n)}this.parse=function(n,a,s){var l=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var o=new RegExp(f(t)+"([^]*?)"+f(t),"gm"),i=(e=e.replace(o,"")).split("\r"),n=e.split("\n"),a=1<n.length&&n[0].length<i[0].length;if(1===i.length||a)return"\n";for(var r=0,s=0;s<i.length;s++)"\n"===i[s][0]&&r++;return r>=i.length/2?"\r\n":"\r"}(n,l)),i=!1,e.delimiter)w(e.delimiter)&&(e.delimiter=e.delimiter(n),y.meta.delimiter=e.delimiter);else{var c=function(t,o,i,n,a){var s,l,c,d;a=a||[",","\t","|",";",r.RECORD_SEP,r.UNIT_SEP];for(var h=0;h<a.length;h++){var u=a[h],p=0,f=0,g=0;c=void 0;for(var y=new m({comments:n,delimiter:u,newline:o,preview:10}).parse(t),v=0;v<y.data.length;v++)if(i&&A(y.data[v]))g++;else{var b=y.data[v].length;f+=b,void 0!==c?0<b&&(p+=Math.abs(b-c),c=b):c=b}0<y.data.length&&(f/=y.data.length-g),(void 0===l||p<=l)&&(void 0===d||d<f)&&1.99<f&&(l=p,s=u,d=f)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(n,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(i=!0,e.delimiter=r.DefaultDelimiter),y.meta.delimiter=e.delimiter}var d=b(e);return e.preview&&e.header&&d.preview++,t=n,o=new m(d),y=o.parse(t,a,s),P(),u?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,o.abort(),t=w(e.chunk)?"":t.substring(o.getCharIndex())},this.resume=function(){c.streamer._halted?(u=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,o.abort(),y.meta.aborted=!0,w(e.complete)&&e.complete(y),t=""}}function f(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,o=(e=e||{}).delimiter,i=e.newline,n=e.comments,a=e.step,s=e.preview,l=e.fastMode,c=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof o||-1<r.BAD_DELIMITERS.indexOf(o))&&(o=","),n===o)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||-1<r.BAD_DELIMITERS.indexOf(n))&&(n=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var d=0,h=!1;this.parse=function(e,r,u){if("string"!=typeof e)throw new Error("Input must be a string");var p=e.length,m=o.length,g=i.length,y=n.length,v=w(a),b=[],A=[],P=[],G=d=0;if(!e)return B();if(l||!1!==l&&-1===e.indexOf(t)){for(var C=e.split(i),S=0;S<C.length;S++){if(P=C[S],d+=P.length,S!==C.length-1)d+=i.length;else if(u)return B();if(!n||P.substring(0,y)!==n){if(v){if(b=[],E(P.split(o)),N(),h)return B()}else E(P.split(o));if(s&&s<=S)return b=b.slice(0,s),B(!0)}}return B()}for(var k=e.indexOf(o,d),T=e.indexOf(i,d),L=new RegExp(f(c)+f(t),"g"),M=e.indexOf(t,d);;)if(e[d]!==t)if(n&&0===P.length&&e.substring(d,d+y)===n){if(-1===T)return B();d=T+g,T=e.indexOf(i,d),k=e.indexOf(o,d)}else if(-1!==k&&(k<T||-1===T))P.push(e.substring(d,k)),d=k+m,k=e.indexOf(o,d);else{if(-1===T)break;if(P.push(e.substring(d,T)),_(T+g),v&&(N(),h))return B();if(s&&b.length>=s)return B(!0)}else for(M=d,d++;;){if(-1===(M=e.indexOf(t,M+1)))return u||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:d}),x();if(M===p-1)return x(e.substring(d,M).replace(L,t));if(t!==c||e[M+1]!==c){if(t===c||0===M||e[M-1]!==c){-1!==k&&k<M+1&&(k=e.indexOf(o,M+1)),-1!==T&&T<M+1&&(T=e.indexOf(i,M+1));var I=O(-1===T?k:Math.min(k,T));if(e[M+1+I]===o){P.push(e.substring(d,M).replace(L,t)),e[d=M+1+I+m]!==t&&(M=e.indexOf(t,d)),k=e.indexOf(o,d),T=e.indexOf(i,d);break}var R=O(T);if(e.substring(M+1+R,M+1+R+g)===i){if(P.push(e.substring(d,M).replace(L,t)),_(M+1+R+g),k=e.indexOf(o,d),M=e.indexOf(t,d),v&&(N(),h))return B();if(s&&b.length>=s)return B(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:d}),M++}}else M++}return x();function E(e){b.push(e),G=d}function O(t){var o=0;if(-1!==t){var i=e.substring(M+1,t);i&&""===i.trim()&&(o=i.length)}return o}function x(t){return u||(void 0===t&&(t=e.substring(d)),P.push(t),d=p,E(P),v&&N()),B()}function _(t){d=t,E(P),P=[],T=e.indexOf(i,d)}function B(e){return{data:b,errors:A,meta:{delimiter:o,linebreak:i,aborted:h,truncated:!!e,cursor:G+(r||0)}}}function N(){a(B()),b=[],A=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return d}}function g(e){var t=e.data,o=n[t.workerId],i=!1;if(t.error)o.userError(t.error,t.file);else if(t.results&&t.results.data){var a={abort:function(){i=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(w(o.userStep)){for(var r=0;r<t.results.data.length&&(o.userStep({data:t.results.data[r],errors:t.results.errors,meta:t.results.meta},a),!i);r++);delete t.results}else w(o.userChunk)&&(o.userChunk(t.results,a,t.file),delete t.results)}t.finished&&!i&&y(t.workerId,t.results)}function y(e,t){var o=n[e];w(o.userComplete)&&o.userComplete(t),o.terminate(),delete n[e]}function v(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var o in e)t[o]=b(e[o]);return t}function A(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return i&&(t.onmessage=function(e){var o=e.data;if(void 0===r.WORKER_ID&&o&&(r.WORKER_ID=o.workerId),"string"==typeof o.input)t.postMessage({workerId:r.WORKER_ID,results:r.parse(o.input,o.config),finished:!0});else if(t.File&&o.input instanceof File||o.input instanceof Object){var i=r.parse(o.input,o.config);i&&t.postMessage({workerId:r.WORKER_ID,results:i,finished:!0})}}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(h.prototype=Object.create(h.prototype)).constructor=h,(u.prototype=Object.create(l.prototype)).constructor=u,r},"function"==typeof define&&define.amd?define([],i):"object"==typeof n&&void 0!==a?n.exports=i():(void 0).Papa=i(),cc._RF.pop()},{}],w:[function(e,t){"use strict";cc._RF.push(t,"91a5a7b3e9Kl66YW8GF3oma","w");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.w=o,cc._RF.pop()},{}]},{},["w","AAA","API","AdManager","ArmsItem","AuxArmsNode","AuxCannon","BaseRole","BaseScript","BuffNode","Bullet","Cannon","CoreArmsNode","CoreCannon","CurrencyInfo","DoubleHit","Enemy","EnemyTips","ExpireNode","Extend","FlashAlphaShader","FreeGold","FreeStamina","FreeTrial","GameConfig","GameData","GameInfo","GameManager","GameModel","GameNode","GameOver","GameUI","GiftNode","GlobalDefine","GradeInfo","GradeToast","GraphicsDottedLine","GraphicsSpriteMesh_rope","GuideUtils","Handler","HitEffectAni","HitHurtAni","LevelNode","LevelUp","ListView","LoadUI","LobbyNode","MSGEvent","MatrixList","Model","OnlineNode","PauseNode","PoolManager","PrivacyNode","ProfitNode","ProjectConfig","Recorder","RecorderManager","Revive","RewardBox","RewardGoldTips","RewardTips","RippleShaderTime","SettingNode","ShareNode","SignNode","SmallScene","SoundManager","TabBarItem","TaskItem","TaskNode","Utils","gameassistant2","papaparse"]);